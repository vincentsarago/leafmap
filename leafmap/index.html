
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for interactive mapping and geospatial analysis with minimal coding in a Jupyter environment">
      
      
        <meta name="author" content="Qiusheng Wu">
      
      
        <link rel="canonical" href="https://leafmap.org/leafmap/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>leafmap module - leafmap</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-B1C88N45QG"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-B1C88N45QG",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-B1C88N45QG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#leafmap-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="leafmap" class="md-header__button md-logo" aria-label="leafmap" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            leafmap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              leafmap module
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/giswqs/leafmap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="leafmap" class="md-nav__button md-logo" aria-label="leafmap" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    leafmap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/giswqs/leafmap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        Get Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_key_features/" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://demo.leafmap.org" class="md-nav__link">
        JupyterLite
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://multipage-app.streamlit.app" class="md-nav__link">
        Streamlit App
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://youtube.com/@giswqs" class="md-nav__link">
        YouTube Channel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/giswqs/leafmap/issues" class="md-nav__link">
        Report Issues
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basemaps/" class="md-nav__link">
        basemaps module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bokehmap/" class="md-nav__link">
        bokehmap module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../colormaps/" class="md-nav__link">
        colormaps module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        common module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        examples module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../foliumap/" class="md-nav__link">
        foliumap module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../heremap/" class="md-nav__link">
        heremap module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kepler/" class="md-nav__link">
        kepler module
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          leafmap module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        leafmap module
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap" class="md-nav__link">
    leafmap.leafmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.ImageOverlay" class="md-nav__link">
    ImageOverlay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map" class="md-nav__link">
    Map
  </a>
  
    <nav class="md-nav" aria-label="Map">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_basemap" class="md-nav__link">
    add_basemap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_census_data" class="md-nav__link">
    add_census_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_circle_markers_from_xy" class="md-nav__link">
    add_circle_markers_from_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_cog_layer" class="md-nav__link">
    add_cog_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_colorbar" class="md-nav__link">
    add_colorbar()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_colormap" class="md-nav__link">
    add_colormap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_gdf" class="md-nav__link">
    add_gdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_gdf_from_postgis" class="md-nav__link">
    add_gdf_from_postgis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_geojson" class="md-nav__link">
    add_geojson()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_heatmap" class="md-nav__link">
    add_heatmap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_html" class="md-nav__link">
    add_html()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_image" class="md-nav__link">
    add_image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_kml" class="md-nav__link">
    add_kml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_labels" class="md-nav__link">
    add_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_layer" class="md-nav__link">
    add_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_legend" class="md-nav__link">
    add_legend()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_local_tile" class="md-nav__link">
    add_local_tile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_marker" class="md-nav__link">
    add_marker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_marker_cluster" class="md-nav__link">
    add_marker_cluster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_minimap" class="md-nav__link">
    add_minimap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_mosaic_layer" class="md-nav__link">
    add_mosaic_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_netcdf" class="md-nav__link">
    add_netcdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_address" class="md-nav__link">
    add_osm_from_address()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_bbox" class="md-nav__link">
    add_osm_from_bbox()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_geocode" class="md-nav__link">
    add_osm_from_geocode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_place" class="md-nav__link">
    add_osm_from_place()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_point" class="md-nav__link">
    add_osm_from_point()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_polygon" class="md-nav__link">
    add_osm_from_polygon()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_view" class="md-nav__link">
    add_osm_from_view()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_planet_by_month" class="md-nav__link">
    add_planet_by_month()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_planet_by_quarter" class="md-nav__link">
    add_planet_by_quarter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_point_layer" class="md-nav__link">
    add_point_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_points_from_xy" class="md-nav__link">
    add_points_from_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_raster" class="md-nav__link">
    add_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_raster_legacy" class="md-nav__link">
    add_raster_legacy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_remote_tile" class="md-nav__link">
    add_remote_tile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_search_control" class="md-nav__link">
    add_search_control()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_shp" class="md-nav__link">
    add_shp()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_stac_layer" class="md-nav__link">
    add_stac_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_text" class="md-nav__link">
    add_text()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_tile_layer" class="md-nav__link">
    add_tile_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_time_slider" class="md-nav__link">
    add_time_slider()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_vector" class="md-nav__link">
    add_vector()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_vector_tile_layer" class="md-nav__link">
    add_vector_tile_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_velocity" class="md-nav__link">
    add_velocity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_widget" class="md-nav__link">
    add_widget()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_wms_layer" class="md-nav__link">
    add_wms_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_xy_data" class="md-nav__link">
    add_xy_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_xyz_service" class="md-nav__link">
    add_xyz_service()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.basemap_demo" class="md-nav__link">
    basemap_demo()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.edit_vector" class="md-nav__link">
    edit_vector()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.find_layer" class="md-nav__link">
    find_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.find_layer_index" class="md-nav__link">
    find_layer_index()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_draw_props" class="md-nav__link">
    get_draw_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_layer_names" class="md-nav__link">
    get_layer_names()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_pc_collections" class="md-nav__link">
    get_pc_collections()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_scale" class="md-nav__link">
    get_scale()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.image_overlay" class="md-nav__link">
    image_overlay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.layer_opacity" class="md-nav__link">
    layer_opacity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.remove_labels" class="md-nav__link">
    remove_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.save_draw_features" class="md-nav__link">
    save_draw_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.set_center" class="md-nav__link">
    set_center()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.split_map" class="md-nav__link">
    split_map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.static_map" class="md-nav__link">
    static_map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_html" class="md-nav__link">
    to_html()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_image" class="md-nav__link">
    to_image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_streamlit" class="md-nav__link">
    to_streamlit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.toolbar_reset" class="md-nav__link">
    toolbar_reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.update_draw_features" class="md-nav__link">
    update_draw_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.update_draw_props" class="md-nav__link">
    update_draw_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.user_roi_bounds" class="md-nav__link">
    user_roi_bounds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.video_overlay" class="md-nav__link">
    video_overlay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.zoom_to_bounds" class="md-nav__link">
    zoom_to_bounds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.zoom_to_gdf" class="md-nav__link">
    zoom_to_gdf()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.geojson_layer" class="md-nav__link">
    geojson_layer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.linked_maps" class="md-nav__link">
    linked_maps()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.split_map" class="md-nav__link">
    split_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.ts_inspector" class="md-nav__link">
    ts_inspector()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legends/" class="md-nav__link">
        legends module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../osm/" class="md-nav__link">
        osm module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pc/" class="md-nav__link">
        pc module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plotlymap/" class="md-nav__link">
        plotlymap module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deck/" class="md-nav__link">
        pydeck module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../toolbar/" class="md-nav__link">
        toolbar module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Workshops
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Workshops" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Workshops
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/FOSS4G_2021/" class="md-nav__link">
        FOSS4G 2021
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SIGSPATIAL_2021/" class="md-nav__link">
        SIGSPATIAL 2021
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/YouthMappers_2021/" class="md-nav__link">
        YouthMappers 2021
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_key_features/" class="md-nav__link">
        00 key features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/01_leafmap_intro/" class="md-nav__link">
        01 leafmap intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/02_using_basemaps/" class="md-nav__link">
        02 using basemaps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/03_cog_stac/" class="md-nav__link">
        03 cog stac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/04_cog_mosaic/" class="md-nav__link">
        04 cog mosaic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/05_load_raster/" class="md-nav__link">
        05 load raster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/06_legend/" class="md-nav__link">
        06 legend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/07_colorbar/" class="md-nav__link">
        07 colorbar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/08_whitebox/" class="md-nav__link">
        08 whitebox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/09_csv_to_points/" class="md-nav__link">
        09 csv to points
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/10_add_vector/" class="md-nav__link">
        10 add vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/11_linked_maps/" class="md-nav__link">
        11 linked maps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/12_split_map/" class="md-nav__link">
        12 split map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/13_geopandas/" class="md-nav__link">
        13 geopandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/14_postgis/" class="md-nav__link">
        14 postgis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/15_openstreetmap/" class="md-nav__link">
        15 openstreetmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/16_heremap/" class="md-nav__link">
        16 heremap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/17_vector_tile_layer/" class="md-nav__link">
        17 vector tile layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/18_point_layer/" class="md-nav__link">
        18 point layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/19_map_to_html/" class="md-nav__link">
        19 map to html
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/20_planet_imagery/" class="md-nav__link">
        20 planet imagery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/21_ts_inspector/" class="md-nav__link">
        21 ts inspector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/22_time_slider/" class="md-nav__link">
        22 time slider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/23_colormaps/" class="md-nav__link">
        23 colormaps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/24_heatmap/" class="md-nav__link">
        24 heatmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/25_map_title/" class="md-nav__link">
        25 map title
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/26_kepler_gl/" class="md-nav__link">
        26 kepler gl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/27_basemap_gallery/" class="md-nav__link">
        27 basemap gallery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/28_publish_map/" class="md-nav__link">
        28 publish map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/29_pydeck/" class="md-nav__link">
        29 pydeck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/30_census_data/" class="md-nav__link">
        30 census data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/31_search_basemaps/" class="md-nav__link">
        31 search basemaps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/32_local_tile/" class="md-nav__link">
        32 local tile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/33_image_overlay/" class="md-nav__link">
        33 image overlay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/34_add_points_from_xy/" class="md-nav__link">
        34 add points from xy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/35_circle_markers/" class="md-nav__link">
        35 circle markers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/36_add_labels/" class="md-nav__link">
        36 add labels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/37_planetary_computer/" class="md-nav__link">
        37 planetary computer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/38_plotly/" class="md-nav__link">
        38 plotly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/39_inspector_tool/" class="md-nav__link">
        39 inspector tool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/40_plotly_gui/" class="md-nav__link">
        40 plotly gui
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/41_raster_gui/" class="md-nav__link">
        41 raster gui
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/42_create_cog/" class="md-nav__link">
        42 create cog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/43_search_control/" class="md-nav__link">
        43 search control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/44_attribute_table/" class="md-nav__link">
        44 attribute table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/45_create_vector/" class="md-nav__link">
        45 create vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/46_edit_vector/" class="md-nav__link">
        46 edit vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/47_numpy_to_cog/" class="md-nav__link">
        47 numpy to cog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/48_lidar/" class="md-nav__link">
        48 lidar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/49_split_control/" class="md-nav__link">
        49 split control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/50_marker_cluster/" class="md-nav__link">
        50 marker cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/51_clip_image/" class="md-nav__link">
        51 clip image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/52_netcdf/" class="md-nav__link">
        52 netcdf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/53_choropleth/" class="md-nav__link">
        53 choropleth
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/54_plot_raster/" class="md-nav__link">
        54 plot raster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/55_lidar/" class="md-nav__link">
        55 lidar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/56_download_ned/" class="md-nav__link">
        56 download ned
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/57_national_map/" class="md-nav__link">
        57 national map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/58_bokeh/" class="md-nav__link">
        58 bokeh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/59_create_legend/" class="md-nav__link">
        59 create legend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/60_add_widget/" class="md-nav__link">
        60 add widget
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/61_vector_to_gif/" class="md-nav__link">
        61 vector to gif
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap" class="md-nav__link">
    leafmap.leafmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.ImageOverlay" class="md-nav__link">
    ImageOverlay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map" class="md-nav__link">
    Map
  </a>
  
    <nav class="md-nav" aria-label="Map">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_basemap" class="md-nav__link">
    add_basemap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_census_data" class="md-nav__link">
    add_census_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_circle_markers_from_xy" class="md-nav__link">
    add_circle_markers_from_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_cog_layer" class="md-nav__link">
    add_cog_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_colorbar" class="md-nav__link">
    add_colorbar()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_colormap" class="md-nav__link">
    add_colormap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_gdf" class="md-nav__link">
    add_gdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_gdf_from_postgis" class="md-nav__link">
    add_gdf_from_postgis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_geojson" class="md-nav__link">
    add_geojson()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_heatmap" class="md-nav__link">
    add_heatmap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_html" class="md-nav__link">
    add_html()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_image" class="md-nav__link">
    add_image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_kml" class="md-nav__link">
    add_kml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_labels" class="md-nav__link">
    add_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_layer" class="md-nav__link">
    add_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_legend" class="md-nav__link">
    add_legend()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_local_tile" class="md-nav__link">
    add_local_tile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_marker" class="md-nav__link">
    add_marker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_marker_cluster" class="md-nav__link">
    add_marker_cluster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_minimap" class="md-nav__link">
    add_minimap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_mosaic_layer" class="md-nav__link">
    add_mosaic_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_netcdf" class="md-nav__link">
    add_netcdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_address" class="md-nav__link">
    add_osm_from_address()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_bbox" class="md-nav__link">
    add_osm_from_bbox()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_geocode" class="md-nav__link">
    add_osm_from_geocode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_place" class="md-nav__link">
    add_osm_from_place()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_point" class="md-nav__link">
    add_osm_from_point()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_polygon" class="md-nav__link">
    add_osm_from_polygon()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_osm_from_view" class="md-nav__link">
    add_osm_from_view()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_planet_by_month" class="md-nav__link">
    add_planet_by_month()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_planet_by_quarter" class="md-nav__link">
    add_planet_by_quarter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_point_layer" class="md-nav__link">
    add_point_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_points_from_xy" class="md-nav__link">
    add_points_from_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_raster" class="md-nav__link">
    add_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_raster_legacy" class="md-nav__link">
    add_raster_legacy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_remote_tile" class="md-nav__link">
    add_remote_tile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_search_control" class="md-nav__link">
    add_search_control()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_shp" class="md-nav__link">
    add_shp()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_stac_layer" class="md-nav__link">
    add_stac_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_text" class="md-nav__link">
    add_text()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_tile_layer" class="md-nav__link">
    add_tile_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_time_slider" class="md-nav__link">
    add_time_slider()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_vector" class="md-nav__link">
    add_vector()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_vector_tile_layer" class="md-nav__link">
    add_vector_tile_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_velocity" class="md-nav__link">
    add_velocity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_widget" class="md-nav__link">
    add_widget()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_wms_layer" class="md-nav__link">
    add_wms_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_xy_data" class="md-nav__link">
    add_xy_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.add_xyz_service" class="md-nav__link">
    add_xyz_service()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.basemap_demo" class="md-nav__link">
    basemap_demo()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.edit_vector" class="md-nav__link">
    edit_vector()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.find_layer" class="md-nav__link">
    find_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.find_layer_index" class="md-nav__link">
    find_layer_index()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_draw_props" class="md-nav__link">
    get_draw_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_layer_names" class="md-nav__link">
    get_layer_names()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_pc_collections" class="md-nav__link">
    get_pc_collections()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.get_scale" class="md-nav__link">
    get_scale()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.image_overlay" class="md-nav__link">
    image_overlay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.layer_opacity" class="md-nav__link">
    layer_opacity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.remove_labels" class="md-nav__link">
    remove_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.save_draw_features" class="md-nav__link">
    save_draw_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.set_center" class="md-nav__link">
    set_center()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.split_map" class="md-nav__link">
    split_map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.static_map" class="md-nav__link">
    static_map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_html" class="md-nav__link">
    to_html()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_image" class="md-nav__link">
    to_image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.to_streamlit" class="md-nav__link">
    to_streamlit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.toolbar_reset" class="md-nav__link">
    toolbar_reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.update_draw_features" class="md-nav__link">
    update_draw_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.update_draw_props" class="md-nav__link">
    update_draw_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.user_roi_bounds" class="md-nav__link">
    user_roi_bounds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.video_overlay" class="md-nav__link">
    video_overlay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.zoom_to_bounds" class="md-nav__link">
    zoom_to_bounds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.leafmap.Map.zoom_to_gdf" class="md-nav__link">
    zoom_to_gdf()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.geojson_layer" class="md-nav__link">
    geojson_layer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.linked_maps" class="md-nav__link">
    linked_maps()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.split_map" class="md-nav__link">
    split_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.leafmap.ts_inspector" class="md-nav__link">
    ts_inspector()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  

  <a href="https://github.com/giswqs/leafmap/edit/master/docs/leafmap.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="leafmap-module">leafmap module<a class="headerlink" href="#leafmap-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="leafmap.leafmap"></a>
    <div class="doc doc-contents first">

      <p>Main module.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h2 id="leafmap.leafmap.ImageOverlay" class="doc doc-heading">
        <code>
ImageOverlay            (<span title="ipyleaflet.leaflet.ImageOverlay">ImageOverlay</span>)
        </code>



<a href="#leafmap.leafmap.ImageOverlay" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>ImageOverlay class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>http URL or local file path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bounds</code></td>
        <td><code>tuple</code></td>
        <td><p>bounding box of the image in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ImageOverlay</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ImageOverlay</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ImageOverlay class.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): http URL or local file path to the image.</span>
<span class="sd">        bounds (tuple): bounding box of the image in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
        <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageSequence</span>
        <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>

                <span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided file does not exist.&quot;</span><span class="p">)</span>

                <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># file extension</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

                <span class="n">f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gif&quot;</span><span class="p">:</span>
                    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="c1"># Loop over each frame in the animated image</span>
                    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
                        <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;gif&quot;</span><span class="p">)</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
                    <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                        <span class="n">f</span><span class="p">,</span>
                        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
                        <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                        <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

                <span class="n">data</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;data:image/</span><span class="si">{}</span><span class="s2">;base64,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">+</span> <span class="n">data</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="leafmap.leafmap.Map" class="doc doc-heading">
        <code>
Map            (<span title="ipyleaflet.leaflet.Map">Map</span>)
        </code>



<a href="#leafmap.leafmap.Map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>The Map class inherits ipyleaflet.Map. The arguments you can pass to the Map can be found at https://ipyleaflet.readthedocs.io/en/latest/api_reference/map.html. By default, the Map will add OpenStreetMap as the basemap.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>ipyleaflet map object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Map</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Map</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Map class inherits ipyleaflet.Map. The arguments you can pass to the Map can be found at https://ipyleaflet.readthedocs.io/en/latest/api_reference/map.html. By default, the Map will add OpenStreetMap as the basemap.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: ipyleaflet map object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="s2">&quot;center&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span>

        <span class="k">if</span> <span class="s2">&quot;scroll_wheel_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scroll_wheel_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="s2">&quot;attribution_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;attribution_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseclass</span> <span class="o">=</span> <span class="s2">&quot;ipyleaflet&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_button</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_output</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_output_ctrl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer_control</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_control</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_rois</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geojson_layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># sandbox path for Voila app to restrict access to system directories.</span>
        <span class="k">if</span> <span class="s2">&quot;sandbox_path&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_VOILA&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sandbox_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sandbox_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;sandbox_path&quot;</span><span class="p">])):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sandbox_path</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;sandbox_path&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The sandbox path is invalid.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sandbox_path</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s2">&quot;height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">&quot;600px&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;layers_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layers_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layers_control&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">LayersControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;fullscreen_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">FullScreenControl</span><span class="p">())</span>

        <span class="k">if</span> <span class="s2">&quot;draw_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;draw_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;draw_control&quot;</span><span class="p">]:</span>
            <span class="n">draw_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">DrawControl</span><span class="p">(</span>
                <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shapeOptions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#3388ff&quot;</span><span class="p">}},</span>
                <span class="n">rectangle</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shapeOptions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#3388ff&quot;</span><span class="p">}},</span>
                <span class="n">circle</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shapeOptions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#3388ff&quot;</span><span class="p">}},</span>
                <span class="n">circlemarker</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">edit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topleft&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">draw_control</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span> <span class="o">=</span> <span class="n">draw_control</span>

            <span class="n">draw_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">draw_output</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">handle_draw</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">geo_json</span><span class="p">):</span>

                <span class="k">if</span> <span class="s2">&quot;style&quot;</span> <span class="ow">in</span> <span class="n">geo_json</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]:</span>
                    <span class="k">del</span> <span class="n">geo_json</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;style&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span> <span class="o">=</span> <span class="n">geo_json</span>

                <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="s2">&quot;edited&quot;</span><span class="p">]:</span>

                    <span class="c1"># feature = {</span>
                    <span class="c1">#     &quot;type&quot;: &quot;Feature&quot;,</span>
                    <span class="c1">#     &quot;geometry&quot;: geo_json[&quot;geometry&quot;],</span>
                    <span class="c1"># }</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo_json</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;deleted&quot;</span><span class="p">:</span>
                    <span class="n">geometries</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span>
                    <span class="p">]</span>
                    <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">geom</span> <span class="o">==</span> <span class="n">geo_json</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]:</span>
                            <span class="n">geometries</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_mode</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">ipysheet</span>

                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_output</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">edit_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">edit_sheet</span> <span class="o">=</span> <span class="n">ipysheet</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">get_draw_props</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attributes</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_sheet</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">user_rois</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="n">draw_control</span><span class="o">.</span><span class="n">on_draw</span><span class="p">(</span><span class="n">handle_draw</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;measure_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;measure_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;measure_control&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MeasureControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;topleft&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;scale_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scale_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scale_control&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ScaleControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomleft&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;OpenStreetMap&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;google_map&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ROADMAP&quot;</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;ROADMAP&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;HYBRID&quot;</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;TERRAIN&quot;</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;TERRAIN&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;SATELLITE&quot;</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;SATELLITE&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;google_map&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> is invalid. google_map must be one of: [&quot;ROADMAP&quot;, &quot;HYBRID&quot;, &quot;TERRAIN&quot;, &quot;SATELLITE&quot;]. Adding the default ROADMAP.&#39;</span>
                <span class="p">)</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;ROADMAP&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;toolbar_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;toolbar_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;toolbar_control&quot;</span><span class="p">]:</span>
            <span class="kn">from</span> <span class="nn">.toolbar</span> <span class="kn">import</span> <span class="n">main_toolbar</span>

            <span class="n">main_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;use_voila&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;use_voila&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Centers the map view at a given coordinates with the given zoom level.</span>

<span class="sd">        Args:</span>
<span class="sd">            lon (float): The longitude of the center, in degrees.</span>
<span class="sd">            lat (float): The latitude of the center, in degrees.</span>
<span class="sd">            zoom (int, optional): The zoom level, from 1 to 24. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>

    <span class="k">def</span> <span class="nf">zoom_to_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zooms to a bounding box in the form of [minx, miny, maxx, maxy].</span>

<span class="sd">        Args:</span>
<span class="sd">            bounds (list | tuple): A list/tuple containing minx, miny, maxx, maxy values for the bounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#  The ipyleaflet fit_bounds method takes lat/lon bounds in the form [[south, west], [north, east]].</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

    <span class="k">def</span> <span class="nf">zoom_to_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zooms to the bounding box of a GeoPandas GeoDataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            gdf (GeoDataFrame): A GeoPandas GeoDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the approximate pixel scale of the current map view, in meters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Map resolution in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">math</span>

        <span class="n">zoom_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span>
        <span class="c1"># Reference: https://blogs.bing.com/maps/2006/02/25/map-control-zoom-levels-gt-resolution</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="mf">156543.04</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zoom_level</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resolution</span>

    <span class="k">def</span> <span class="nf">get_layer_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets layer names as a list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of layer names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">layer_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">layer_names</span>

    <span class="k">def</span> <span class="nf">add_marker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a marker to the map. More info about marker at https://ipyleaflet.readthedocs.io/en/latest/api_reference/marker.html.</span>

<span class="sd">        Args:</span>
<span class="sd">            location (list | tuple): The location of the marker in the format of [lat, lng].</span>

<span class="sd">            **kwargs: Keyword arguments for the marker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">location</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The location must be a list or a tuple.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_basemap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a basemap to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            basemap (str, optional): Can be one of string from basemaps. Defaults to &#39;HYBRID&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">xyzservices</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">layer_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layer_names</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">basemap</span><span class="p">,</span> <span class="n">xyzservices</span><span class="o">.</span><span class="n">TileProvider</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">name</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
                <span class="n">attribution</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">attribution</span>
                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">basemap</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">max_zoom</span> <span class="o">=</span> <span class="n">basemap</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">max_zoom</span> <span class="o">=</span> <span class="mi">22</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="n">max_zoom</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">basemap</span> <span class="ow">in</span> <span class="n">basemaps</span> <span class="ow">and</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layer_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">basemap</span> <span class="ow">in</span> <span class="n">basemaps</span> <span class="ow">and</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">layer_names</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basemap</span><span class="si">}</span><span class="s2"> has been already added before.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Basemap can only be one of the following:</span><span class="se">\n</span><span class="s2">  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Basemap can only be one of the following:</span><span class="se">\n</span><span class="s2">  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds layer by name</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the layer to find.</span>

<span class="sd">        Returns:</span>
<span class="sd">            object: ipyleaflet layer object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>

        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">layer</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">find_layer_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds layer index by name</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the layer to find.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Index of the layer with the specified name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">index</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a layer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            layer (ipyleaflet layer): The layer to be added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">existing_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_layer</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">existing_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_layer</span><span class="p">(</span><span class="n">existing_layer</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">layer_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes layer opacity.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the layer to change opacity.</span>
<span class="sd">            value (float, optional): The opacity value to set. Defaults to 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_layer</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_wms_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">layers</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
        <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a WMS layer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): The URL of the WMS web service.</span>
<span class="sd">            layers (str): Comma-separated list of WMS layers to show.</span>
<span class="sd">            name (str, optional): The layer name to use on the layer control. Defaults to None.</span>
<span class="sd">            attribution (str, optional): The attribution of the data layer. Defaults to &#39;&#39;.</span>
<span class="sd">            format (str, optional): WMS image format (use ‘image/png’ for layers with transparency). Defaults to &#39;image/png&#39;.</span>
<span class="sd">            transparent (bool, optional): If True, the WMS service will return images with transparency. Defaults to True.</span>
<span class="sd">            opacity (float, optional): The opacity of the layer. Defaults to 1.0.</span>
<span class="sd">            shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">wms_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WMSLayer</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
                <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
                <span class="n">visible</span><span class="o">=</span><span class="n">shown</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">wms_layer</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified WMS TileLayer.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_tile_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">attribution</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a TileLayer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): The URL of the tile layer.</span>
<span class="sd">            name (str): The layer name to use for the layer.</span>
<span class="sd">            attribution (str): The attribution to use.</span>
<span class="sd">            opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">            shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
                <span class="n">visible</span><span class="o">=</span><span class="n">shown</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">tile_layer</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified TileLayer.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_vector_tile_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://tile.nextzen.org/tilezen/vector/v1/512/all/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&quot;</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vector_tile_layer_styles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a VectorTileLayer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str, optional): The URL of the tile layer. Defaults to &#39;https://tile.nextzen.org/tilezen/vector/v1/512/all/{z}/{x}/{y}.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&#39;.</span>
<span class="sd">            attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">            vector_tile_layer_styles (dict,optional): Style dict, specific to the vector tile source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vector_tile_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">VectorTileLayer</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="n">vector_tile_layer_styles</span><span class="o">=</span><span class="n">vector_tile_layer_styles</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">vector_tile_layer</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified VectorTileLayer.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_geocode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">,</span>
        <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">by_osmid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM data of place(s) by name or ID to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str | dict | list): Query string(s) or structured dict(s) to geocode.</span>
<span class="sd">            which_result (int, optional): Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn&#39;t return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</span>
<span class="sd">            by_osmid (bool, optional): If True, handle query as an OSM ID for lookup rather than text search. Defaults to False.</span>
<span class="sd">            buffer_dist (float, optional): Distance to buffer around the place geometry, in meters. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_geocode</span><span class="p">(</span>
            <span class="n">query</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="n">which_result</span><span class="p">,</span> <span class="n">by_osmid</span><span class="o">=</span><span class="n">by_osmid</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="o">=</span><span class="n">buffer_dist</span>
        <span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_address</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">address</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within some distance N, S, E, W of address to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            address (str): The address to geocode and use as the central point around which to get the geometries.</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            dist (int, optional): Distance in meters. Defaults to 1000.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_address</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_place</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within boundaries of geocodable place(s) to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str | dict | list): Query string(s) or structured dict(s) to geocode.</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            which_result (int, optional): Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn&#39;t return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</span>
<span class="sd">            buffer_dist (float, optional): Distance to buffer around the place geometry, in meters. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_place</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">which_result</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_point</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">center_point</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within some distance N, S, E, W of a point to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            center_point (tuple): The (lat, lng) center point around which to get the geometries.</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            dist (int, optional): Distance in meters. Defaults to 1000.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_point</span><span class="p">(</span><span class="n">center_point</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_polygon</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">polygon</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within boundaries of a (multi)polygon to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            polygon (shapely.geometry.Polygon | shapely.geometry.MultiPolygon): Geographic boundaries to fetch geometries within</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_bbox</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">north</span><span class="p">,</span>
        <span class="n">south</span><span class="p">,</span>
        <span class="n">east</span><span class="p">,</span>
        <span class="n">west</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within a N, S, E, W bounding box to the map.</span>


<span class="sd">        Args:</span>
<span class="sd">            north (float): Northern latitude of bounding box.</span>
<span class="sd">            south (float): Southern latitude of bounding box.</span>
<span class="sd">            east (float): Eastern longitude of bounding box.</span>
<span class="sd">            west (float): Western longitude of bounding box.</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_bbox</span><span class="p">(</span><span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_osm_from_view</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds OSM entities within the current map view to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="mf">40.74824858675827</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.98933637940563</span><span class="p">),</span>
                <span class="p">(</span><span class="mf">40.75068694343106</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.98364473187601</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_bbox</span><span class="p">(</span><span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_cog_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">titiler_endpoint</span><span class="o">=</span><span class="s2">&quot;https://titiler.xyz&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a COG TileLayer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): The URL of the COG tile layer.</span>
<span class="sd">            name (str, optional): The layer name to use for the layer. Defaults to &#39;Untitled&#39;.</span>
<span class="sd">            attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">            opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">            shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">            bands (list, optional): A list of bands to use for the layer. Defaults to None.</span>
<span class="sd">            titiler_endpoint (str, optional): Titiler endpoint. Defaults to &quot;https://titiler.xyz&quot;.</span>
<span class="sd">            **kwargs: Arbitrary keyword arguments, including bidx, expression, nodata, unscale, resampling, rescale,</span>
<span class="sd">                color_formula, colormap, colormap_name, return_mask. See https://developmentseed.org/titiler/endpoints/cog/</span>
<span class="sd">                and https://cogeotiff.github.io/rio-tiler/colormap/. To select a certain bands, use bidx=[1, 2, 3].</span>
<span class="sd">                apply a rescaling to multiple bands, use something like `rescale=[&quot;164,223&quot;,&quot;130,211&quot;,&quot;99,212&quot;]`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tile_url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;titizer_endpoint&quot;</span><span class="p">:</span> <span class="n">titiler_endpoint</span><span class="p">,</span>
            <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;COG&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">add_cog_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;This function is no longer supported.See https://github.com/giswqs/leafmap/issues/180.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_cog_mosaic_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;This function is no longer supported.See https://github.com/giswqs/leafmap/issues/180.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_stac_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">collection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">item</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">assets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STAC Layer&quot;</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a STAC TileLayer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</span>
<span class="sd">            collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</span>
<span class="sd">            item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</span>
<span class="sd">            assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [&quot;SR_B7&quot;, &quot;SR_B5&quot;, &quot;SR_B4&quot;].</span>
<span class="sd">            bands (list): A list of band names, e.g., [&quot;SR_B7&quot;, &quot;SR_B5&quot;, &quot;SR_B4&quot;]</span>
<span class="sd">            titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;, &quot;https://planetarycomputer.microsoft.com/api/data/v1&quot;, &quot;planetary-computer&quot;, &quot;pc&quot;. Defaults to None.</span>
<span class="sd">            name (str, optional): The layer name to use for the layer. Defaults to &#39;STAC Layer&#39;.</span>
<span class="sd">            attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">            opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">            shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tile_url</span> <span class="o">=</span> <span class="n">stac_tile</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">stac_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">assets</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">assets</span> <span class="o">=</span> <span class="n">bands</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;collection&quot;</span><span class="p">:</span> <span class="n">collection</span><span class="p">,</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
            <span class="s2">&quot;assets&quot;</span><span class="p">:</span> <span class="n">assets</span><span class="p">,</span>
            <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
            <span class="s2">&quot;titiler_endpoint&quot;</span><span class="p">:</span> <span class="n">titiler_endpoint</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;STAC&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">add_mosaic_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mosaic Layer&quot;</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a STAC TileLayer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">            titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>
<span class="sd">            name (str, optional): The layer name to use for the layer. Defaults to &#39;Mosaic Layer&#39;.</span>
<span class="sd">            attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">            opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">            shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tile_url</span> <span class="o">=</span> <span class="n">mosaic_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="n">mosaic_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

    <span class="k">def</span> <span class="nf">add_minimap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a minimap (overview) to the ipyleaflet map.</span>

<span class="sd">        Args:</span>
<span class="sd">            zoom (int, optional): Initial map zoom level. Defaults to 5.</span>
<span class="sd">            position (str, optional): Position of the minimap. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">minimap</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
            <span class="n">zoom_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attribution_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span>
            <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;ROADMAP&quot;</span><span class="p">]],</span>
        <span class="p">)</span>
        <span class="n">minimap</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s2">&quot;150px&quot;</span>
        <span class="n">minimap</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">&quot;150px&quot;</span>
        <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">minimap</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">))</span>
        <span class="n">minimap_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">minimap</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">minimap_control</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_marker_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">add_marker</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Captures user inputs and add markers to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            event (str, optional): [description]. Defaults to &#39;click&#39;.</span>
<span class="sd">            add_marker (bool, optional): If True, add markers to the map. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            object: a marker cluster.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_click</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_clicks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">add_marker</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">handle_interaction</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">latlon</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span><span class="p">:</span>
                <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">latlon</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_click</span> <span class="o">=</span> <span class="n">latlon</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_clicks</span> <span class="o">=</span> <span class="n">coordinates</span>
                <span class="k">if</span> <span class="n">add_marker</span><span class="p">:</span>
                    <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">latlon</span><span class="p">))</span>
                    <span class="n">marker_cluster</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;mousemove&quot;</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># cursor style: https://www.w3schools.com/cssref/pr_class_cursor.asp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;crosshair&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction</span><span class="p">(</span><span class="n">handle_interaction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_circle_markers_from_xy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
        <span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a marker cluster to the map. For a list of options, see https://ipyleaflet.readthedocs.io/en/latest/api_reference/circle_marker.html</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str | pd.DataFrame): A csv or Pandas DataFrame containing x, y, z values.</span>
<span class="sd">            x (str, optional): The column name for the x values. Defaults to &quot;longitude&quot;.</span>
<span class="sd">            y (str, optional): The column name for the y values. Defaults to &quot;latitude&quot;.</span>
<span class="sd">            radius (int, optional): The radius of the circle. Defaults to 10.</span>
<span class="sd">            popup (list, optional): A list of column names to be used as the popup. Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">popup</span> <span class="o">=</span> <span class="n">col_names</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">popup</span> <span class="o">=</span> <span class="p">[</span><span class="n">popup</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="n">html</span> <span class="o">+</span> <span class="s2">&quot;&lt;b&gt;&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">p</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
            <span class="n">popup_html</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

            <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">CircleMarker</span><span class="p">(</span>
                <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">x</span><span class="p">]],</span>
                <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
                <span class="n">popup</span><span class="o">=</span><span class="n">popup_html</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">left_layer</span><span class="o">=</span><span class="s2">&quot;TERRAIN&quot;</span><span class="p">,</span>
        <span class="n">right_layer</span><span class="o">=</span><span class="s2">&quot;OpenTopoMap&quot;</span><span class="p">,</span>
        <span class="n">left_args</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">right_args</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">zoom_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fullscreen_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_close_button</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">left_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">right_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">left_position</span><span class="o">=</span><span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span>
        <span class="n">right_position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="n">widget_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds split map.</span>

<span class="sd">        Args:</span>
<span class="sd">            left_layer (str, optional): The left tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;TERRAIN&#39;.</span>
<span class="sd">            right_layer (str, optional): The right tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;OpenTopoMap&#39;.</span>
<span class="sd">            left_args (dict, optional): The arguments for the left tile layer. Defaults to {}.</span>
<span class="sd">            right_args (dict, optional): The arguments for the right tile layer. Defaults to {}.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
            <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
            <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
            <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
            <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
            <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Left Layer&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
            <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Right Layer&quot;</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">controls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_controls</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">zoom_control</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ZoomControl</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">fullscreen_control</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">FullScreenControl</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">left_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">left_name</span> <span class="o">=</span> <span class="n">left_label</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">left_name</span> <span class="o">=</span> <span class="s2">&quot;Left Layer&quot;</span>

            <span class="k">if</span> <span class="n">right_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">right_name</span> <span class="o">=</span> <span class="n">right_label</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">right_name</span> <span class="o">=</span> <span class="s2">&quot;Right Layer&quot;</span>

            <span class="k">if</span> <span class="n">left_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">left_layer</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                    <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">left_layer</span><span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">left_name</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">left_layer</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                        <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">left_layer</span><span class="p">,</span> <span class="n">left_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                            <span class="n">left_layer</span><span class="p">,</span>
                            <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                            <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">left_client</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">left_name</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
            <span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;left_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">right_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">right_layer</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                    <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span>
                        <span class="n">right_layer</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">right_layer</span><span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">right_name</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
                    <span class="s2">&quot;.geojson&quot;</span>
                <span class="p">):</span>

                    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">right_layer</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                        <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">right_layer</span><span class="p">,</span> <span class="n">right_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                            <span class="n">right_layer</span><span class="p">,</span>
                            <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                            <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">right_client</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">right_layer</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">right_name</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
            <span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;right_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
                <span class="p">)</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SplitMapControl</span><span class="p">(</span>
                <span class="n">left_layer</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="n">right_layer</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">left_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">widget_layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">widget_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
                <span class="n">left_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">left_label</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widget_layout</span><span class="p">)</span>

                <span class="n">left_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                    <span class="n">widget</span><span class="o">=</span><span class="n">left_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">left_position</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">left_control</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">right_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">widget_layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">widget_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
                <span class="n">right_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">right_label</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widget_layout</span><span class="p">)</span>
                <span class="n">right_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                    <span class="n">widget</span><span class="o">=</span><span class="n">right_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">right_position</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">right_control</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided layers are invalid!&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">basemap_demo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A demo for using leafmap basemaps.&quot;&quot;&quot;</span>
        <span class="n">dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
            <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="n">value</span><span class="o">=</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Basemaps&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
            <span class="n">basemap_name</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]</span>
            <span class="n">old_basemap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">substitute_layer</span><span class="p">(</span><span class="n">old_basemap</span><span class="p">,</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap_name</span><span class="p">])</span>

        <span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
        <span class="n">basemap_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">dropdown</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">basemap_control</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span>
        <span class="n">legend_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="n">builtin_legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a customized basemap to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            title (str, optional): Title of the legend. Defaults to &#39;Legend&#39;.</span>
<span class="sd">            legend_dict (dict, optional): A dictionary containing legend items as keys and color as values. If provided, legend_keys and legend_colors will be ignored. Defaults to None.</span>
<span class="sd">            labels (list, optional): A list of legend keys. Defaults to None.</span>
<span class="sd">            colors (list, optional): A list of legend colors. Defaults to None.</span>
<span class="sd">            position (str, optional): Position of the legend. Defaults to &#39;bottomright&#39;.</span>
<span class="sd">            builtin_legend (str, optional): Name of the builtin legend to add to the map. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): Layer name of the legend to be associated with. Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pkg_resources</span>
        <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

        <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span>
            <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;leafmap&quot;</span><span class="p">,</span> <span class="s2">&quot;leafmap.py&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">legend_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/template/legend.html&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;min_width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">min_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;max_width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_width&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;min_height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">min_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;min_height&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;max_height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">max_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_height&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="s2">&quot;300px&quot;</span>
        <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_height</span> <span class="o">=</span> <span class="s2">&quot;400px&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">legend_template</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend template does not exist.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys must be a list.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;One&quot;</span><span class="p">,</span> <span class="s2">&quot;Two&quot;</span><span class="p">,</span> <span class="s2">&quot;Three&quot;</span><span class="p">,</span> <span class="s2">&quot;Four&quot;</span><span class="p">,</span> <span class="s2">&quot;etc&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list of tuples.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;#8DD3C7&quot;</span><span class="p">,</span>
                <span class="s2">&quot;#FFFFB3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;#BEBADA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;#FB8072&quot;</span><span class="p">,</span>
                <span class="s2">&quot;#80B1D3&quot;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys and values must be the same length.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">allowed_builtin_legends</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_builtin_legends</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The builtin legend must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_builtin_legends</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">legend_dict</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="p">[</span><span class="n">builtin_legend</span><span class="p">]</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">legend_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend dict must be a dictionary.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="n">allowed_positions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;topleft&quot;</span><span class="p">,</span>
            <span class="s2">&quot;topright&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_positions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;The position must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_positions</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">content</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">footer</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">legend_template</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">footer</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">color</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span>
            <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;      &lt;li&gt;&lt;span style=&#39;background:</span><span class="si">{}</span><span class="s2">;&#39;&gt;&lt;/span&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">color</span><span class="p">,</span> <span class="n">key</span>
            <span class="p">)</span>
            <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="n">legend_html</span> <span class="o">=</span> <span class="n">header</span> <span class="o">+</span> <span class="n">content</span> <span class="o">+</span> <span class="n">footer</span>
        <span class="n">legend_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">legend_html</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">legend_output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
                <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
                    <span class="c1"># &quot;border&quot;: &quot;1px solid black&quot;,</span>
                    <span class="s2">&quot;max_width&quot;</span><span class="p">:</span> <span class="n">max_width</span><span class="p">,</span>
                    <span class="s2">&quot;min_width&quot;</span><span class="p">:</span> <span class="n">min_width</span><span class="p">,</span>
                    <span class="s2">&quot;max_height&quot;</span><span class="p">:</span> <span class="n">max_height</span><span class="p">,</span>
                    <span class="s2">&quot;min_height&quot;</span><span class="p">:</span> <span class="n">min_height</span><span class="p">,</span>
                    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
                    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
                    <span class="s2">&quot;overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">legend_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">legend_output_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span>
            <span class="p">)</span>
            <span class="n">legend_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">legend_text</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">legend_output_widget</span><span class="p">:</span>
                <span class="n">display</span><span class="p">(</span><span class="n">legend_widget</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">legend_widget</span> <span class="o">=</span> <span class="n">legend_output_widget</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">legend_control</span> <span class="o">=</span> <span class="n">legend_control</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">legend_control</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_colorbar</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="s2">&quot;45px&quot;</span><span class="p">,</span>
        <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a branca colorbar to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            colors (list): The set of colors to be used for interpolation. Colors can be provided in the form: * tuples of RGBA ints between 0 and 255 (e.g: (255, 255, 0) or (255, 255, 0, 255)) * tuples of RGBA floats between 0. and 1. (e.g: (1.,1.,0.) or (1., 1., 0., 1.)) * HTML-like string (e.g: “#ffff00) * a color name or shortcut (e.g: “y” or “yellow”)</span>
<span class="sd">            vmin (int, optional): The minimal value for the colormap. Values lower than vmin will be bound directly to colors[0].. Defaults to 0.</span>
<span class="sd">            vmax (float, optional): The maximal value for the colormap. Values higher than vmax will be bound directly to colors[-1]. Defaults to 1.0.</span>
<span class="sd">            index (list, optional):The values corresponding to each color. It has to be sorted, and have the same length as colors. If None, a regular grid between vmin and vmax is created.. Defaults to None.</span>
<span class="sd">            caption (str, optional): The caption for the colormap. Defaults to &quot;&quot;.</span>
<span class="sd">            categorical (bool, optional): Whether or not to create a categorical colormap. Defaults to False.</span>
<span class="sd">            step (int, optional): The step to split the LinearColormap into a StepColormap. Defaults to None.</span>
<span class="sd">            height (str, optional): The height of the colormap widget. Defaults to &quot;45px&quot;.</span>
<span class="sd">            transparent_bg (bool, optional): Whether to use transparent background for the colormap widget. Defaults to True.</span>
<span class="sd">            position (str, optional): The position for the colormap widget. Defaults to &quot;bottomright&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">box</span> <span class="kn">import</span> <span class="n">Box</span>
        <span class="kn">from</span> <span class="nn">branca.colormap</span> <span class="kn">import</span> <span class="n">LinearColormap</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

        <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">Box</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided color list is invalid.&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>

        <span class="n">colormap</span> <span class="o">=</span> <span class="n">LinearColormap</span><span class="p">(</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="n">caption</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">categorical</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">colormap_ctrl</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">transparent_bg</span><span class="o">=</span><span class="n">transparent_bg</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
            <span class="n">display</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">colormap_ctrl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">colormap_ctrl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_colormap</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">axis_off</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a matplotlib colormap to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            cmap (str, optional): Matplotlib colormap. Defaults to &quot;gray&quot;. See https://matplotlib.org/3.3.4/tutorials/colors/colormaps.html#sphx-glr-tutorials-colors-colormaps-py for options.</span>
<span class="sd">            colors (list, optional): A list of custom colors to create a colormap. Defaults to None.</span>
<span class="sd">            discrete (bool, optional): Whether to create a discrete colorbar. Defaults to False.</span>
<span class="sd">            label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">            width (float, optional): The width of the colormap. Defaults to 8.0.</span>
<span class="sd">            height (float, optional): The height of the colormap. Defaults to 0.4.</span>
<span class="sd">            orientation (str, optional): The orientation of the colormap. Defaults to &quot;horizontal&quot;.</span>
<span class="sd">            vmin (float, optional): The minimum value range. Defaults to 0.</span>
<span class="sd">            vmax (float, optional): The maximum value range. Defaults to 1.0.</span>
<span class="sd">            axis_off (bool, optional): Whether to turn axis off. Defaults to False.</span>
<span class="sd">            show_name (bool, optional): Whether to show the colormap name. Defaults to False.</span>
<span class="sd">            font_size (int, optional): Font size of the text. Defaults to 12.</span>
<span class="sd">            transparent_bg (bool, optional): Whether to use transparent background for the colormap widget. Defaults to True.</span>
<span class="sd">            position (str, optional): The position for the colormap widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.colormaps</span> <span class="kn">import</span> <span class="n">plot_colormap</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

        <span class="n">colormap_ctrl</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">transparent_bg</span><span class="o">=</span><span class="n">transparent_bg</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
            <span class="n">plot_colormap</span><span class="p">(</span>
                <span class="n">cmap</span><span class="p">,</span>
                <span class="n">colors</span><span class="p">,</span>
                <span class="n">discrete</span><span class="p">,</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="n">width</span><span class="p">,</span>
                <span class="n">height</span><span class="p">,</span>
                <span class="n">orientation</span><span class="p">,</span>
                <span class="n">vmin</span><span class="p">,</span>
                <span class="n">vmax</span><span class="p">,</span>
                <span class="n">axis_off</span><span class="p">,</span>
                <span class="n">show_name</span><span class="p">,</span>
                <span class="n">font_size</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">colormap_ctrl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">colormap_ctrl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">image_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overlays an image from the Internet or locally on the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): http URL or local file path to the image.</span>
<span class="sd">            bounds (tuple): bounding box of the image in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</span>
<span class="sd">            name (str): name of the layer to show on the layer control.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
        <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageSequence</span>
        <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided file does not exist.&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># file extension</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

                <span class="n">f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gif&quot;</span><span class="p">:</span>
                    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="c1"># Loop over each frame in the animated image</span>
                    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
                        <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;gif&quot;</span><span class="p">)</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
                    <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                        <span class="n">f</span><span class="p">,</span>
                        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
                        <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                        <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

                <span class="n">data</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;data:image/</span><span class="si">{}</span><span class="s2">;base64,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">+</span> <span class="n">data</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ImageOverlay</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">video_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overlays a video from the Internet on the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): http URL of the video, such as &quot;https://www.mapbox.com/bites/00188/patricia_nasa.webm&quot;</span>
<span class="sd">            bounds (tuple): bounding box of the video in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</span>
<span class="sd">            layer_name (str): name of the layer to show on the layer control.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">video</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">VideoOverlay</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My Map&quot;</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="s2">&quot;880px&quot;</span><span class="p">,</span>
        <span class="n">add_layer_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves the map as an HTML file.</span>

<span class="sd">        Args:</span>
<span class="sd">            outfile (str, optional): The output file path to the HTML file.</span>
<span class="sd">            title (str, optional): The title of the HTML file. Defaults to &#39;My Map&#39;.</span>
<span class="sd">            width (str, optional): The width of the map in pixels or percentage. Defaults to &#39;100%&#39;.</span>
<span class="sd">            height (str, optional): The height of the map in pixels. Defaults to &#39;880px&#39;.</span>
<span class="sd">            add_layer_control (bool, optional): Whether to add the LayersControl. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.html&quot;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The output file extension must be html.&quot;</span><span class="p">)</span>
                <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
                <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.html&quot;</span><span class="p">)</span>
                <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">add_layer_control</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_control</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">layer_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">LayersControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layer_control</span> <span class="o">=</span> <span class="n">layer_control</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">layer_control</span><span class="p">)</span>

            <span class="n">before_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span>
            <span class="n">before_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;width must be a string.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="n">width</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;px&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">width</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;width must end with px or %&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;height must be a string.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">height</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;px&quot;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;height must end with px&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">before_width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">before_height</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">save</span><span class="p">:</span>
                <span class="n">out_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                    <span class="n">out_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">out_html</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves the map as a PNG or JPG image.</span>

<span class="sd">        Args:</span>
<span class="sd">            outfile (str, optional): The output file path to the image. Defaults to None.</span>
<span class="sd">            monitor (int, optional): The monitor to take the screenshot. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;my_map.png&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.jpg&quot;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The output file must be a PNG or JPG image.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">work_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">work_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

        <span class="n">screenshot</span> <span class="o">=</span> <span class="n">screen_capture</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">monitor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">screenshot</span> <span class="o">=</span> <span class="n">screenshot</span>

    <span class="k">def</span> <span class="nf">to_streamlit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Renders map figure in a Streamlit app.</span>

<span class="sd">        Args:</span>
<span class="sd">            width (int, optional): Width of the map. Defaults to None.</span>
<span class="sd">            height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">            responsive (bool, optional): Whether to make the map responsive. Defaults to True.</span>
<span class="sd">            scrolling (bool, optional): If True, show a scrollbar when the content is larger than the iframe. Otherwise, do not show a scrollbar. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            streamlit.components: components.html object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">streamlit.components.v1</span> <span class="k">as</span> <span class="nn">components</span>

            <span class="c1"># if responsive:</span>
            <span class="c1">#     make_map_responsive = &quot;&quot;&quot;</span>
            <span class="c1">#     &lt;style&gt;</span>
            <span class="c1">#     [title~=&quot;st.iframe&quot;] { width: 100%}</span>
            <span class="c1">#     &lt;/style&gt;</span>
            <span class="c1">#     &quot;&quot;&quot;</span>
            <span class="c1">#     st.markdown(make_map_responsive, unsafe_allow_html=True)</span>
            <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="n">html</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="n">scrolling</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">toolbar_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset the toolbar so that no tool is selected.&quot;&quot;&quot;</span>
        <span class="n">toolbar_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>
        <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">toolbar_grid</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="n">tool</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">add_raster</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source</span><span class="p">,</span>
        <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Local COG&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a local raster dataset to the map.</span>
<span class="sd">            If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer) and</span>
<span class="sd">            if the raster does not render properly, try running the following code before calling this function:</span>

<span class="sd">            import os</span>
<span class="sd">            os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            source (str): The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</span>
<span class="sd">            band (int, optional): The band to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">            palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">            vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">            attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to &#39;Local COG&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tile_layer</span><span class="p">,</span> <span class="n">tile_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">tile_layer</span><span class="p">)</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>  <span class="c1"># [ymin, ymax, xmin, xmax]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>  <span class="c1"># [minx, miny, maxx, maxy]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">band_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tile_client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tile_layer&quot;</span><span class="p">:</span> <span class="n">tile_layer</span><span class="p">,</span>
            <span class="s2">&quot;tile_client&quot;</span><span class="p">:</span> <span class="n">tile_client</span><span class="p">,</span>
            <span class="s2">&quot;band&quot;</span><span class="p">:</span> <span class="n">band</span><span class="p">,</span>
            <span class="s2">&quot;band_names&quot;</span><span class="p">:</span> <span class="n">band_names</span><span class="p">,</span>
            <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LOCAL&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

    <span class="n">add_local_tile</span> <span class="o">=</span> <span class="n">add_raster</span>

    <span class="k">def</span> <span class="nf">add_remote_tile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source</span><span class="p">,</span>
        <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a remote Cloud Optimized GeoTIFF (COG) to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            source (str): The path to the remote Cloud Optimized GeoTIFF.</span>
<span class="sd">            band (int, optional): The band to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">            palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">            vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">            attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span>
                <span class="n">source</span><span class="p">,</span>
                <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
                <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The source must be a URL.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_netcdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;NetCDF layer&quot;</span><span class="p">,</span>
        <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
        <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
        <span class="n">lev</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span>
        <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate an ipyleaflet/folium TileLayer from a netCDF file.</span>
<span class="sd">            If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer),</span>
<span class="sd">            try adding to following two lines to the beginning of the notebook if the raster does not render properly.</span>

<span class="sd">            import os</span>
<span class="sd">            os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = f&#39;{os.environ[&#39;JUPYTERHUB_SERVICE_PREFIX&#39;].lstrip(&#39;/&#39;)}/proxy/{{port}}&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File path or HTTP URL to the netCDF file.</span>
<span class="sd">            variables (int, optional): The variable/band names to extract data from the netCDF file. Defaults to None. If None, all variables will be extracted.</span>
<span class="sd">            port (str, optional): The port to use for the server. Defaults to &quot;default&quot;.</span>
<span class="sd">            palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">            vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">            nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">            attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to &quot;netCDF layer&quot;.</span>
<span class="sd">            shift_lon (bool, optional): Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</span>
<span class="sd">            lat (str, optional): Name of the latitude variable. Defaults to &#39;lat&#39;.</span>
<span class="sd">            lon (str, optional): Name of the longitude variable. Defaults to &#39;lon&#39;.</span>
<span class="sd">            lev (str, optional): Name of the level variable. Defaults to &#39;lev&#39;.</span>
<span class="sd">            level_index (int, optional): Index of level to use. Defaults to 0&#39;.</span>
<span class="sd">            time (int, optional): Index of time to use. Defaults to 0&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tif</span><span class="p">,</span> <span class="nb">vars</span> <span class="o">=</span> <span class="n">netcdf_to_tif</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">shift_lon</span><span class="o">=</span><span class="n">shift_lon</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span>
            <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span>
            <span class="n">lev</span><span class="o">=</span><span class="n">lev</span><span class="p">,</span>
            <span class="n">level_index</span><span class="o">=</span><span class="n">level_index</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">return_vars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">vars</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The variables must be a subset of </span><span class="si">{</span><span class="nb">vars</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="nb">vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span>
            <span class="n">tif</span><span class="p">,</span>
            <span class="n">band</span><span class="o">=</span><span class="n">band_idx</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_raster_legacy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">x_dim</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y_dim</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a local raster dataset to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            image (str): The image file path.</span>
<span class="sd">            bands (int or list, optional): The image bands to use. It can be either a number (e.g., 1) or a list (e.g., [3, 2, 1]). Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to use for the raster. Defaults to None.</span>
<span class="sd">            colormap (str, optional): The name of the colormap to use for the raster, such as &#39;gray&#39; and &#39;terrain&#39;. More can be found at https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html. Defaults to None.</span>
<span class="sd">            x_dim (str, optional): The x dimension. Defaults to &#39;x&#39;.</span>
<span class="sd">            y_dim (str, optional): The y dimension. Defaults to &#39;y&#39;.</span>
<span class="sd">            fit_bounds (bool, optional): Whether to fit map bounds to raster bounds.  Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">xarray_leaflet</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># import platform</span>
            <span class="c1"># if platform.system() != &quot;Windows&quot;:</span>
            <span class="c1">#     # install_from_github(</span>
            <span class="c1">#     #     url=&#39;https://github.com/davidbrochart/xarray_leaflet&#39;)</span>
            <span class="c1">#     check_install(&#39;xarray_leaflet&#39;)</span>
            <span class="c1">#     import xarray_leaflet</span>
            <span class="c1"># else:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;You need to install xarray_leaflet first. See https://github.com/davidbrochart/xarray_leaflet&quot;</span>
            <span class="p">)</span>

        <span class="kn">import</span> <span class="nn">warnings</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="kn">import</span> <span class="nn">rioxarray</span>

        <span class="c1"># import xarray as xr</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The image file does not exist.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>

        <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="s2">&quot;Layer_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>

        <span class="n">da</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># print(da.rio.nodata)</span>

        <span class="n">multi_band</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">band</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">multi_band</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bands</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">multi_band</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">bands</span><span class="p">)</span>

        <span class="c1"># crs = da.rio.crs</span>
        <span class="c1"># nan = da.attrs[&#39;nodatavals&#39;][0]</span>
        <span class="c1"># da = da / da.max()</span>
        <span class="c1"># # if multi_band:</span>
        <span class="c1"># da = xr.where(da == nan, np.nan, da)</span>
        <span class="c1"># da = da.rio.write_nodata(0)</span>
        <span class="c1"># da = da.rio.write_crs(crs)</span>

        <span class="k">if</span> <span class="n">multi_band</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">leaflet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">rgb_dim</span><span class="o">=</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="n">fit_bounds</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">leaflet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="n">fit_bounds</span>
            <span class="p">)</span>

        <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">layer_name</span>

    <span class="k">def</span> <span class="nf">add_shp</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">in_shp</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a shapefile to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            in_shp (str): The input file path or HTTP URL (*.zip) to the shapefile.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: The provided shapefile could not be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">glob</span>

        <span class="k">if</span> <span class="n">in_shp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_shp</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;./cache/shp&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
            <span class="c1"># download_from_url(in_shp, out_dir=out_dir, verbose=False)</span>
            <span class="n">download_file</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;*.shp&quot;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">in_shp</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="s2">&quot;The downloaded zip file does not contain any shapefile in the root directory.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_shp</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided shapefile could not be found.&quot;</span><span class="p">)</span>

        <span class="n">geojson</span> <span class="o">=</span> <span class="n">shp_to_geojson</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_geojson</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">in_geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a GeoJSON file to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            in_geojson (str | dict): The file path or http URL to the input GeoJSON or a dictionary containing the geojson.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">            encoding (str, optional): The encoding of the GeoJSON file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: The provided GeoJSON file could not be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">json</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="kn">import</span> <span class="nn">requests</span>

        <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">in_geojson</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">is_jupyterlite</span><span class="p">():</span>
                        <span class="kn">import</span> <span class="nn">pyodide</span>

                        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>

                        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">open_url</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                            <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fd</span><span class="p">)</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                            <span class="s2">&quot;The provided GeoJSON file could not be found.&quot;</span>
                        <span class="p">)</span>

                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">in_geojson</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The input geojson must be a type of str or dict.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
                <span class="c1"># &quot;stroke&quot;: True,</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="c1"># &quot;fill&quot;: True,</span>
                <span class="c1"># &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
                <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="c1"># &quot;dashArray&quot;: &quot;9&quot;</span>
                <span class="c1"># &quot;clickable&quot;: True,</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="s2">&quot;weight&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hover_style</span><span class="p">:</span>
            <span class="n">hover_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

        <span class="k">def</span> <span class="nf">random_color</span><span class="p">(</span><span class="n">feature</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">fill_colors</span><span class="p">),</span>
            <span class="p">}</span>

        <span class="n">toolbar_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Toolbar&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">close_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Close the tool&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="s2">&quot;times&quot;</span><span class="p">,</span>
            <span class="c1"># button_style=&quot;primary&quot;,</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">html</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">()</span>
        <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="s2">&quot;0px 10px 0px 10px&quot;</span>
        <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">max_height</span> <span class="o">=</span> <span class="s2">&quot;250px&quot;</span>
        <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="s2">&quot;250px&quot;</span>

        <span class="n">output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
            <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">]),</span> <span class="n">html</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">info_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">output_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">info_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span> <span class="s2">&quot;on_click&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">info_control</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">toolbar_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
                <span class="n">close_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">output_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">]),</span> <span class="n">html</span><span class="p">])</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">])]</span>

        <span class="n">toolbar_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">toolbar_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">close_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
                <span class="n">toolbar_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">info_control</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_control</span><span class="p">(</span><span class="n">info_control</span><span class="p">)</span>
                <span class="n">output_widget</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">close_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">close_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">update_html</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

            <span class="n">value</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;&lt;b&gt;</span><span class="si">{}</span><span class="s2">: &lt;/b&gt;</span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="n">html</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style_callback</span> <span class="o">=</span> <span class="n">random_color</span>

        <span class="k">if</span> <span class="n">style_callback_only</span><span class="p">:</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
                <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
                <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
                <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">info_mode</span> <span class="o">==</span> <span class="s2">&quot;on_hover&quot;</span><span class="p">:</span>
            <span class="n">geojson</span><span class="o">.</span><span class="n">on_hover</span><span class="p">(</span><span class="n">update_html</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">info_mode</span> <span class="o">==</span> <span class="s2">&quot;on_click&quot;</span><span class="p">:</span>
            <span class="n">geojson</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">update_html</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geojson_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;json_layer_dict&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">json_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">,</span>
            <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span>
            <span class="s2">&quot;hover_style&quot;</span><span class="p">:</span> <span class="n">hover_style</span><span class="p">,</span>
            <span class="s2">&quot;style_callback&quot;</span><span class="p">:</span> <span class="n">style_callback</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_layer_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">add_search_control</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topleft&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a search control to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): The url to the search API. For example, &quot;https://nominatim.openstreetmap.org/search?format=json&amp;q={s}&quot;.</span>
<span class="sd">            marker (ipyleaflet.Marker, optional): The marker to be used for the search result. Defaults to None.</span>
<span class="sd">            zoom (int, optional): The zoom level to be used for the search result. Defaults to None.</span>
<span class="sd">            position (str, optional): The position of the search control. Defaults to &quot;topleft&quot;.</span>
<span class="sd">            kwargs (dict, optional): Additional keyword arguments to be passed to the search control. See https://ipyleaflet.readthedocs.io/en/latest/api_reference/search_control.html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                <span class="n">icon</span><span class="o">=</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;check&quot;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">icon_color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">search_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SearchControl</span><span class="p">(</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">search_control</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_control</span> <span class="o">=</span> <span class="n">search_control</span>

    <span class="k">def</span> <span class="nf">add_gdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gdf</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a GeoDataFrame to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            gdf (GeoDataFrame): A GeoPandas GeoDataFrame.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">            zoom_to_layer (bool, optional): Whether to zoom to the layer.</span>
<span class="sd">            encoding (str, optional): The encoding of the GeoDataFrame. Defaults to &quot;utf-8&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">gdf_to_geojson</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">zoom_to_layer</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

            <span class="n">bounds</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">west</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;minx&quot;</span><span class="p">])</span>
            <span class="n">south</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;miny&quot;</span><span class="p">])</span>
            <span class="n">east</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;maxx&quot;</span><span class="p">])</span>
            <span class="n">north</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;maxy&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">],</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">]])</span>

    <span class="k">def</span> <span class="nf">add_gdf_from_postgis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sql</span><span class="p">,</span>
        <span class="n">con</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a PostGIS database and returns data as a GeoDataFrame to be added to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            sql (str): SQL query to execute in selecting entries from database, or name of the table to read from the database.</span>
<span class="sd">            con (sqlalchemy.engine.Engine): Active connection to the database to query.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">            zoom_to_layer (bool, optional): Whether to zoom to the layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_gdf</span><span class="p">(</span>
            <span class="n">gdf</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">zoom_to_layer</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_kml</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">in_kml</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a KML file to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            in_kml (str): The input file path or HTTP URL to the KML.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: The provided KML file could not be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">in_kml</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_kml</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.kml&quot;</span><span class="p">):</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
            <span class="n">in_kml</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The downloaded kml file could not be found.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_kml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided KML could not be found.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_vector</span><span class="p">(</span>
            <span class="n">in_kml</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_vector</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds any geopandas-supported vector dataset to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO).</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            bbox (tuple | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter features by given bounding box, GeoSeries, GeoDataFrame or a shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with mask. Defaults to None.</span>
<span class="sd">            mask (dict | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter for features that intersect with the given dict-like geojson geometry, GeoSeries, GeoDataFrame or shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with bbox. Defaults to None.</span>
<span class="sd">            rows (int or slice, optional): Load in specific rows by passing an integer (first n rows) or a slice() object.. Defaults to None.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">            encoding (str, optional): The encoding to use to read the file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.shp&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_shp</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">layer_name</span><span class="p">,</span>
                <span class="n">style</span><span class="p">,</span>
                <span class="n">hover_style</span><span class="p">,</span>
                <span class="n">style_callback</span><span class="p">,</span>
                <span class="n">fill_colors</span><span class="p">,</span>
                <span class="n">info_mode</span><span class="p">,</span>
                <span class="n">encoding</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">layer_name</span><span class="p">,</span>
                <span class="n">style</span><span class="p">,</span>
                <span class="n">hover_style</span><span class="p">,</span>
                <span class="n">style_callback</span><span class="p">,</span>
                <span class="n">fill_colors</span><span class="p">,</span>
                <span class="n">info_mode</span><span class="p">,</span>
                <span class="n">encoding</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="n">vector_to_geojson</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
                <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                <span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
                <span class="n">geojson</span><span class="p">,</span>
                <span class="n">layer_name</span><span class="p">,</span>
                <span class="n">style</span><span class="p">,</span>
                <span class="n">hover_style</span><span class="p">,</span>
                <span class="n">style_callback</span><span class="p">,</span>
                <span class="n">fill_colors</span><span class="p">,</span>
                <span class="n">info_mode</span><span class="p">,</span>
                <span class="n">encoding</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_xy_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">in_csv</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker cluster&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds points from a CSV file containing lat/lon information and display data on the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            in_csv (str): The file path to the input CSV file.</span>
<span class="sd">            x (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">            y (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">            label (str, optional): The name of the column containing label information to used for marker popup. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to &quot;Marker cluster&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: The specified input csv does not exist.</span>
<span class="sd">            ValueError: The specified x column does not exist.</span>
<span class="sd">            ValueError: The specified y column does not exist.</span>
<span class="sd">            ValueError: The specified label column does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">in_csv</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>

        <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;label must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;wait&quot;</span><span class="p">}</span>

        <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                    <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span>
            <span class="p">]</span>

        <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">add_point_layer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a point layer to the map with a popup attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): str, http url, path object or file-like object. Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO)</span>
<span class="sd">            popup (str | list, optional): Column name(s) to be used for popup. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): A layer name to use. Defaults to &quot;Marker Cluster&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specified column name does not exist.</span>
<span class="sd">            ValueError: If the specified column names do not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
        <span class="kn">import</span> <span class="nn">fiona</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;wait&quot;</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.kml&quot;</span><span class="p">:</span>
                <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span>
        <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;popup must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">col_names</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;All popup items must be select from: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span>

        <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">popup</span><span class="p">]</span>
                <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                        <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                        <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;popup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

                <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                        <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                        <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
                <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span>
            <span class="p">]</span>

        <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">add_points_from_xy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
        <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">,</span>
        <span class="n">color_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">icon_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">],</span>
        <span class="n">icon_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">],</span>
        <span class="n">spin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a marker cluster to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str | pd.DataFrame): A csv or Pandas DataFrame containing x, y, z values.</span>
<span class="sd">            x (str, optional): The column name for the x values. Defaults to &quot;longitude&quot;.</span>
<span class="sd">            y (str, optional): The column name for the y values. Defaults to &quot;latitude&quot;.</span>
<span class="sd">            popup (list, optional): A list of column names to be used as the popup. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The name of the layer. Defaults to &quot;Marker Cluster&quot;.</span>
<span class="sd">            color_column (str, optional): The column name for the color values. Defaults to None.</span>
<span class="sd">            marker_colors (list, optional): A list of colors to be used for the markers. Defaults to None.</span>
<span class="sd">            icon_colors (list, optional): A list of colors to be used for the icons. Defaults to [&#39;white&#39;].</span>
<span class="sd">            icon_names (list, optional): A list of names to be used for the icons. More icons can be found at https://fontawesome.com/v4/icons. Defaults to [&#39;info&#39;].</span>
<span class="sd">            spin (bool, optional): If True, the icon will spin. Defaults to False.</span>
<span class="sd">            add_legend (bool, optional): If True, a legend will be added to the map. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">color_options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;purple&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lightred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;beige&quot;</span><span class="p">,</span>
            <span class="s2">&quot;darkblue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cadetblue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;darkpurple&quot;</span><span class="p">,</span>
            <span class="s2">&quot;white&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">points_from_xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> does not exist in the dataframe.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">]))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">marker_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_options</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is greater than the number of available colors.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">marker_colors</span> <span class="o">=</span> <span class="n">color_options</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">marker_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker_colors</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">icon_colors</span> <span class="o">=</span> <span class="n">icon_colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_colors</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">icon_names</span> <span class="o">=</span> <span class="n">icon_names</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="n">col_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;popup must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">col_names</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;All popup items must be select from: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">popup</span> <span class="o">=</span> <span class="n">col_names</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span>

        <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">popup</span><span class="p">]</span>

                <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span>
                            <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
                        <span class="p">]</span>
                        <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                        <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                        <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                            <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                            <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                            <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                        <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                        <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
                        <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">label</span>
                            <span class="o">+</span> <span class="s2">&quot;&lt;b&gt;&quot;</span>
                            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                            <span class="o">+</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span>
                            <span class="o">+</span> <span class="s2">&quot;: &quot;</span>
                            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                            <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                        <span class="p">)</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;popup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

                <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span>
                            <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
                        <span class="p">]</span>
                        <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                        <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                        <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                            <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                            <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                            <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                        <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                        <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
                        <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                        <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                        <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                        <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span>
                <span class="p">)</span>
                <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

        <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">add_legend</span><span class="p">:</span>
            <span class="n">marker_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">marker_colors</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
                <span class="n">title</span><span class="o">=</span><span class="n">color_column</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="n">colors</span><span class="o">=</span><span class="n">marker_colors</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">items</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">add_heatmap</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
        <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Heat map&quot;</span><span class="p">,</span>
        <span class="n">radius</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a heat map to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/heatmap.html</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str | list | pd.DataFrame): File path or HTTP URL to the input file or a list of data points in the format of [[x1, y1, z1], [x2, y2, z2]]. For example, https://raw.githubusercontent.com/giswqs/leafmap/master/examples/data/world_cities.csv</span>
<span class="sd">            latitude (str, optional): The column name of latitude. Defaults to &quot;latitude&quot;.</span>
<span class="sd">            longitude (str, optional): The column name of longitude. Defaults to &quot;longitude&quot;.</span>
<span class="sd">            value (str, optional): The column name of values. Defaults to &quot;value&quot;.</span>
<span class="sd">            name (str, optional): Layer name to use. Defaults to &quot;Heat map&quot;.</span>
<span class="sd">            radius (int, optional): Radius of each “point” of the heatmap. Defaults to 25.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If data is not a list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="kn">from</span> <span class="nn">ipyleaflet</span> <span class="kn">import</span> <span class="n">Heatmap</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data must be a list, a DataFrame, or a file path.&quot;</span><span class="p">)</span>

            <span class="n">heatmap</span> <span class="o">=</span> <span class="n">Heatmap</span><span class="p">(</span><span class="n">locations</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_labels</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="s2">&quot;12pt&quot;</span><span class="p">,</span>
        <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span>
        <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
        <span class="n">draggable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a label layer to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/divicon.html</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.DataFrame | gpd.GeoDataFrame | str): The input data to label.</span>
<span class="sd">            column (str): The column name of the data to label.</span>
<span class="sd">            font_size (str, optional): The font size of the labels. Defaults to &quot;12pt&quot;.</span>
<span class="sd">            font_color (str, optional): The font color of the labels. Defaults to &quot;black&quot;.</span>
<span class="sd">            font_family (str, optional): The font family of the labels. Defaults to &quot;arial&quot;.</span>
<span class="sd">            font_weight (str, optional): The font weight of the labels, can be normal, bold. Defaults to &quot;normal&quot;.</span>
<span class="sd">            x (str, optional): The column name of the longitude. Defaults to &quot;longitude&quot;.</span>
<span class="sd">            y (str, optional): The column name of the latitude. Defaults to &quot;latitude&quot;.</span>
<span class="sd">            draggable (bool, optional): Whether the labels are draggable. Defaults to True.</span>
<span class="sd">            layer_name (str, optional): Layer name to use. Defaults to &quot;Labels&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;geom&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span>
                <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

                    <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;geopandas is required to read geojson.&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;data must be a pd.DataFrame, gpd.GeoDataFrame, or an ee.FeatureCollection.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">font_size</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;pt&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;font_size must be something like &#39;10pt&#39;&quot;</span><span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">font_size</span><span class="si">}</span><span class="s1">;color:</span><span class="si">{</span><span class="n">font_color</span><span class="si">}</span><span class="s1">;font-family:</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="s1">;font-weight: </span><span class="si">{</span><span class="n">font_weight</span><span class="si">}</span><span class="s1">&quot;&gt;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">][</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/div&gt;&#39;</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">index</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">index</span><span class="p">]],</span>
                <span class="n">icon</span><span class="o">=</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">DivIcon</span><span class="p">(</span>
                    <span class="n">icon_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">icon_anchor</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">=</span><span class="n">html</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">draggable</span><span class="o">=</span><span class="n">draggable</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
        <span class="n">layer_group</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">LayerGroup</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer_group</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">layer_group</span>

    <span class="k">def</span> <span class="nf">remove_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes all labels from the map.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_planet_by_month</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
        <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a Planet global mosaic by month to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">        Args:</span>
<span class="sd">            year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">            month (int, optional): The month of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">            api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">            token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">planet_tile_by_month</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_planet_by_quarter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
        <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a Planet global mosaic by quarter to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">        Args:</span>
<span class="sd">            year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">            quarter (int, optional): The quarter of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">            layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">            api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">            token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">planet_tile_by_quarter</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_time_slider</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">layers_dict</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="n">slider_length</span><span class="o">=</span><span class="s2">&quot;150px&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a time slider to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            layers_dict (dict, optional): The dictionary containing a set of XYZ tile layers.</span>
<span class="sd">            labels (list, optional): The list of labels to be used for the time series. Defaults to None.</span>
<span class="sd">            time_interval (int, optional): Time interval in seconds. Defaults to 1.</span>
<span class="sd">            position (str, optional): Position to place the time slider, can be any of [&#39;topleft&#39;, &#39;topright&#39;, &#39;bottomleft&#39;, &#39;bottomright&#39;]. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">            slider_length (str, optional): Length of the time slider. Defaults to &quot;150px&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.toolbar</span> <span class="kn">import</span> <span class="n">time_slider</span>

        <span class="n">time_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layers_dict</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">slider_length</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">static_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">950</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display an ipyleaflet static map in a Jupyter Notebook.</span>

<span class="sd">        Args</span>
<span class="sd">            m (ipyleaflet.Map): An ipyleaflet map.</span>
<span class="sd">            width (int, optional): Width of the map. Defaults to 950.</span>
<span class="sd">            height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">            read_only (bool, optional): Whether to hide the side panel to disable map customization. Defaults to False.</span>
<span class="sd">            out_file (str, optional): Output html file path. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Map</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">out_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">out_file</span> <span class="o">=</span> <span class="s2">&quot;./cache/&quot;</span> <span class="o">+</span> <span class="s2">&quot;leafmap_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.html&quot;</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_file</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
            <span class="n">display_html</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">out_file</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided map is not an ipyleaflet map.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_census_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wms</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">census_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a census data layer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            wms (str): The wms to use. For example, &quot;Current&quot;, &quot;ACS 2021&quot;, &quot;Census 2020&quot;.  See the complete list at https://tigerweb.geo.census.gov/tigerwebmain/TIGERweb_wms.html</span>
<span class="sd">            layer (str): The layer name to add to the map.</span>
<span class="sd">            census_dict (dict, optional): A dictionary containing census data. Defaults to None. It can be obtained from the get_census_dict() function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">census_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">census_dict</span> <span class="o">=</span> <span class="n">get_census_dict</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">wms</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">census_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The provided WMS is invalid. It must be one of </span><span class="si">{</span><span class="n">census_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">layers</span> <span class="o">=</span> <span class="n">census_dict</span><span class="p">[</span><span class="n">wms</span><span class="p">][</span><span class="s2">&quot;layers&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">layer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The layer name is not valid. It must be one of </span><span class="si">{</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">url</span> <span class="o">=</span> <span class="n">census_dict</span><span class="p">[</span><span class="n">wms</span><span class="p">][</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer</span>
            <span class="k">if</span> <span class="s2">&quot;attribution&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;attribution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U.S. Census Bureau&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;image/png&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;transparent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transparent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_xyz_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a XYZ tile layer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            provider (str): A tile layer name starts with xyz or qms. For example, xyz.OpenTopoMap,</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: The provider is not valid. It must start with xyz or qms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">xyzservices</span>
        <span class="kn">import</span> <span class="nn">xyzservices.providers</span> <span class="k">as</span> <span class="nn">xyz</span>

        <span class="k">if</span> <span class="n">provider</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">provider</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
            <span class="n">xyz_provider</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">xyz_provider</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
            <span class="n">attribution</span> <span class="o">=</span> <span class="n">xyz_provider</span><span class="o">.</span><span class="n">attribution</span>
            <span class="k">if</span> <span class="n">attribution</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">attribution</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">provider</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;qms&quot;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">provider</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
            <span class="n">qms_provider</span> <span class="o">=</span> <span class="n">xyzservices</span><span class="o">.</span><span class="n">TileProvider</span><span class="o">.</span><span class="n">from_qms</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">qms_provider</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
            <span class="n">attribution</span> <span class="o">=</span> <span class="n">qms_provider</span><span class="o">.</span><span class="n">attribution</span>
            <span class="k">if</span> <span class="n">attribution</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">attribution</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The provider </span><span class="si">{</span><span class="n">provider</span><span class="si">}</span><span class="s2"> is not valid. It must start with xyz or qms.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="s2">&quot;16px&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The ipyleaflet map does not support titles.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_pc_collections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the list of Microsoft Planetary Computer collections.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pc_collections&quot;</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pc_collections&quot;</span><span class="p">,</span> <span class="n">get_pc_collections</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">save_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the draw features to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            out_file (str): The output file path.</span>
<span class="sd">            indent (int, optional): The indentation level when saving data as a GeoJSON. Defaults to 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">json</span>

        <span class="n">out_file</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">:</span>
            <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">out_file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.geojson&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_draw_features</span><span class="p">()</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.shp&quot;</span><span class="p">:</span>
                <span class="n">geojson_to_shp</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">geojson_to_gpkg</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the draw features by removing features that have been edited and no longer exist.&quot;&quot;&quot;</span>

        <span class="n">geometries</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the properties of the draw features.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int, optional): The maximum number of attributes to return. Defaults to None.</span>
<span class="sd">            return_df (bool, optional): If True, return a pandas dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: A pandas dataframe containing the properties of the draw features.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">[:]</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">props</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">))</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">)})</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">props</span>

    <span class="k">def</span> <span class="nf">update_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the draw features properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A pandas dataframe containing the properties of the draw features.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Key&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;edited&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_draw_features</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;created&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;edited&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_draw</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
                            <span class="o">==</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
                        <span class="p">):</span>
                            <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">edit_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit a vector layer.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict | str): The data to edit. It can be a GeoJSON dictionary or a file path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">check_package</span><span class="p">(</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
            <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf_to_geojson</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span> <span class="n">tuple_to_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The data must be a GeoJSON dictionary or a file path to a vector dataset.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="p">(</span><span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span> <span class="o">+</span> <span class="p">(</span><span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">add_velocity</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">zonal_speed</span><span class="p">,</span>
        <span class="n">meridional_speed</span><span class="p">,</span>
        <span class="n">latitude_dimension</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
        <span class="n">longitude_dimension</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
        <span class="n">level_dimension</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span>
        <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">time_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">velocity_scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">max_velocity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">display_options</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Velocity&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a velocity layer to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str | xr.Dataset): The data to use for the velocity layer. It can be a file path to a NetCDF file or an xarray Dataset.</span>
<span class="sd">            zonal_speed (str): Name of the zonal speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</span>
<span class="sd">            meridional_speed (str): Name of the meridional speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</span>
<span class="sd">            latitude_dimension (str, optional): Name of the latitude dimension in the dataset. Defaults to &#39;lat&#39;.</span>
<span class="sd">            longitude_dimension (str, optional): Name of the longitude dimension in the dataset. Defaults to &#39;lon&#39;.</span>
<span class="sd">            level_dimension (str, optional): Name of the level dimension in the dataset. Defaults to &#39;lev&#39;.</span>
<span class="sd">            level_index (int, optional): The index of the level dimension to display. Defaults to 0.</span>
<span class="sd">            time_index (int, optional): The index of the time dimension to display. Defaults to 0.</span>
<span class="sd">            velocity_scale (float, optional): The scale of the velocity. Defaults to 0.01.</span>
<span class="sd">            max_velocity (int, optional): The maximum velocity to display. Defaults to 20.</span>
<span class="sd">            display_options (dict, optional): The display options for the velocity layer. Defaults to {}. See https://bit.ly/3uf8t6w.</span>
<span class="sd">            name (str, optional): Layer name to use . Defaults to &#39;Velocity&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ImportError: If the xarray package is not installed.</span>
<span class="sd">            ValueError: If the data is not a NetCDF file or an xarray Dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
            <span class="kn">from</span> <span class="nn">ipyleaflet.velocity</span> <span class="kn">import</span> <span class="n">Velocity</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;The xarray package is required to add a velocity layer. &quot;</span>
                <span class="s2">&quot;Please install it with `pip install xarray`.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The data must be a file path or xarray dataset.&quot;</span><span class="p">)</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Rasterio does not handle time or levels. So we must drop them</span>
        <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_index</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">level_dimension</span><span class="p">:</span> <span class="n">level_index</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">level_dimension</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">wind</span> <span class="o">=</span> <span class="n">Velocity</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
            <span class="n">zonal_speed</span><span class="o">=</span><span class="n">zonal_speed</span><span class="p">,</span>
            <span class="n">meridional_speed</span><span class="o">=</span><span class="n">meridional_speed</span><span class="p">,</span>
            <span class="n">latitude_dimension</span><span class="o">=</span><span class="n">latitude_dimension</span><span class="p">,</span>
            <span class="n">longitude_dimension</span><span class="o">=</span><span class="n">longitude_dimension</span><span class="p">,</span>
            <span class="n">velocity_scale</span><span class="o">=</span><span class="n">velocity_scale</span><span class="p">,</span>
            <span class="n">max_velocity</span><span class="o">=</span><span class="n">max_velocity</span><span class="p">,</span>
            <span class="n">display_options</span><span class="o">=</span><span class="n">display_options</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">wind</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;Quantiles&quot;</span><span class="p">,</span>
        <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend_position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add vector data to the map with a variety of classification schemes.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str | pd.DataFrame | gpd.GeoDataFrame): The data to classify. It can be a filepath to a vector dataset, a pandas dataframe, or a geopandas geodataframe.</span>
<span class="sd">            column (str): The column to classify.</span>
<span class="sd">            cmap (str, optional): The name of a colormap recognized by matplotlib. Defaults to None.</span>
<span class="sd">            colors (list, optional): A list of colors to use for the classification. Defaults to None.</span>
<span class="sd">            labels (list, optional): A list of labels to use for the legend. Defaults to None.</span>
<span class="sd">            scheme (str, optional): Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">                Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">                A mapclassify.MapClassifier object will be used</span>
<span class="sd">                under the hood. Supported are all schemes provided by mapclassify (e.g.</span>
<span class="sd">                &#39;BoxPlot&#39;, &#39;EqualInterval&#39;, &#39;FisherJenks&#39;, &#39;FisherJenksSampled&#39;,</span>
<span class="sd">                &#39;HeadTailBreaks&#39;, &#39;JenksCaspall&#39;, &#39;JenksCaspallForced&#39;,</span>
<span class="sd">                &#39;JenksCaspallSampled&#39;, &#39;MaxP&#39;, &#39;MaximumBreaks&#39;,</span>
<span class="sd">                &#39;NaturalBreaks&#39;, &#39;Quantiles&#39;, &#39;Percentiles&#39;, &#39;StdMean&#39;,</span>
<span class="sd">                &#39;UserDefined&#39;). Arguments can be passed in classification_kwds.</span>
<span class="sd">            k (int, optional): Number of classes (ignored if scheme is None or if column is categorical). Default to 5.</span>
<span class="sd">            add_legend (bool, optional): Whether to add a legend to the map. Defaults to True.</span>
<span class="sd">            legend_title (str, optional): The title of the legend. Defaults to None.</span>
<span class="sd">            legend_position (str, optional): The position of the legend. Can be &#39;topleft&#39;, &#39;topright&#39;, &#39;bottomleft&#39;, or &#39;bottomright&#39;. Defaults to &#39;bottomright&#39;.</span>
<span class="sd">            legend_kwds (dict, optional): Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or `matplotlib.pyplot.colorbar`. Defaults to None.</span>
<span class="sd">                Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or</span>
<span class="sd">                Additional accepted keywords when `scheme` is specified:</span>
<span class="sd">                fmt : string</span>
<span class="sd">                    A formatting specification for the bin edges of the classes in the</span>
<span class="sd">                    legend. For example, to have no decimals: ``{&quot;fmt&quot;: &quot;{:.0f}&quot;}``.</span>
<span class="sd">                labels : list-like</span>
<span class="sd">                    A list of legend labels to override the auto-generated labblels.</span>
<span class="sd">                    Needs to have the same number of elements as the number of</span>
<span class="sd">                    classes (`k`).</span>
<span class="sd">                interval : boolean (default False)</span>
<span class="sd">                    An option to control brackets from mapclassify legend.</span>
<span class="sd">                    If True, open/closed interval brackets are shown in the legend.</span>
<span class="sd">            classification_kwds (dict, optional): Keyword arguments to pass to mapclassify. Defaults to None.</span>
<span class="sd">            layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">            style (dict, optional): A dictionary specifying the style to be used. Defaults to None.</span>
<span class="sd">                style is a dictionary of the following form:</span>
<span class="sd">                    style = {</span>
<span class="sd">                    &quot;stroke&quot;: False,</span>
<span class="sd">                    &quot;color&quot;: &quot;#ff0000&quot;,</span>
<span class="sd">                    &quot;weight&quot;: 1,</span>
<span class="sd">                    &quot;opacity&quot;: 1,</span>
<span class="sd">                    &quot;fill&quot;: True,</span>
<span class="sd">                    &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
<span class="sd">                    &quot;fillOpacity&quot;: 1.0,</span>
<span class="sd">                    &quot;dashArray&quot;: &quot;9&quot;</span>
<span class="sd">                    &quot;clickable&quot;: True,</span>
<span class="sd">                }</span>
<span class="sd">            hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">                hover_style is a dictionary of the following form:</span>
<span class="sd">                    hover_style = {&quot;weight&quot;: style[&quot;weight&quot;] + 1, &quot;fillOpacity&quot;: 0.5}</span>
<span class="sd">            style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">                style_callback is a function that takes the feature as argument and should return a dictionary of the following form:</span>
<span class="sd">                style_callback = lambda feat: {&quot;fillColor&quot;: feat[&quot;properties&quot;][&quot;color&quot;]}</span>
<span class="sd">            info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">            encoding (str, optional): The encoding of the GeoJSON file. Defaults to &quot;utf-8&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gdf</span><span class="p">,</span> <span class="n">legend_dict</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
            <span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_kwds</span><span class="p">,</span>
            <span class="n">classification_kwds</span><span class="o">=</span><span class="n">classification_kwds</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend_title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">legend_title</span> <span class="o">=</span> <span class="n">column</span>

        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
                <span class="c1"># &quot;stroke&quot;: False,</span>
                <span class="c1"># &quot;color&quot;: &quot;#ff0000&quot;,</span>
                <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="c1"># &quot;fill&quot;: True,</span>
                <span class="c1"># &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
                <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="c1"># &quot;dashArray&quot;: &quot;9&quot;</span>
                <span class="c1"># &quot;clickable&quot;: True,</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">style</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>

        <span class="k">if</span> <span class="n">hover_style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hover_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style_callback</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">feat</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="n">feat</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_gdf</span><span class="p">(</span>
            <span class="n">gdf</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">add_legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
                <span class="n">title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">legend_dict</span><span class="o">=</span><span class="n">legend_dict</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">legend_position</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">user_roi_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</span>

<span class="sd">        Args:</span>
<span class="sd">            decimals (int, optional): The number of decimals to round the coordinates to. Defaults to 4.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">geometry_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a widget (e.g., text, HTML, figure) to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            content (str | ipywidgets.Widget | object): The widget to add.</span>
<span class="sd">            position (str, optional): The position of the widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">            **kwargs: Other keyword arguments for ipywidgets.HTML().</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">allowed_positions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;topleft&quot;</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span> <span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span> <span class="s2">&quot;bottomright&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_positions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;position must be one of </span><span class="si">{</span><span class="n">allowed_positions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
                    <span class="n">display</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
                <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error adding widget: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an image to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            image (str | ipywidgets.Image): The image to add.</span>
<span class="sd">            position (str, optional): The position of the image, can be one of &quot;topleft&quot;,</span>
<span class="sd">                &quot;topright&quot;, &quot;bottomleft&quot;, &quot;bottomright&quot;. Defaults to &quot;bottomright&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">image</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid image&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_widget</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add HTML to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            html (str): The HTML to add.</span>
<span class="sd">            position (str, optional): The position of the HTML, can be one of &quot;topleft&quot;,</span>
<span class="sd">                &quot;topright&quot;, &quot;bottomleft&quot;, &quot;bottomright&quot;. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_widget</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">fontcolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="n">border_radius</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add text to the map.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): The text to add.</span>
<span class="sd">            fontsize (int, optional): The font size. Defaults to 20.</span>
<span class="sd">            fontcolor (str, optional): The font color. Defaults to &quot;black&quot;.</span>
<span class="sd">            bold (bool, optional): Whether to use bold font. Defaults to False.</span>
<span class="sd">            padding (str, optional): The padding. Defaults to &quot;5px&quot;.</span>
<span class="sd">            background (bool, optional): Whether to use background. Defaults to True.</span>
<span class="sd">            bg_color (str, optional): The background color. Defaults to &quot;white&quot;.</span>
<span class="sd">            border_radius (str, optional): The border radius. Defaults to &quot;5px&quot;.</span>
<span class="sd">            position (str, optional): The position of the widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">background</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">fontsize</span><span class="si">}</span><span class="s2">px; color: </span><span class="si">{</span><span class="n">fontcolor</span><span class="si">}</span><span class="s2">; font-weight: </span><span class="si">{</span><span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">bold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">            padding: </span><span class="si">{</span><span class="n">padding</span><span class="si">}</span><span class="s2">; background-color: </span><span class="si">{</span><span class="n">bg_color</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">            border-radius: </span><span class="si">{</span><span class="n">border_radius</span><span class="si">}</span><span class="s2">;&quot;&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">fontsize</span><span class="si">}</span><span class="s2">px; color: </span><span class="si">{</span><span class="n">fontcolor</span><span class="si">}</span><span class="s2">; font-weight: </span><span class="si">{</span><span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">bold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">            padding: </span><span class="si">{</span><span class="n">padding</span><span class="si">}</span><span class="s2">;&quot;&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_html</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_basemap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_basemap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="s1">&#39;HYBRID&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_basemap" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a basemap to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>basemap</code></td>
        <td><code>str</code></td>
        <td><p>Can be one of string from basemaps. Defaults to 'HYBRID'.</p></td>
        <td><code>&#39;HYBRID&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_basemap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a basemap to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        basemap (str, optional): Can be one of string from basemaps. Defaults to &#39;HYBRID&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xyzservices</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">layer_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layer_names</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">basemap</span><span class="p">,</span> <span class="n">xyzservices</span><span class="o">.</span><span class="n">TileProvider</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">name</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
            <span class="n">attribution</span> <span class="o">=</span> <span class="n">basemap</span><span class="o">.</span><span class="n">attribution</span>
            <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">basemap</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">max_zoom</span> <span class="o">=</span> <span class="n">basemap</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_zoom</span> <span class="o">=</span> <span class="mi">22</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="n">max_zoom</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">basemap</span> <span class="ow">in</span> <span class="n">basemaps</span> <span class="ow">and</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layer_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">basemap</span> <span class="ow">in</span> <span class="n">basemaps</span> <span class="ow">and</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">layer_names</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basemap</span><span class="si">}</span><span class="s2"> has been already added before.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Basemap can only be one of the following:</span><span class="se">\n</span><span class="s2">  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Basemap can only be one of the following:</span><span class="se">\n</span><span class="s2">  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_census_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_census_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wms</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">census_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_census_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a census data layer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>wms</code></td>
        <td><code>str</code></td>
        <td><p>The wms to use. For example, "Current", "ACS 2021", "Census 2020".  See the complete list at https://tigerweb.geo.census.gov/tigerwebmain/TIGERweb_wms.html</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to add to the map.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>census_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary containing census data. Defaults to None. It can be obtained from the get_census_dict() function.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_census_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wms</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">census_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a census data layer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        wms (str): The wms to use. For example, &quot;Current&quot;, &quot;ACS 2021&quot;, &quot;Census 2020&quot;.  See the complete list at https://tigerweb.geo.census.gov/tigerwebmain/TIGERweb_wms.html</span>
<span class="sd">        layer (str): The layer name to add to the map.</span>
<span class="sd">        census_dict (dict, optional): A dictionary containing census data. Defaults to None. It can be obtained from the get_census_dict() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">census_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">census_dict</span> <span class="o">=</span> <span class="n">get_census_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">wms</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">census_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The provided WMS is invalid. It must be one of </span><span class="si">{</span><span class="n">census_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="n">census_dict</span><span class="p">[</span><span class="n">wms</span><span class="p">][</span><span class="s2">&quot;layers&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">layer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The layer name is not valid. It must be one of </span><span class="si">{</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="n">census_dict</span><span class="p">[</span><span class="n">wms</span><span class="p">][</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer</span>
        <span class="k">if</span> <span class="s2">&quot;attribution&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;attribution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U.S. Census Bureau&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;image/png&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;transparent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transparent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_circle_markers_from_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_circle_markers_from_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_circle_markers_from_xy" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a marker cluster to the map. For a list of options, see https://ipyleaflet.readthedocs.io/en/latest/api_reference/circle_marker.html</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | pd.DataFrame</code></td>
        <td><p>A csv or Pandas DataFrame containing x, y, z values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the x values. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the y values. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>radius</code></td>
        <td><code>int</code></td>
        <td><p>The radius of the circle. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>popup</code></td>
        <td><code>list</code></td>
        <td><p>A list of column names to be used as the popup. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_circle_markers_from_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a marker cluster to the map. For a list of options, see https://ipyleaflet.readthedocs.io/en/latest/api_reference/circle_marker.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | pd.DataFrame): A csv or Pandas DataFrame containing x, y, z values.</span>
<span class="sd">        x (str, optional): The column name for the x values. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        y (str, optional): The column name for the y values. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        radius (int, optional): The radius of the circle. Defaults to 10.</span>
<span class="sd">        popup (list, optional): A list of column names to be used as the popup. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">popup</span> <span class="o">=</span> <span class="n">col_names</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">popup</span> <span class="o">=</span> <span class="p">[</span><span class="n">popup</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="n">html</span> <span class="o">+</span> <span class="s2">&quot;&lt;b&gt;&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">p</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
        <span class="n">popup_html</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">CircleMarker</span><span class="p">(</span>
            <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">x</span><span class="p">]],</span>
            <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
            <span class="n">popup</span><span class="o">=</span><span class="n">popup_html</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_cog_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_cog_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="s1">&#39;https://titiler.xyz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_cog_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a COG TileLayer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the COG tile layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use for the layer. Defaults to 'Untitled'.</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution to use. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>A flag indicating whether the layer should be on by default. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of bands to use for the layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint. Defaults to "https://titiler.xyz".</p></td>
        <td><code>&#39;https://titiler.xyz&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Arbitrary keyword arguments, including bidx, expression, nodata, unscale, resampling, rescale,
color_formula, colormap, colormap_name, return_mask. See https://developmentseed.org/titiler/endpoints/cog/
and https://cogeotiff.github.io/rio-tiler/colormap/. To select a certain bands, use bidx=[1, 2, 3].
apply a rescaling to multiple bands, use something like <code>rescale=["164,223","130,211","99,212"]</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_cog_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">titiler_endpoint</span><span class="o">=</span><span class="s2">&quot;https://titiler.xyz&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a COG TileLayer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the COG tile layer.</span>
<span class="sd">        name (str, optional): The layer name to use for the layer. Defaults to &#39;Untitled&#39;.</span>
<span class="sd">        attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">        shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">        bands (list, optional): A list of bands to use for the layer. Defaults to None.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint. Defaults to &quot;https://titiler.xyz&quot;.</span>
<span class="sd">        **kwargs: Arbitrary keyword arguments, including bidx, expression, nodata, unscale, resampling, rescale,</span>
<span class="sd">            color_formula, colormap, colormap_name, return_mask. See https://developmentseed.org/titiler/endpoints/cog/</span>
<span class="sd">            and https://cogeotiff.github.io/rio-tiler/colormap/. To select a certain bands, use bidx=[1, 2, 3].</span>
<span class="sd">            apply a rescaling to multiple bands, use something like `rescale=[&quot;164,223&quot;,&quot;130,211&quot;,&quot;99,212&quot;]`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tile_url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
        <span class="s2">&quot;titizer_endpoint&quot;</span><span class="p">:</span> <span class="n">titiler_endpoint</span><span class="p">,</span>
        <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;COG&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_colorbar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;45px&#39;</span><span class="p">,</span> <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_colorbar" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a branca colorbar to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>The set of colors to be used for interpolation. Colors can be provided in the form: * tuples of RGBA ints between 0 and 255 (e.g: (255, 255, 0) or (255, 255, 0, 255)) * tuples of RGBA floats between 0. and 1. (e.g: (1.,1.,0.) or (1., 1., 0., 1.)) * HTML-like string (e.g: “#ffff00) * a color name or shortcut (e.g: “y” or “yellow”)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>int</code></td>
        <td><p>The minimal value for the colormap. Values lower than vmin will be bound directly to colors[0].. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximal value for the colormap. Values higher than vmax will be bound directly to colors[-1]. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>index</code></td>
        <td><code>list</code></td>
        <td><p>The values corresponding to each color. It has to be sorted, and have the same length as colors. If None, a regular grid between vmin and vmax is created.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>caption</code></td>
        <td><code>str</code></td>
        <td><p>The caption for the colormap. Defaults to "".</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>categorical</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to create a categorical colormap. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step to split the LinearColormap into a StepColormap. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the colormap widget. Defaults to "45px".</p></td>
        <td><code>&#39;45px&#39;</code></td>
      </tr>
      <tr>
        <td><code>transparent_bg</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use transparent background for the colormap widget. Defaults to True.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position for the colormap widget. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_colorbar</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">colors</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;45px&quot;</span><span class="p">,</span>
    <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a branca colorbar to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        colors (list): The set of colors to be used for interpolation. Colors can be provided in the form: * tuples of RGBA ints between 0 and 255 (e.g: (255, 255, 0) or (255, 255, 0, 255)) * tuples of RGBA floats between 0. and 1. (e.g: (1.,1.,0.) or (1., 1., 0., 1.)) * HTML-like string (e.g: “#ffff00) * a color name or shortcut (e.g: “y” or “yellow”)</span>
<span class="sd">        vmin (int, optional): The minimal value for the colormap. Values lower than vmin will be bound directly to colors[0].. Defaults to 0.</span>
<span class="sd">        vmax (float, optional): The maximal value for the colormap. Values higher than vmax will be bound directly to colors[-1]. Defaults to 1.0.</span>
<span class="sd">        index (list, optional):The values corresponding to each color. It has to be sorted, and have the same length as colors. If None, a regular grid between vmin and vmax is created.. Defaults to None.</span>
<span class="sd">        caption (str, optional): The caption for the colormap. Defaults to &quot;&quot;.</span>
<span class="sd">        categorical (bool, optional): Whether or not to create a categorical colormap. Defaults to False.</span>
<span class="sd">        step (int, optional): The step to split the LinearColormap into a StepColormap. Defaults to None.</span>
<span class="sd">        height (str, optional): The height of the colormap widget. Defaults to &quot;45px&quot;.</span>
<span class="sd">        transparent_bg (bool, optional): Whether to use transparent background for the colormap widget. Defaults to True.</span>
<span class="sd">        position (str, optional): The position for the colormap widget. Defaults to &quot;bottomright&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">box</span> <span class="kn">import</span> <span class="n">Box</span>
    <span class="kn">from</span> <span class="nn">branca.colormap</span> <span class="kn">import</span> <span class="n">LinearColormap</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
    <span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">Box</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided color list is invalid.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>

    <span class="n">colormap</span> <span class="o">=</span> <span class="n">LinearColormap</span><span class="p">(</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="n">caption</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">categorical</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span><span class="o">.</span><span class="n">to_step</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">colormap_ctrl</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
        <span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
        <span class="n">transparent_bg</span><span class="o">=</span><span class="n">transparent_bg</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="n">display</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">colormap_ctrl</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">colormap_ctrl</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_colormap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_colormap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis_off</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_colormap" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a matplotlib colormap to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>Matplotlib colormap. Defaults to "gray". See https://matplotlib.org/3.3.4/tutorials/colors/colormaps.html#sphx-glr-tutorials-colors-colormaps-py for options.</p></td>
        <td><code>&#39;gray&#39;</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of custom colors to create a colormap. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>discrete</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create a discrete colorbar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>label</code></td>
        <td><code>str</code></td>
        <td><p>Label for the colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>float</code></td>
        <td><p>The width of the colormap. Defaults to 8.0.</p></td>
        <td><code>8.0</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>float</code></td>
        <td><p>The height of the colormap. Defaults to 0.4.</p></td>
        <td><code>0.4</code></td>
      </tr>
      <tr>
        <td><code>orientation</code></td>
        <td><code>str</code></td>
        <td><p>The orientation of the colormap. Defaults to "horizontal".</p></td>
        <td><code>&#39;horizontal&#39;</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value range. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value range. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>axis_off</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to turn axis off. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>show_name</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show the colormap name. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size of the text. Defaults to 12.</p></td>
        <td><code>12</code></td>
      </tr>
      <tr>
        <td><code>transparent_bg</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use transparent background for the colormap widget. Defaults to True.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position for the colormap widget. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_colormap</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">axis_off</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">transparent_bg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a matplotlib colormap to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        cmap (str, optional): Matplotlib colormap. Defaults to &quot;gray&quot;. See https://matplotlib.org/3.3.4/tutorials/colors/colormaps.html#sphx-glr-tutorials-colors-colormaps-py for options.</span>
<span class="sd">        colors (list, optional): A list of custom colors to create a colormap. Defaults to None.</span>
<span class="sd">        discrete (bool, optional): Whether to create a discrete colorbar. Defaults to False.</span>
<span class="sd">        label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">        width (float, optional): The width of the colormap. Defaults to 8.0.</span>
<span class="sd">        height (float, optional): The height of the colormap. Defaults to 0.4.</span>
<span class="sd">        orientation (str, optional): The orientation of the colormap. Defaults to &quot;horizontal&quot;.</span>
<span class="sd">        vmin (float, optional): The minimum value range. Defaults to 0.</span>
<span class="sd">        vmax (float, optional): The maximum value range. Defaults to 1.0.</span>
<span class="sd">        axis_off (bool, optional): Whether to turn axis off. Defaults to False.</span>
<span class="sd">        show_name (bool, optional): Whether to show the colormap name. Defaults to False.</span>
<span class="sd">        font_size (int, optional): Font size of the text. Defaults to 12.</span>
<span class="sd">        transparent_bg (bool, optional): Whether to use transparent background for the colormap widget. Defaults to True.</span>
<span class="sd">        position (str, optional): The position for the colormap widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.colormaps</span> <span class="kn">import</span> <span class="n">plot_colormap</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

    <span class="n">colormap_ctrl</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
        <span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
        <span class="n">transparent_bg</span><span class="o">=</span><span class="n">transparent_bg</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="n">plot_colormap</span><span class="p">(</span>
            <span class="n">cmap</span><span class="p">,</span>
            <span class="n">colors</span><span class="p">,</span>
            <span class="n">discrete</span><span class="p">,</span>
            <span class="n">label</span><span class="p">,</span>
            <span class="n">width</span><span class="p">,</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="n">orientation</span><span class="p">,</span>
            <span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="p">,</span>
            <span class="n">axis_off</span><span class="p">,</span>
            <span class="n">show_name</span><span class="p">,</span>
            <span class="n">font_size</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">colormap_ctrl</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">colormap_ctrl</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hover_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add vector data to the map with a variety of classification schemes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | pd.DataFrame | gpd.GeoDataFrame</code></td>
        <td><p>The data to classify. It can be a filepath to a vector dataset, a pandas dataframe, or a geopandas geodataframe.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The column to classify.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The name of a colormap recognized by matplotlib. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to use for the classification. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>A list of labels to use for the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scheme</code></td>
        <td><code>str</code></td>
        <td><p>Name of a choropleth classification scheme (requires mapclassify).
Name of a choropleth classification scheme (requires mapclassify).
A mapclassify.MapClassifier object will be used
under the hood. Supported are all schemes provided by mapclassify (e.g.
'BoxPlot', 'EqualInterval', 'FisherJenks', 'FisherJenksSampled',
'HeadTailBreaks', 'JenksCaspall', 'JenksCaspallForced',
'JenksCaspallSampled', 'MaxP', 'MaximumBreaks',
'NaturalBreaks', 'Quantiles', 'Percentiles', 'StdMean',
'UserDefined'). Arguments can be passed in classification_kwds.</p></td>
        <td><code>&#39;Quantiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>k</code></td>
        <td><code>int</code></td>
        <td><p>Number of classes (ignored if scheme is None or if column is categorical). Default to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>add_legend</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a legend to the map. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>legend_title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>legend_position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the legend. Can be 'topleft', 'topright', 'bottomleft', or 'bottomright'. Defaults to 'bottomright'.</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
      <tr>
        <td><code>legend_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments to pass to :func:<code>matplotlib.pyplot.legend</code> or <code>matplotlib.pyplot.colorbar</code>. Defaults to None.
Keyword arguments to pass to :func:<code>matplotlib.pyplot.legend</code> or
Additional accepted keywords when <code>scheme</code> is specified:
fmt : string
    A formatting specification for the bin edges of the classes in the
    legend. For example, to have no decimals: <code>{"fmt": "{:.0f}"}</code>.
labels : list-like
    A list of legend labels to override the auto-generated labblels.
    Needs to have the same number of elements as the number of
    classes (<code>k</code>).
interval : boolean (default False)
    An option to control brackets from mapclassify legend.
    If True, open/closed interval brackets are shown in the legend.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>classification_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments to pass to mapclassify. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to None.
style is a dictionary of the following form:
    style = {
    "stroke": False,
    "color": "#ff0000",
    "weight": 1,
    "opacity": 1,
    "fill": True,
    "fillColor": "#ffffff",
    "fillOpacity": 1.0,
    "dashArray": "9"
    "clickable": True,
}</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.
hover_style is a dictionary of the following form:
    hover_style = {"weight": style["weight"] + 1, "fillOpacity": 0.5}</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.
style_callback is a function that takes the feature as argument and should return a dictionary of the following form:
style_callback = lambda feat: {"fillColor": feat["properties"][&quot;color&quot;]}</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">column</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;Quantiles&quot;</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add vector data to the map with a variety of classification schemes.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | pd.DataFrame | gpd.GeoDataFrame): The data to classify. It can be a filepath to a vector dataset, a pandas dataframe, or a geopandas geodataframe.</span>
<span class="sd">        column (str): The column to classify.</span>
<span class="sd">        cmap (str, optional): The name of a colormap recognized by matplotlib. Defaults to None.</span>
<span class="sd">        colors (list, optional): A list of colors to use for the classification. Defaults to None.</span>
<span class="sd">        labels (list, optional): A list of labels to use for the legend. Defaults to None.</span>
<span class="sd">        scheme (str, optional): Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">            Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">            A mapclassify.MapClassifier object will be used</span>
<span class="sd">            under the hood. Supported are all schemes provided by mapclassify (e.g.</span>
<span class="sd">            &#39;BoxPlot&#39;, &#39;EqualInterval&#39;, &#39;FisherJenks&#39;, &#39;FisherJenksSampled&#39;,</span>
<span class="sd">            &#39;HeadTailBreaks&#39;, &#39;JenksCaspall&#39;, &#39;JenksCaspallForced&#39;,</span>
<span class="sd">            &#39;JenksCaspallSampled&#39;, &#39;MaxP&#39;, &#39;MaximumBreaks&#39;,</span>
<span class="sd">            &#39;NaturalBreaks&#39;, &#39;Quantiles&#39;, &#39;Percentiles&#39;, &#39;StdMean&#39;,</span>
<span class="sd">            &#39;UserDefined&#39;). Arguments can be passed in classification_kwds.</span>
<span class="sd">        k (int, optional): Number of classes (ignored if scheme is None or if column is categorical). Default to 5.</span>
<span class="sd">        add_legend (bool, optional): Whether to add a legend to the map. Defaults to True.</span>
<span class="sd">        legend_title (str, optional): The title of the legend. Defaults to None.</span>
<span class="sd">        legend_position (str, optional): The position of the legend. Can be &#39;topleft&#39;, &#39;topright&#39;, &#39;bottomleft&#39;, or &#39;bottomright&#39;. Defaults to &#39;bottomright&#39;.</span>
<span class="sd">        legend_kwds (dict, optional): Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or `matplotlib.pyplot.colorbar`. Defaults to None.</span>
<span class="sd">            Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or</span>
<span class="sd">            Additional accepted keywords when `scheme` is specified:</span>
<span class="sd">            fmt : string</span>
<span class="sd">                A formatting specification for the bin edges of the classes in the</span>
<span class="sd">                legend. For example, to have no decimals: ``{&quot;fmt&quot;: &quot;{:.0f}&quot;}``.</span>
<span class="sd">            labels : list-like</span>
<span class="sd">                A list of legend labels to override the auto-generated labblels.</span>
<span class="sd">                Needs to have the same number of elements as the number of</span>
<span class="sd">                classes (`k`).</span>
<span class="sd">            interval : boolean (default False)</span>
<span class="sd">                An option to control brackets from mapclassify legend.</span>
<span class="sd">                If True, open/closed interval brackets are shown in the legend.</span>
<span class="sd">        classification_kwds (dict, optional): Keyword arguments to pass to mapclassify. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to None.</span>
<span class="sd">            style is a dictionary of the following form:</span>
<span class="sd">                style = {</span>
<span class="sd">                &quot;stroke&quot;: False,</span>
<span class="sd">                &quot;color&quot;: &quot;#ff0000&quot;,</span>
<span class="sd">                &quot;weight&quot;: 1,</span>
<span class="sd">                &quot;opacity&quot;: 1,</span>
<span class="sd">                &quot;fill&quot;: True,</span>
<span class="sd">                &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
<span class="sd">                &quot;fillOpacity&quot;: 1.0,</span>
<span class="sd">                &quot;dashArray&quot;: &quot;9&quot;</span>
<span class="sd">                &quot;clickable&quot;: True,</span>
<span class="sd">            }</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">            hover_style is a dictionary of the following form:</span>
<span class="sd">                hover_style = {&quot;weight&quot;: style[&quot;weight&quot;] + 1, &quot;fillOpacity&quot;: 0.5}</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">            style_callback is a function that takes the feature as argument and should return a dictionary of the following form:</span>
<span class="sd">            style_callback = lambda feat: {&quot;fillColor&quot;: feat[&quot;properties&quot;][&quot;color&quot;]}</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON file. Defaults to &quot;utf-8&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">gdf</span><span class="p">,</span> <span class="n">legend_dict</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
        <span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_kwds</span><span class="p">,</span>
        <span class="n">classification_kwds</span><span class="o">=</span><span class="n">classification_kwds</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_title</span> <span class="o">=</span> <span class="n">column</span>

    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># &quot;stroke&quot;: False,</span>
            <span class="c1"># &quot;color&quot;: &quot;#ff0000&quot;,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="c1"># &quot;fill&quot;: True,</span>
            <span class="c1"># &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
            <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="c1"># &quot;dashArray&quot;: &quot;9&quot;</span>
            <span class="c1"># &quot;clickable&quot;: True,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>

    <span class="k">if</span> <span class="n">hover_style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hover_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style_callback</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">feat</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="n">feat</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_gdf</span><span class="p">(</span>
        <span class="n">gdf</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">add_legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">legend_dict</span><span class="o">=</span><span class="n">legend_dict</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">legend_position</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_gdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a GeoDataFrame to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>GeoDataFrame</code></td>
        <td><p>A GeoPandas GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
      <tr>
        <td><code>zoom_to_layer</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to zoom to the layer.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoDataFrame. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_gdf</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">gdf</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a GeoDataFrame to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (GeoDataFrame): A GeoPandas GeoDataFrame.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        zoom_to_layer (bool, optional): Whether to zoom to the layer.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoDataFrame. Defaults to &quot;utf-8&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">gdf_to_geojson</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="p">,</span>
        <span class="n">encoding</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">zoom_to_layer</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">west</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;minx&quot;</span><span class="p">])</span>
        <span class="n">south</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;miny&quot;</span><span class="p">])</span>
        <span class="n">east</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;maxx&quot;</span><span class="p">])</span>
        <span class="n">north</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s2">&quot;maxy&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">],</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">]])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_gdf_from_postgis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_gdf_from_postgis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_gdf_from_postgis" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Reads a PostGIS database and returns data as a GeoDataFrame to be added to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>sql</code></td>
        <td><code>str</code></td>
        <td><p>SQL query to execute in selecting entries from database, or name of the table to read from the database.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>con</code></td>
        <td><code>sqlalchemy.engine.Engine</code></td>
        <td><p>Active connection to the database to query.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
      <tr>
        <td><code>zoom_to_layer</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to zoom to the layer.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_gdf_from_postgis</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sql</span><span class="p">,</span>
    <span class="n">con</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">zoom_to_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reads a PostGIS database and returns data as a GeoDataFrame to be added to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        sql (str): SQL query to execute in selecting entries from database, or name of the table to read from the database.</span>
<span class="sd">        con (sqlalchemy.engine.Engine): Active connection to the database to query.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        zoom_to_layer (bool, optional): Whether to zoom to the layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_gdf</span><span class="p">(</span>
        <span class="n">gdf</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="p">,</span>
        <span class="n">zoom_to_layer</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_geojson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_geojson</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_geojson" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a GeoJSON file to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The file path or http URL to the input GeoJSON or a dictionary containing the geojson.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The provided GeoJSON file could not be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_geojson</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">in_geojson</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a GeoJSON file to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The file path or http URL to the input GeoJSON or a dictionary containing the geojson.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The provided GeoJSON file could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="kn">import</span> <span class="nn">requests</span>

    <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">in_geojson</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">is_jupyterlite</span><span class="p">():</span>
                    <span class="kn">import</span> <span class="nn">pyodide</span>

                    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>

                    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">open_url</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fd</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="s2">&quot;The provided GeoJSON file could not be found.&quot;</span>
                    <span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">in_geojson</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The input geojson must be a type of str or dict.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># &quot;stroke&quot;: True,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="c1"># &quot;fill&quot;: True,</span>
            <span class="c1"># &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
            <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="c1"># &quot;dashArray&quot;: &quot;9&quot;</span>
            <span class="c1"># &quot;clickable&quot;: True,</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="s2">&quot;weight&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hover_style</span><span class="p">:</span>
        <span class="n">hover_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">random_color</span><span class="p">(</span><span class="n">feature</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">fill_colors</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="n">toolbar_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Toolbar&quot;</span><span class="p">,</span>
        <span class="n">icon</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">close_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Close the tool&quot;</span><span class="p">,</span>
        <span class="n">icon</span><span class="o">=</span><span class="s2">&quot;times&quot;</span><span class="p">,</span>
        <span class="c1"># button_style=&quot;primary&quot;,</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">html</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">()</span>
    <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="s2">&quot;0px 10px 0px 10px&quot;</span>
    <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">max_height</span> <span class="o">=</span> <span class="s2">&quot;250px&quot;</span>
    <span class="n">html</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="s2">&quot;250px&quot;</span>

    <span class="n">output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
        <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">]),</span> <span class="n">html</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">info_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
        <span class="n">widget</span><span class="o">=</span><span class="n">output_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">info_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span> <span class="s2">&quot;on_click&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">info_control</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">toolbar_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
            <span class="n">close_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">output_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">]),</span> <span class="n">html</span><span class="p">])</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">toolbar_button</span><span class="p">,</span> <span class="n">close_button</span><span class="p">])]</span>

    <span class="n">toolbar_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">toolbar_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
            <span class="n">toolbar_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">info_control</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_control</span><span class="p">(</span><span class="n">info_control</span><span class="p">)</span>
            <span class="n">output_widget</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">close_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">close_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_html</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;&lt;b&gt;</span><span class="si">{}</span><span class="s2">: &lt;/b&gt;</span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="n">html</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">if</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style_callback</span> <span class="o">=</span> <span class="n">random_color</span>

    <span class="k">if</span> <span class="n">style_callback_only</span><span class="p">:</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">info_mode</span> <span class="o">==</span> <span class="s2">&quot;on_hover&quot;</span><span class="p">:</span>
        <span class="n">geojson</span><span class="o">.</span><span class="n">on_hover</span><span class="p">(</span><span class="n">update_html</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">info_mode</span> <span class="o">==</span> <span class="s2">&quot;on_click&quot;</span><span class="p">:</span>
        <span class="n">geojson</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">update_html</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geojson_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;json_layer_dict&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">,</span>
        <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span>
        <span class="s2">&quot;hover_style&quot;</span><span class="p">:</span> <span class="n">hover_style</span><span class="p">,</span>
        <span class="s2">&quot;style_callback&quot;</span><span class="p">:</span> <span class="n">style_callback</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">json_layer_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_heatmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Heat map&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_heatmap" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a heat map to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/heatmap.html</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | list | pd.DataFrame</code></td>
        <td><p>File path or HTTP URL to the input file or a list of data points in the format of [[x1, y1, z1], [x2, y2, z2]]. For example, https://raw.githubusercontent.com/giswqs/leafmap/master/examples/data/world_cities.csv</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The column name of latitude. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The column name of longitude. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>value</code></td>
        <td><code>str</code></td>
        <td><p>The column name of values. Defaults to "value".</p></td>
        <td><code>&#39;value&#39;</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Layer name to use. Defaults to "Heat map".</p></td>
        <td><code>&#39;Heat map&#39;</code></td>
      </tr>
      <tr>
        <td><code>radius</code></td>
        <td><code>int</code></td>
        <td><p>Radius of each “point” of the heatmap. Defaults to 25.</p></td>
        <td><code>25</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If data is not a list.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_heatmap</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Heat map&quot;</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a heat map to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/heatmap.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | list | pd.DataFrame): File path or HTTP URL to the input file or a list of data points in the format of [[x1, y1, z1], [x2, y2, z2]]. For example, https://raw.githubusercontent.com/giswqs/leafmap/master/examples/data/world_cities.csv</span>
<span class="sd">        latitude (str, optional): The column name of latitude. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        longitude (str, optional): The column name of longitude. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        value (str, optional): The column name of values. Defaults to &quot;value&quot;.</span>
<span class="sd">        name (str, optional): Layer name to use. Defaults to &quot;Heat map&quot;.</span>
<span class="sd">        radius (int, optional): Radius of each “point” of the heatmap. Defaults to 25.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If data is not a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">from</span> <span class="nn">ipyleaflet</span> <span class="kn">import</span> <span class="n">Heatmap</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data must be a list, a DataFrame, or a file path.&quot;</span><span class="p">)</span>

        <span class="n">heatmap</span> <span class="o">=</span> <span class="n">Heatmap</span><span class="p">(</span><span class="n">locations</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_html" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_html" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add HTML to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>html</code></td>
        <td><code>str</code></td>
        <td><p>The HTML to add.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the HTML, can be one of "topleft",
"topright", "bottomleft", "bottomright". Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add HTML to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        html (str): The HTML to add.</span>
<span class="sd">        position (str, optional): The position of the HTML, can be one of &quot;topleft&quot;,</span>
<span class="sd">            &quot;topright&quot;, &quot;bottomleft&quot;, &quot;bottomright&quot;. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_widget</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_image" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add an image to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str | ipywidgets.Image</code></td>
        <td><p>The image to add.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the image, can be one of "topleft",
"topright", "bottomleft", "bottomright". Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add an image to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str | ipywidgets.Image): The image to add.</span>
<span class="sd">        position (str, optional): The position of the image, can be one of &quot;topleft&quot;,</span>
<span class="sd">            &quot;topright&quot;, &quot;bottomleft&quot;, &quot;bottomright&quot;. Defaults to &quot;bottomright&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid image&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_widget</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_kml" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_kml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_kml</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_kml" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a KML file to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_kml</code></td>
        <td><code>str</code></td>
        <td><p>The input file path or HTTP URL to the KML.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The provided KML file could not be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_kml</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">in_kml</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a KML file to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_kml (str): The input file path or HTTP URL to the KML.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The provided KML file could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">in_kml</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_kml</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.kml&quot;</span><span class="p">):</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="n">in_kml</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The downloaded kml file could not be found.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">in_kml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided KML could not be found.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_vector</span><span class="p">(</span>
        <span class="n">in_kml</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="s1">&#39;12pt&#39;</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s1">&#39;arial&#39;</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_labels" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a label layer to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/divicon.html</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>pd.DataFrame | gpd.GeoDataFrame | str</code></td>
        <td><p>The input data to label.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the data to label.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>str</code></td>
        <td><p>The font size of the labels. Defaults to "12pt".</p></td>
        <td><code>&#39;12pt&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>The font color of the labels. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_family</code></td>
        <td><code>str</code></td>
        <td><p>The font family of the labels. Defaults to "arial".</p></td>
        <td><code>&#39;arial&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_weight</code></td>
        <td><code>str</code></td>
        <td><p>The font weight of the labels, can be normal, bold. Defaults to "normal".</p></td>
        <td><code>&#39;normal&#39;</code></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the longitude. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the latitude. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>draggable</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the labels are draggable. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>Layer name to use. Defaults to "Labels".</p></td>
        <td><code>&#39;Labels&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_labels</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">column</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="s2">&quot;12pt&quot;</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span>
    <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">draggable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a label layer to the map. Reference: https://ipyleaflet.readthedocs.io/en/latest/api_reference/divicon.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame | gpd.GeoDataFrame | str): The input data to label.</span>
<span class="sd">        column (str): The column name of the data to label.</span>
<span class="sd">        font_size (str, optional): The font size of the labels. Defaults to &quot;12pt&quot;.</span>
<span class="sd">        font_color (str, optional): The font color of the labels. Defaults to &quot;black&quot;.</span>
<span class="sd">        font_family (str, optional): The font family of the labels. Defaults to &quot;arial&quot;.</span>
<span class="sd">        font_weight (str, optional): The font weight of the labels, can be normal, bold. Defaults to &quot;normal&quot;.</span>
<span class="sd">        x (str, optional): The column name of the longitude. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        y (str, optional): The column name of the latitude. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        draggable (bool, optional): Whether the labels are draggable. Defaults to True.</span>
<span class="sd">        layer_name (str, optional): Layer name to use. Defaults to &quot;Labels&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;geom&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span>
            <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

                <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span>
                <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;geopandas is required to read geojson.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;data must be a pd.DataFrame, gpd.GeoDataFrame, or an ee.FeatureCollection.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">font_size</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;pt&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;font_size must be something like &#39;10pt&#39;&quot;</span><span class="p">)</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">font_size</span><span class="si">}</span><span class="s1">;color:</span><span class="si">{</span><span class="n">font_color</span><span class="si">}</span><span class="s1">;font-family:</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="s1">;font-weight: </span><span class="si">{</span><span class="n">font_weight</span><span class="si">}</span><span class="s1">&quot;&gt;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">][</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/div&gt;&#39;</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
            <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">index</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">index</span><span class="p">]],</span>
            <span class="n">icon</span><span class="o">=</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">DivIcon</span><span class="p">(</span>
                <span class="n">icon_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">icon_anchor</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span>
                <span class="n">html</span><span class="o">=</span><span class="n">html</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">draggable</span><span class="o">=</span><span class="n">draggable</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
    <span class="n">layer_group</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">LayerGroup</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer_group</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">layer_group</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a layer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>layer</code></td>
        <td><code>ipyleaflet layer</code></td>
        <td><p>The layer to be added.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a layer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        layer (ipyleaflet layer): The layer to be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">existing_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_layer</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">existing_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_layer</span><span class="p">(</span><span class="n">existing_layer</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_legend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Legend&#39;</span><span class="p">,</span> <span class="n">legend_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">builtin_legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_legend" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a customized basemap to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Title of the legend. Defaults to 'Legend'.</p></td>
        <td><code>&#39;Legend&#39;</code></td>
      </tr>
      <tr>
        <td><code>legend_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary containing legend items as keys and color as values. If provided, legend_keys and legend_colors will be ignored. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>A list of legend keys. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of legend colors. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>Position of the legend. Defaults to 'bottomright'.</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
      <tr>
        <td><code>builtin_legend</code></td>
        <td><code>str</code></td>
        <td><p>Name of the builtin legend to add to the map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>Layer name of the legend to be associated with. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span>
    <span class="n">legend_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="n">builtin_legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a customized basemap to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        title (str, optional): Title of the legend. Defaults to &#39;Legend&#39;.</span>
<span class="sd">        legend_dict (dict, optional): A dictionary containing legend items as keys and color as values. If provided, legend_keys and legend_colors will be ignored. Defaults to None.</span>
<span class="sd">        labels (list, optional): A list of legend keys. Defaults to None.</span>
<span class="sd">        colors (list, optional): A list of legend colors. Defaults to None.</span>
<span class="sd">        position (str, optional): Position of the legend. Defaults to &#39;bottomright&#39;.</span>
<span class="sd">        builtin_legend (str, optional): Name of the builtin legend to add to the map. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): Layer name of the legend to be associated with. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pkg_resources</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

    <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span>
        <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;leafmap&quot;</span><span class="p">,</span> <span class="s2">&quot;leafmap.py&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">legend_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/template/legend.html&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;min_width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">min_width</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="s2">&quot;max_width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_width&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;min_height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">min_height</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;min_height&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;max_height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_height&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">height</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="s2">&quot;300px&quot;</span>
    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="s2">&quot;400px&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">legend_template</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend template does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys must be a list.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;One&quot;</span><span class="p">,</span> <span class="s2">&quot;Two&quot;</span><span class="p">,</span> <span class="s2">&quot;Three&quot;</span><span class="p">,</span> <span class="s2">&quot;Four&quot;</span><span class="p">,</span> <span class="s2">&quot;etc&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list of tuples.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;#8DD3C7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#FFFFB3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#BEBADA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#FB8072&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#80B1D3&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys and values must be the same length.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">allowed_builtin_legends</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_builtin_legends</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;The builtin legend must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_builtin_legends</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">legend_dict</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="p">[</span><span class="n">builtin_legend</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">legend_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend dict must be a dictionary.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">allowed_positions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;topleft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;topright&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_positions</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The position must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_positions</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">content</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">footer</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">legend_template</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">footer</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span>
        <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;      &lt;li&gt;&lt;span style=&#39;background:</span><span class="si">{}</span><span class="s2">;&#39;&gt;&lt;/span&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">color</span><span class="p">,</span> <span class="n">key</span>
        <span class="p">)</span>
        <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="n">legend_html</span> <span class="o">=</span> <span class="n">header</span> <span class="o">+</span> <span class="n">content</span> <span class="o">+</span> <span class="n">footer</span>
    <span class="n">legend_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">legend_html</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">legend_output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
                <span class="c1"># &quot;border&quot;: &quot;1px solid black&quot;,</span>
                <span class="s2">&quot;max_width&quot;</span><span class="p">:</span> <span class="n">max_width</span><span class="p">,</span>
                <span class="s2">&quot;min_width&quot;</span><span class="p">:</span> <span class="n">min_width</span><span class="p">,</span>
                <span class="s2">&quot;max_height&quot;</span><span class="p">:</span> <span class="n">max_height</span><span class="p">,</span>
                <span class="s2">&quot;min_height&quot;</span><span class="p">:</span> <span class="n">min_height</span><span class="p">,</span>
                <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
                <span class="s2">&quot;overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">legend_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">legend_output_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span>
        <span class="p">)</span>
        <span class="n">legend_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">legend_text</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">legend_output_widget</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">legend_widget</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">legend_widget</span> <span class="o">=</span> <span class="n">legend_output_widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_control</span> <span class="o">=</span> <span class="n">legend_control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">legend_control</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_local_tile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_local_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Local COG&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_local_tile" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a local raster dataset to the map.
    If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer) and
    if the raster does not render properly, try running the following code before calling this function:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>import os
os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>int</code></td>
        <td><p>The band to use. Band indexing starts at 1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>str</code></td>
        <td><p>The name of the color palette from <code>palettable</code> to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to 'Local COG'.</p></td>
        <td><code>&#39;Local COG&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_raster</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Local COG&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a local raster dataset to the map.</span>
<span class="sd">        If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer) and</span>
<span class="sd">        if the raster does not render properly, try running the following code before calling this function:</span>

<span class="sd">        import os</span>
<span class="sd">        os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</span>
<span class="sd">        band (int, optional): The band to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">        palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &#39;Local COG&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tile_layer</span><span class="p">,</span> <span class="n">tile_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span>
        <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">tile_layer</span><span class="p">)</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>  <span class="c1"># [ymin, ymax, xmin, xmax]</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>  <span class="c1"># [minx, miny, maxx, maxy]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">band_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tile_client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tile_layer&quot;</span><span class="p">:</span> <span class="n">tile_layer</span><span class="p">,</span>
        <span class="s2">&quot;tile_client&quot;</span><span class="p">:</span> <span class="n">tile_client</span><span class="p">,</span>
        <span class="s2">&quot;band&quot;</span><span class="p">:</span> <span class="n">band</span><span class="p">,</span>
        <span class="s2">&quot;band_names&quot;</span><span class="p">:</span> <span class="n">band_names</span><span class="p">,</span>
        <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LOCAL&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_marker" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_marker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_marker" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a marker to the map. More info about marker at https://ipyleaflet.readthedocs.io/en/latest/api_reference/marker.html.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>location</code></td>
        <td><code>list | tuple</code></td>
        <td><p>The location of the marker in the format of [lat, lng].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Keyword arguments for the marker.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_marker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a marker to the map. More info about marker at https://ipyleaflet.readthedocs.io/en/latest/api_reference/marker.html.</span>

<span class="sd">    Args:</span>
<span class="sd">        location (list | tuple): The location of the marker in the format of [lat, lng].</span>

<span class="sd">        **kwargs: Keyword arguments for the marker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">location</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The location must be a list or a tuple.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_marker_cluster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_marker_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="n">add_marker</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_marker_cluster" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Captures user inputs and add markers to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>event</code></td>
        <td><code>str</code></td>
        <td><p>[description]. Defaults to 'click'.</p></td>
        <td><code>&#39;click&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_marker</code></td>
        <td><code>bool</code></td>
        <td><p>If True, add markers to the map. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>a marker cluster.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_marker_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">add_marker</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Captures user inputs and add markers to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        event (str, optional): [description]. Defaults to &#39;click&#39;.</span>
<span class="sd">        add_marker (bool, optional): If True, add markers to the map. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: a marker cluster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_click</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_clicks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">add_marker</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_interaction</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">latlon</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span><span class="p">:</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">latlon</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_click</span> <span class="o">=</span> <span class="n">latlon</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_clicks</span> <span class="o">=</span> <span class="n">coordinates</span>
            <span class="k">if</span> <span class="n">add_marker</span><span class="p">:</span>
                <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">latlon</span><span class="p">))</span>
                <span class="n">marker_cluster</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;mousemove&quot;</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="c1"># cursor style: https://www.w3schools.com/cssref/pr_class_cursor.asp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;crosshair&quot;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction</span><span class="p">(</span><span class="n">handle_interaction</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_minimap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_minimap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_minimap" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a minimap (overview) to the ipyleaflet map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>Initial map zoom level. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>Position of the minimap. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_minimap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a minimap (overview) to the ipyleaflet map.</span>

<span class="sd">    Args:</span>
<span class="sd">        zoom (int, optional): Initial map zoom level. Defaults to 5.</span>
<span class="sd">        position (str, optional): Position of the minimap. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">minimap</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
        <span class="n">zoom_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attribution_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span>
        <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">basemaps</span><span class="p">[</span><span class="s2">&quot;ROADMAP&quot;</span><span class="p">]],</span>
    <span class="p">)</span>
    <span class="n">minimap</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s2">&quot;150px&quot;</span>
    <span class="n">minimap</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">&quot;150px&quot;</span>
    <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">link</span><span class="p">((</span><span class="n">minimap</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">))</span>
    <span class="n">minimap_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">minimap</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">minimap_control</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_mosaic_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mosaic_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Mosaic Layer&#39;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_mosaic_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a STAC TileLayer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a MosaicJSON.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use for the layer. Defaults to 'Mosaic Layer'.</p></td>
        <td><code>&#39;Mosaic Layer&#39;</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution to use. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>A flag indicating whether the layer should be on by default. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_mosaic_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mosaic Layer&quot;</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a STAC TileLayer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>
<span class="sd">        name (str, optional): The layer name to use for the layer. Defaults to &#39;Mosaic Layer&#39;.</span>
<span class="sd">        attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">        shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tile_url</span> <span class="o">=</span> <span class="n">mosaic_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="n">mosaic_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_netcdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_netcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;NetCDF layer&#39;</span><span class="p">,</span> <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">lev</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span> <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_netcdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate an ipyleaflet/folium TileLayer from a netCDF file.
    If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer),
    try adding to following two lines to the beginning of the notebook if the raster does not render properly.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>import os
os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = f&#39;{os.environ[&#39;JUPYTERHUB_SERVICE_PREFIX&#39;].lstrip(&#39;/&#39;)}/proxy/{{port}}&#39;
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>File path or HTTP URL to the netCDF file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>variables</code></td>
        <td><code>int</code></td>
        <td><p>The variable/band names to extract data from the netCDF file. Defaults to None. If None, all variables will be extracted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>str</code></td>
        <td><p>The port to use for the server. Defaults to "default".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>str</code></td>
        <td><p>The name of the color palette from <code>palettable</code> to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to "netCDF layer".</p></td>
        <td><code>&#39;NetCDF layer&#39;</code></td>
      </tr>
      <tr>
        <td><code>shift_lon</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>str</code></td>
        <td><p>Name of the latitude variable. Defaults to 'lat'.</p></td>
        <td><code>&#39;lat&#39;</code></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>str</code></td>
        <td><p>Name of the longitude variable. Defaults to 'lon'.</p></td>
        <td><code>&#39;lon&#39;</code></td>
      </tr>
      <tr>
        <td><code>lev</code></td>
        <td><code>str</code></td>
        <td><p>Name of the level variable. Defaults to 'lev'.</p></td>
        <td><code>&#39;lev&#39;</code></td>
      </tr>
      <tr>
        <td><code>level_index</code></td>
        <td><code>int</code></td>
        <td><p>Index of level to use. Defaults to 0'.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>time</code></td>
        <td><code>int</code></td>
        <td><p>Index of time to use. Defaults to 0'.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_netcdf</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;NetCDF layer&quot;</span><span class="p">,</span>
    <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
    <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="n">lev</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span>
    <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate an ipyleaflet/folium TileLayer from a netCDF file.</span>
<span class="sd">        If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer),</span>
<span class="sd">        try adding to following two lines to the beginning of the notebook if the raster does not render properly.</span>

<span class="sd">        import os</span>
<span class="sd">        os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = f&#39;{os.environ[&#39;JUPYTERHUB_SERVICE_PREFIX&#39;].lstrip(&#39;/&#39;)}/proxy/{{port}}&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): File path or HTTP URL to the netCDF file.</span>
<span class="sd">        variables (int, optional): The variable/band names to extract data from the netCDF file. Defaults to None. If None, all variables will be extracted.</span>
<span class="sd">        port (str, optional): The port to use for the server. Defaults to &quot;default&quot;.</span>
<span class="sd">        palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &quot;netCDF layer&quot;.</span>
<span class="sd">        shift_lon (bool, optional): Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</span>
<span class="sd">        lat (str, optional): Name of the latitude variable. Defaults to &#39;lat&#39;.</span>
<span class="sd">        lon (str, optional): Name of the longitude variable. Defaults to &#39;lon&#39;.</span>
<span class="sd">        lev (str, optional): Name of the level variable. Defaults to &#39;lev&#39;.</span>
<span class="sd">        level_index (int, optional): Index of level to use. Defaults to 0&#39;.</span>
<span class="sd">        time (int, optional): Index of time to use. Defaults to 0&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tif</span><span class="p">,</span> <span class="nb">vars</span> <span class="o">=</span> <span class="n">netcdf_to_tif</span><span class="p">(</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="n">shift_lon</span><span class="o">=</span><span class="n">shift_lon</span><span class="p">,</span>
        <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span>
        <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span>
        <span class="n">lev</span><span class="o">=</span><span class="n">lev</span><span class="p">,</span>
        <span class="n">level_index</span><span class="o">=</span><span class="n">level_index</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
        <span class="n">return_vars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">vars</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The variables must be a subset of </span><span class="si">{</span><span class="nb">vars</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="nb">vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span>
        <span class="n">tif</span><span class="p">,</span>
        <span class="n">band</span><span class="o">=</span><span class="n">band_idx</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_address" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_address" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within some distance N, S, E, W of address to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>address</code></td>
        <td><code>str</code></td>
        <td><p>The address to geocode and use as the central point around which to get the geometries.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dist</code></td>
        <td><code>int</code></td>
        <td><p>Distance in meters. Defaults to 1000.</p></td>
        <td><code>1000</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_address</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">address</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within some distance N, S, E, W of address to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        address (str): The address to geocode and use as the central point around which to get the geometries.</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        dist (int, optional): Distance in meters. Defaults to 1000.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_address</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_bbox" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_bbox" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within a N, S, E, W bounding box to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>north</code></td>
        <td><code>float</code></td>
        <td><p>Northern latitude of bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>south</code></td>
        <td><code>float</code></td>
        <td><p>Southern latitude of bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>east</code></td>
        <td><code>float</code></td>
        <td><p>Eastern longitude of bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>west</code></td>
        <td><code>float</code></td>
        <td><p>Western longitude of bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_bbox</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">north</span><span class="p">,</span>
    <span class="n">south</span><span class="p">,</span>
    <span class="n">east</span><span class="p">,</span>
    <span class="n">west</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within a N, S, E, W bounding box to the map.</span>


<span class="sd">    Args:</span>
<span class="sd">        north (float): Northern latitude of bounding box.</span>
<span class="sd">        south (float): Southern latitude of bounding box.</span>
<span class="sd">        east (float): Eastern longitude of bounding box.</span>
<span class="sd">        west (float): Western longitude of bounding box.</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_bbox</span><span class="p">(</span><span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_geocode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_geocode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">by_osmid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_geocode" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM data of place(s) by name or ID to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str | dict | list</code></td>
        <td><p>Query string(s) or structured dict(s) to geocode.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>which_result</code></td>
        <td><code>int</code></td>
        <td><p>Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn't return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>by_osmid</code></td>
        <td><code>bool</code></td>
        <td><p>If True, handle query as an OSM ID for lookup rather than text search. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>buffer_dist</code></td>
        <td><code>float</code></td>
        <td><p>Distance to buffer around the place geometry, in meters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_geocode</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">,</span>
    <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">by_osmid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM data of place(s) by name or ID to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str | dict | list): Query string(s) or structured dict(s) to geocode.</span>
<span class="sd">        which_result (int, optional): Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn&#39;t return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</span>
<span class="sd">        by_osmid (bool, optional): If True, handle query as an OSM ID for lookup rather than text search. Defaults to False.</span>
<span class="sd">        buffer_dist (float, optional): Distance to buffer around the place geometry, in meters. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_geocode</span><span class="p">(</span>
        <span class="n">query</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="n">which_result</span><span class="p">,</span> <span class="n">by_osmid</span><span class="o">=</span><span class="n">by_osmid</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="o">=</span><span class="n">buffer_dist</span>
    <span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_place" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_place" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within boundaries of geocodable place(s) to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str | dict | list</code></td>
        <td><p>Query string(s) or structured dict(s) to geocode.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>which_result</code></td>
        <td><code>int</code></td>
        <td><p>Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn't return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>buffer_dist</code></td>
        <td><code>float</code></td>
        <td><p>Distance to buffer around the place geometry, in meters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_place</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">which_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">buffer_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within boundaries of geocodable place(s) to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str | dict | list): Query string(s) or structured dict(s) to geocode.</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        which_result (int, optional): Which geocoding result to use. if None, auto-select the first (Multi)Polygon or raise an error if OSM doesn&#39;t return one. to get the top match regardless of geometry type, set which_result=1. Defaults to None.</span>
<span class="sd">        buffer_dist (float, optional): Distance to buffer around the place geometry, in meters. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_place</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">which_result</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_point" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center_point</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_point" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within some distance N, S, E, W of a point to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>center_point</code></td>
        <td><code>tuple</code></td>
        <td><p>The (lat, lng) center point around which to get the geometries.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dist</code></td>
        <td><code>int</code></td>
        <td><p>Distance in meters. Defaults to 1000.</p></td>
        <td><code>1000</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_point</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">center_point</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within some distance N, S, E, W of a point to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        center_point (tuple): The (lat, lng) center point around which to get the geometries.</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        dist (int, optional): Distance in meters. Defaults to 1000.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_point</span><span class="p">(</span><span class="n">center_point</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_polygon" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_polygon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_polygon" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within boundaries of a (multi)polygon to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>polygon</code></td>
        <td><code>shapely.geometry.Polygon | shapely.geometry.MultiPolygon</code></td>
        <td><p>Geographic boundaries to fetch geometries within</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_polygon</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">polygon</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within boundaries of a (multi)polygon to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        polygon (shapely.geometry.Polygon | shapely.geometry.MultiPolygon): Geographic boundaries to fetch geometries within</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_osm_from_view" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_osm_from_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_osm_from_view" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds OSM entities within the current map view to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tags</code></td>
        <td><code>dict</code></td>
        <td><p>Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_osm_from_view</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds OSM entities within the current map view to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        tags (dict): Dict of tags used for finding objects in the selected area. Results returned are the union, not intersection of each individual tag. Each result matches at least one given tag. The dict keys should be OSM tags, (e.g., building, landuse, highway, etc) and the dict values should be either True to retrieve all items with the given tag, or a string to get a single tag-value combination, or a list of strings to get multiple values for the given tag. For example, tags = {‘building’: True} would return all building footprints in the area. tags = {‘amenity’:True, ‘landuse’:[‘retail’,’commercial’], ‘highway’:’bus_stop’} would return all amenities, landuse=retail, landuse=commercial, and highway=bus_stop.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">40.74824858675827</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.98933637940563</span><span class="p">),</span>
            <span class="p">(</span><span class="mf">40.75068694343106</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.98364473187601</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">osm_gdf_from_bbox</span><span class="p">(</span><span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="o">=</span><span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="o">=</span><span class="n">info_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_planet_by_month" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_planet_by_month</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_planet_by_month" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a Planet global mosaic by month to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>month</code></td>
        <td><code>int</code></td>
        <td><p>The month of Planet global mosaic, must be 1-12. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_planet_by_month</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a Planet global mosaic by month to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        month (int, optional): The month of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">planet_tile_by_month</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_planet_by_quarter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_planet_by_quarter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_planet_by_quarter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a Planet global mosaic by quarter to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>quarter</code></td>
        <td><code>int</code></td>
        <td><p>The quarter of Planet global mosaic, must be 1-12. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_planet_by_quarter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a Planet global mosaic by quarter to the map. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        quarter (int, optional): The quarter of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">planet_tile_by_quarter</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_point_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_point_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Marker Cluster&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_point_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a point layer to the map with a popup attribute.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>str, http url, path object or file-like object. Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>popup</code></td>
        <td><code>str | list</code></td>
        <td><p>Column name(s) to be used for popup. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>A layer name to use. Defaults to "Marker Cluster".</p></td>
        <td><code>&#39;Marker Cluster&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the specified column name does not exist.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the specified column names do not exist.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_point_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a point layer to the map with a popup attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): str, http url, path object or file-like object. Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO)</span>
<span class="sd">        popup (str | list, optional): Column name(s) to be used for popup. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): A layer name to use. Defaults to &quot;Marker Cluster&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified column name does not exist.</span>
<span class="sd">        ValueError: If the specified column names do not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">warnings</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">fiona</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;wait&quot;</span><span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">filename</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.kml&quot;</span><span class="p">:</span>
            <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">)</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;popup must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">col_names</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;All popup items must be select from: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span>

    <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">popup</span><span class="p">]</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                    <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;popup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                    <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span>
        <span class="p">]</span>

    <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_points_from_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_points_from_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Marker Cluster&#39;</span><span class="p">,</span> <span class="n">color_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icon_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">icon_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">],</span> <span class="n">spin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_points_from_xy" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a marker cluster to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | pd.DataFrame</code></td>
        <td><p>A csv or Pandas DataFrame containing x, y, z values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the x values. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the y values. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>popup</code></td>
        <td><code>list</code></td>
        <td><p>A list of column names to be used as the popup. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the layer. Defaults to "Marker Cluster".</p></td>
        <td><code>&#39;Marker Cluster&#39;</code></td>
      </tr>
      <tr>
        <td><code>color_column</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the color values. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>marker_colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to be used for the markers. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>icon_colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to be used for the icons. Defaults to ['white'].</p></td>
        <td><code>[&#39;white&#39;]</code></td>
      </tr>
      <tr>
        <td><code>icon_names</code></td>
        <td><code>list</code></td>
        <td><p>A list of names to be used for the icons. More icons can be found at https://fontawesome.com/v4/icons. Defaults to ['info'].</p></td>
        <td><code>[&#39;info&#39;]</code></td>
      </tr>
      <tr>
        <td><code>spin</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the icon will spin. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>add_legend</code></td>
        <td><code>bool</code></td>
        <td><p>If True, a legend will be added to the map. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_points_from_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">popup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker Cluster&quot;</span><span class="p">,</span>
    <span class="n">color_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">icon_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">],</span>
    <span class="n">icon_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">],</span>
    <span class="n">spin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a marker cluster to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | pd.DataFrame): A csv or Pandas DataFrame containing x, y, z values.</span>
<span class="sd">        x (str, optional): The column name for the x values. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        y (str, optional): The column name for the y values. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        popup (list, optional): A list of column names to be used as the popup. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The name of the layer. Defaults to &quot;Marker Cluster&quot;.</span>
<span class="sd">        color_column (str, optional): The column name for the color values. Defaults to None.</span>
<span class="sd">        marker_colors (list, optional): A list of colors to be used for the markers. Defaults to None.</span>
<span class="sd">        icon_colors (list, optional): A list of colors to be used for the icons. Defaults to [&#39;white&#39;].</span>
<span class="sd">        icon_names (list, optional): A list of names to be used for the icons. More icons can be found at https://fontawesome.com/v4/icons. Defaults to [&#39;info&#39;].</span>
<span class="sd">        spin (bool, optional): If True, the icon will spin. Defaults to False.</span>
<span class="sd">        add_legend (bool, optional): If True, a legend will be added to the map. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="n">color_options</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="s2">&quot;purple&quot;</span><span class="p">,</span>
        <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
        <span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;beige&quot;</span><span class="p">,</span>
        <span class="s2">&quot;darkblue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cadetblue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;darkpurple&quot;</span><span class="p">,</span>
        <span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pink&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gray&quot;</span><span class="p">,</span>
        <span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">points_from_xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> does not exist in the dataframe.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">]))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">marker_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_options</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is greater than the number of available colors.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">marker_colors</span> <span class="o">=</span> <span class="n">color_options</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">color_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">marker_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker_colors</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">icon_colors</span> <span class="o">=</span> <span class="n">icon_colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_colors</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">icon_names</span> <span class="o">=</span> <span class="n">icon_names</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">icon_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The number of unique values in the color column </span><span class="si">{</span><span class="n">color_column</span><span class="si">}</span><span class="s2"> is not equal to the number of available colors.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="n">col_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;popup must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">col_names</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;All popup items must be select from: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">popup</span> <span class="o">=</span> <span class="n">col_names</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span>

    <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">popup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">popup</span><span class="p">]</span>

            <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span>
                        <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
                    <span class="p">]</span>
                    <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                        <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                        <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                        <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                    <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
                    <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">popup</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">label</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;b&gt;&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;: &quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                    <span class="p">)</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;popup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

            <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span>
                        <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
                    <span class="p">]</span>
                    <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                        <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                        <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                        <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                    <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                    <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
                    <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">marker_color</span> <span class="o">=</span> <span class="n">marker_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                <span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_names</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                <span class="n">icon_color</span> <span class="o">=</span> <span class="n">icon_colors</span><span class="p">[</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">color_column</span><span class="p">][</span><span class="n">index</span><span class="p">])]</span>
                <span class="n">marker_icon</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">icon_name</span><span class="p">,</span>
                    <span class="n">marker_color</span><span class="o">=</span><span class="n">marker_color</span><span class="p">,</span>
                    <span class="n">icon_color</span><span class="o">=</span><span class="n">icon_color</span><span class="p">,</span>
                    <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">marker_icon</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="n">marker_icon</span>
            <span class="p">)</span>
            <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

    <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">add_legend</span><span class="p">:</span>
        <span class="n">marker_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">marker_colors</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">color_column</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="n">colors</span><span class="o">=</span><span class="n">marker_colors</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">items</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_raster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_raster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Local COG&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_raster" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a local raster dataset to the map.
    If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer) and
    if the raster does not render properly, try running the following code before calling this function:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>import os
os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>int</code></td>
        <td><p>The band to use. Band indexing starts at 1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>str</code></td>
        <td><p>The name of the color palette from <code>palettable</code> to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to 'Local COG'.</p></td>
        <td><code>&#39;Local COG&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_raster</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Local COG&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a local raster dataset to the map.</span>
<span class="sd">        If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer) and</span>
<span class="sd">        if the raster does not render properly, try running the following code before calling this function:</span>

<span class="sd">        import os</span>
<span class="sd">        os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</span>
<span class="sd">        band (int, optional): The band to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">        palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &#39;Local COG&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tile_layer</span><span class="p">,</span> <span class="n">tile_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span>
        <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">tile_layer</span><span class="p">)</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>  <span class="c1"># [ymin, ymax, xmin, xmax]</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>  <span class="c1"># [minx, miny, maxx, maxy]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">band_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tile_client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tile_layer&quot;</span><span class="p">:</span> <span class="n">tile_layer</span><span class="p">,</span>
        <span class="s2">&quot;tile_client&quot;</span><span class="p">:</span> <span class="n">tile_client</span><span class="p">,</span>
        <span class="s2">&quot;band&quot;</span><span class="p">:</span> <span class="n">band</span><span class="p">,</span>
        <span class="s2">&quot;band_names&quot;</span><span class="p">:</span> <span class="n">band_names</span><span class="p">,</span>
        <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LOCAL&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_raster_legacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_raster_legacy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_raster_legacy" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a local raster dataset to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The image file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>int or list</code></td>
        <td><p>The image bands to use. It can be either a number (e.g., 1) or a list (e.g., [3, 2, 1]). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use for the raster. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colormap</code></td>
        <td><code>str</code></td>
        <td><p>The name of the colormap to use for the raster, such as 'gray' and 'terrain'. More can be found at https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>x_dim</code></td>
        <td><code>str</code></td>
        <td><p>The x dimension. Defaults to 'x'.</p></td>
        <td><code>&#39;x&#39;</code></td>
      </tr>
      <tr>
        <td><code>y_dim</code></td>
        <td><code>str</code></td>
        <td><p>The y dimension. Defaults to 'y'.</p></td>
        <td><code>&#39;y&#39;</code></td>
      </tr>
      <tr>
        <td><code>fit_bounds</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to fit map bounds to raster bounds.  Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_raster_legacy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_dim</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_dim</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a local raster dataset to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The image file path.</span>
<span class="sd">        bands (int or list, optional): The image bands to use. It can be either a number (e.g., 1) or a list (e.g., [3, 2, 1]). Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use for the raster. Defaults to None.</span>
<span class="sd">        colormap (str, optional): The name of the colormap to use for the raster, such as &#39;gray&#39; and &#39;terrain&#39;. More can be found at https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html. Defaults to None.</span>
<span class="sd">        x_dim (str, optional): The x dimension. Defaults to &#39;x&#39;.</span>
<span class="sd">        y_dim (str, optional): The y dimension. Defaults to &#39;y&#39;.</span>
<span class="sd">        fit_bounds (bool, optional): Whether to fit map bounds to raster bounds.  Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">xarray_leaflet</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># import platform</span>
        <span class="c1"># if platform.system() != &quot;Windows&quot;:</span>
        <span class="c1">#     # install_from_github(</span>
        <span class="c1">#     #     url=&#39;https://github.com/davidbrochart/xarray_leaflet&#39;)</span>
        <span class="c1">#     check_install(&#39;xarray_leaflet&#39;)</span>
        <span class="c1">#     import xarray_leaflet</span>
        <span class="c1"># else:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;You need to install xarray_leaflet first. See https://github.com/davidbrochart/xarray_leaflet&quot;</span>
        <span class="p">)</span>

    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">rioxarray</span>

    <span class="c1"># import xarray as xr</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The image file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>

    <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">layer_name</span> <span class="o">=</span> <span class="s2">&quot;Layer_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># print(da.rio.nodata)</span>

    <span class="n">multi_band</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">band</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">multi_band</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">multi_band</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">bands</span><span class="p">)</span>

    <span class="c1"># crs = da.rio.crs</span>
    <span class="c1"># nan = da.attrs[&#39;nodatavals&#39;][0]</span>
    <span class="c1"># da = da / da.max()</span>
    <span class="c1"># # if multi_band:</span>
    <span class="c1"># da = xr.where(da == nan, np.nan, da)</span>
    <span class="c1"># da = da.rio.write_nodata(0)</span>
    <span class="c1"># da = da.rio.write_crs(crs)</span>

    <span class="k">if</span> <span class="n">multi_band</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">leaflet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">rgb_dim</span><span class="o">=</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="n">fit_bounds</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">leaflet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="n">fit_bounds</span>
        <span class="p">)</span>

    <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">layer_name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_remote_tile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_remote_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_remote_tile" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a remote Cloud Optimized GeoTIFF (COG) to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the remote Cloud Optimized GeoTIFF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>int</code></td>
        <td><p>The band to use. Band indexing starts at 1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>str</code></td>
        <td><p>The name of the color palette from <code>palettable</code> to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_remote_tile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a remote Cloud Optimized GeoTIFF (COG) to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the remote Cloud Optimized GeoTIFF.</span>
<span class="sd">        band (int, optional): The band to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">        palette (str, optional): The name of the color palette from `palettable` to use when plotting a single band. See https://jiffyclub.github.io/palettable. Default is greyscale</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The source must be a URL.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_search_control" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_search_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;topleft&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_search_control" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a search control to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The url to the search API. For example, "https://nominatim.openstreetmap.org/search?format=json&amp;q={s}".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>marker</code></td>
        <td><code>ipyleaflet.Marker</code></td>
        <td><p>The marker to be used for the search result. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The zoom level to be used for the search result. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the search control. Defaults to "topleft".</p></td>
        <td><code>&#39;topleft&#39;</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Additional keyword arguments to be passed to the search control. See https://ipyleaflet.readthedocs.io/en/latest/api_reference/search_control.html</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_search_control</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topleft&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a search control to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The url to the search API. For example, &quot;https://nominatim.openstreetmap.org/search?format=json&amp;q={s}&quot;.</span>
<span class="sd">        marker (ipyleaflet.Marker, optional): The marker to be used for the search result. Defaults to None.</span>
<span class="sd">        zoom (int, optional): The zoom level to be used for the search result. Defaults to None.</span>
<span class="sd">        position (str, optional): The position of the search control. Defaults to &quot;topleft&quot;.</span>
<span class="sd">        kwargs (dict, optional): Additional keyword arguments to be passed to the search control. See https://ipyleaflet.readthedocs.io/en/latest/api_reference/search_control.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
            <span class="n">icon</span><span class="o">=</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">AwesomeIcon</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;check&quot;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">icon_color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="n">search_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SearchControl</span><span class="p">(</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">search_control</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search_control</span> <span class="o">=</span> <span class="n">search_control</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_shp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_shp</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_shp" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a shapefile to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_shp</code></td>
        <td><code>str</code></td>
        <td><p>The input file path or HTTP URL (*.zip) to the shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The provided shapefile could not be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_shp</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">in_shp</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a shapefile to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_shp (str): The input file path or HTTP URL (*.zip) to the shapefile.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The provided shapefile could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="k">if</span> <span class="n">in_shp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_shp</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;./cache/shp&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
        <span class="c1"># download_from_url(in_shp, out_dir=out_dir, verbose=False)</span>
        <span class="n">download_file</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;*.shp&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">in_shp</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                <span class="s2">&quot;The downloaded zip file does not contain any shapefile in the root directory.&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">in_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_shp</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided shapefile could not be found.&quot;</span><span class="p">)</span>

    <span class="n">geojson</span> <span class="o">=</span> <span class="n">shp_to_geojson</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
        <span class="n">geojson</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="p">,</span>
        <span class="n">style</span><span class="p">,</span>
        <span class="n">hover_style</span><span class="p">,</span>
        <span class="n">style_callback</span><span class="p">,</span>
        <span class="n">fill_colors</span><span class="p">,</span>
        <span class="n">info_mode</span><span class="p">,</span>
        <span class="n">encoding</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_stac_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_stac_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">assets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;STAC Layer&#39;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_stac_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a STAC TileLayer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>collection</code></td>
        <td><code>str</code></td>
        <td><p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>item</code></td>
        <td><code>str</code></td>
        <td><p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>assets</code></td>
        <td><code>str | list</code></td>
        <td><p>The Microsoft Planetary Computer STAC asset ID, e.g., ["SR_B7", "SR_B5", "SR_B4"].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of band names, e.g., ["SR_B7", "SR_B5", "SR_B4"]</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz", "https://planetarycomputer.microsoft.com/api/data/v1", "planetary-computer", "pc". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use for the layer. Defaults to 'STAC Layer'.</p></td>
        <td><code>&#39;STAC Layer&#39;</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution to use. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>A flag indicating whether the layer should be on by default. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_stac_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">collection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">item</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">assets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STAC Layer&quot;</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a STAC TileLayer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</span>
<span class="sd">        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</span>
<span class="sd">        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</span>
<span class="sd">        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [&quot;SR_B7&quot;, &quot;SR_B5&quot;, &quot;SR_B4&quot;].</span>
<span class="sd">        bands (list): A list of band names, e.g., [&quot;SR_B7&quot;, &quot;SR_B5&quot;, &quot;SR_B4&quot;]</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;, &quot;https://planetarycomputer.microsoft.com/api/data/v1&quot;, &quot;planetary-computer&quot;, &quot;pc&quot;. Defaults to None.</span>
<span class="sd">        name (str, optional): The layer name to use for the layer. Defaults to &#39;STAC Layer&#39;.</span>
<span class="sd">        attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">        shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tile_url</span> <span class="o">=</span> <span class="n">stac_tile</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">stac_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">tile_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">shown</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cog_layer_dict&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">assets</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">assets</span> <span class="o">=</span> <span class="n">bands</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
        <span class="s2">&quot;collection&quot;</span><span class="p">:</span> <span class="n">collection</span><span class="p">,</span>
        <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
        <span class="s2">&quot;assets&quot;</span><span class="p">:</span> <span class="n">assets</span><span class="p">,</span>
        <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="s2">&quot;titiler_endpoint&quot;</span><span class="p">:</span> <span class="n">titiler_endpoint</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;STAC&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cog_layer_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">border_radius</span><span class="o">=</span><span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_text" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add text to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>text</code></td>
        <td><code>str</code></td>
        <td><p>The text to add.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fontsize</code></td>
        <td><code>int</code></td>
        <td><p>The font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>fontcolor</code></td>
        <td><code>str</code></td>
        <td><p>The font color. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>bold</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use bold font. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>padding</code></td>
        <td><code>str</code></td>
        <td><p>The padding. Defaults to "5px".</p></td>
        <td><code>&#39;5px&#39;</code></td>
      </tr>
      <tr>
        <td><code>background</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use background. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>bg_color</code></td>
        <td><code>str</code></td>
        <td><p>The background color. Defaults to "white".</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>border_radius</code></td>
        <td><code>str</code></td>
        <td><p>The border radius. Defaults to "5px".</p></td>
        <td><code>&#39;5px&#39;</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the widget. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">fontcolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">border_radius</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add text to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        text (str): The text to add.</span>
<span class="sd">        fontsize (int, optional): The font size. Defaults to 20.</span>
<span class="sd">        fontcolor (str, optional): The font color. Defaults to &quot;black&quot;.</span>
<span class="sd">        bold (bool, optional): Whether to use bold font. Defaults to False.</span>
<span class="sd">        padding (str, optional): The padding. Defaults to &quot;5px&quot;.</span>
<span class="sd">        background (bool, optional): Whether to use background. Defaults to True.</span>
<span class="sd">        bg_color (str, optional): The background color. Defaults to &quot;white&quot;.</span>
<span class="sd">        border_radius (str, optional): The border radius. Defaults to &quot;5px&quot;.</span>
<span class="sd">        position (str, optional): The position of the widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">background</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">fontsize</span><span class="si">}</span><span class="s2">px; color: </span><span class="si">{</span><span class="n">fontcolor</span><span class="si">}</span><span class="s2">; font-weight: </span><span class="si">{</span><span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">bold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">        padding: </span><span class="si">{</span><span class="n">padding</span><span class="si">}</span><span class="s2">; background-color: </span><span class="si">{</span><span class="n">bg_color</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">        border-radius: </span><span class="si">{</span><span class="n">border_radius</span><span class="si">}</span><span class="s2">;&quot;&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;div style=&quot;font-size: </span><span class="si">{</span><span class="n">fontsize</span><span class="si">}</span><span class="s2">px; color: </span><span class="si">{</span><span class="n">fontcolor</span><span class="si">}</span><span class="s2">; font-weight: </span><span class="si">{</span><span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">bold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="si">}</span><span class="s2">; </span>
<span class="s2">        padding: </span><span class="si">{</span><span class="n">padding</span><span class="si">}</span><span class="s2">;&quot;&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_html</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_tile_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_tile_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_tile_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a TileLayer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the tile layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use for the layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>A flag indicating whether the layer should be on by default. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_tile_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">attribution</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a TileLayer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the tile layer.</span>
<span class="sd">        name (str): The layer name to use for the layer.</span>
<span class="sd">        attribution (str): The attribution to use.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.</span>
<span class="sd">        shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">visible</span><span class="o">=</span><span class="n">shown</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">tile_layer</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified TileLayer.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_time_slider" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_time_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layers_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">slider_length</span><span class="o">=</span><span class="s1">&#39;150px&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_time_slider" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a time slider to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>layers_dict</code></td>
        <td><code>dict</code></td>
        <td><p>The dictionary containing a set of XYZ tile layers.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>The list of labels to be used for the time series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>time_interval</code></td>
        <td><code>int</code></td>
        <td><p>Time interval in seconds. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>Position to place the time slider, can be any of ['topleft', 'topright', 'bottomleft', 'bottomright']. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
      <tr>
        <td><code>slider_length</code></td>
        <td><code>str</code></td>
        <td><p>Length of the time slider. Defaults to "150px".</p></td>
        <td><code>&#39;150px&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_time_slider</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">layers_dict</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">time_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="n">slider_length</span><span class="o">=</span><span class="s2">&quot;150px&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a time slider to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        layers_dict (dict, optional): The dictionary containing a set of XYZ tile layers.</span>
<span class="sd">        labels (list, optional): The list of labels to be used for the time series. Defaults to None.</span>
<span class="sd">        time_interval (int, optional): Time interval in seconds. Defaults to 1.</span>
<span class="sd">        position (str, optional): Position to place the time slider, can be any of [&#39;topleft&#39;, &#39;topright&#39;, &#39;bottomleft&#39;, &#39;bottomright&#39;]. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        slider_length (str, optional): Length of the time slider. Defaults to &quot;150px&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.toolbar</span> <span class="kn">import</span> <span class="n">time_slider</span>

    <span class="n">time_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layers_dict</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">slider_length</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">info_mode</span><span class="o">=</span><span class="s1">&#39;on_hover&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_vector" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds any geopandas-supported vector dataset to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>tuple | GeoDataFrame or GeoSeries | shapely Geometry</code></td>
        <td><p>Filter features by given bounding box, GeoSeries, GeoDataFrame or a shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with mask. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>dict | GeoDataFrame or GeoSeries | shapely Geometry</code></td>
        <td><p>Filter for features that intersect with the given dict-like geojson geometry, GeoSeries, GeoDataFrame or shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with bbox. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>rows</code></td>
        <td><code>int or slice</code></td>
        <td><p>Load in specific rows by passing an integer (first n rows) or a slice() object.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><code>&#39;on_hover&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding to use to read the file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_vector</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">info_mode</span><span class="o">=</span><span class="s2">&quot;on_hover&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds any geopandas-supported vector dataset to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO).</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        bbox (tuple | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter features by given bounding box, GeoSeries, GeoDataFrame or a shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with mask. Defaults to None.</span>
<span class="sd">        mask (dict | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter for features that intersect with the given dict-like geojson geometry, GeoSeries, GeoDataFrame or shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with bbox. Defaults to None.</span>
<span class="sd">        rows (int or slice, optional): Load in specific rows by passing an integer (first n rows) or a slice() object.. Defaults to None.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding to use to read the file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.shp&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_shp</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">vector_to_geojson</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
            <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
            <span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
            <span class="n">geojson</span><span class="p">,</span>
            <span class="n">layer_name</span><span class="p">,</span>
            <span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="p">,</span>
            <span class="n">fill_colors</span><span class="p">,</span>
            <span class="n">info_mode</span><span class="p">,</span>
            <span class="n">encoding</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_vector_tile_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_vector_tile_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://tile.nextzen.org/tilezen/vector/v1/512/all/</span><span class="si">{z}</span><span class="s1">/</span><span class="si">{x}</span><span class="s1">/</span><span class="si">{y}</span><span class="s1">.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&#39;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">vector_tile_layer_styles</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_vector_tile_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a VectorTileLayer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the tile layer. Defaults to 'https://tile.nextzen.org/tilezen/vector/v1/512/all/{z}/{x}/{y}.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w'.</p></td>
        <td><code>&#39;https://tile.nextzen.org/tilezen/vector/v1/512/all/{z}/{x}/{y}.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&#39;</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution to use. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>vector_tile_layer_styles</code></td>
        <td><code>dict,optional</code></td>
        <td><p>Style dict, specific to the vector tile source.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_vector_tile_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://tile.nextzen.org/tilezen/vector/v1/512/all/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&quot;</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">vector_tile_layer_styles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a VectorTileLayer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, optional): The URL of the tile layer. Defaults to &#39;https://tile.nextzen.org/tilezen/vector/v1/512/all/{z}/{x}/{y}.mvt?api_key=gCZXZglvRQa6sB2z7JzL1w&#39;.</span>
<span class="sd">        attribution (str, optional): The attribution to use. Defaults to &#39;&#39;.</span>
<span class="sd">        vector_tile_layer_styles (dict,optional): Style dict, specific to the vector tile source.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vector_tile_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">VectorTileLayer</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="n">vector_tile_layer_styles</span><span class="o">=</span><span class="n">vector_tile_layer_styles</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">vector_tile_layer</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified VectorTileLayer.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_velocity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">zonal_speed</span><span class="p">,</span> <span class="n">meridional_speed</span><span class="p">,</span> <span class="n">latitude_dimension</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">longitude_dimension</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">level_dimension</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span> <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">velocity_scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_velocity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">display_options</span><span class="o">=</span><span class="p">{},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_velocity" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a velocity layer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | xr.Dataset</code></td>
        <td><p>The data to use for the velocity layer. It can be a file path to a NetCDF file or an xarray Dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>zonal_speed</code></td>
        <td><code>str</code></td>
        <td><p>Name of the zonal speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>meridional_speed</code></td>
        <td><code>str</code></td>
        <td><p>Name of the meridional speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude_dimension</code></td>
        <td><code>str</code></td>
        <td><p>Name of the latitude dimension in the dataset. Defaults to 'lat'.</p></td>
        <td><code>&#39;lat&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude_dimension</code></td>
        <td><code>str</code></td>
        <td><p>Name of the longitude dimension in the dataset. Defaults to 'lon'.</p></td>
        <td><code>&#39;lon&#39;</code></td>
      </tr>
      <tr>
        <td><code>level_dimension</code></td>
        <td><code>str</code></td>
        <td><p>Name of the level dimension in the dataset. Defaults to 'lev'.</p></td>
        <td><code>&#39;lev&#39;</code></td>
      </tr>
      <tr>
        <td><code>level_index</code></td>
        <td><code>int</code></td>
        <td><p>The index of the level dimension to display. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>time_index</code></td>
        <td><code>int</code></td>
        <td><p>The index of the time dimension to display. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>velocity_scale</code></td>
        <td><code>float</code></td>
        <td><p>The scale of the velocity. Defaults to 0.01.</p></td>
        <td><code>0.01</code></td>
      </tr>
      <tr>
        <td><code>max_velocity</code></td>
        <td><code>int</code></td>
        <td><p>The maximum velocity to display. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>display_options</code></td>
        <td><code>dict</code></td>
        <td><p>The display options for the velocity layer. Defaults to {}. See https://bit.ly/3uf8t6w.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Layer name to use . Defaults to 'Velocity'.</p></td>
        <td><code>&#39;Velocity&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the xarray package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the data is not a NetCDF file or an xarray Dataset.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_velocity</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">zonal_speed</span><span class="p">,</span>
    <span class="n">meridional_speed</span><span class="p">,</span>
    <span class="n">latitude_dimension</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
    <span class="n">longitude_dimension</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="n">level_dimension</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span>
    <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">time_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">velocity_scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">max_velocity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">display_options</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Velocity&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a velocity layer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | xr.Dataset): The data to use for the velocity layer. It can be a file path to a NetCDF file or an xarray Dataset.</span>
<span class="sd">        zonal_speed (str): Name of the zonal speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</span>
<span class="sd">        meridional_speed (str): Name of the meridional speed in the dataset. See https://en.wikipedia.org/wiki/Zonal_and_meridional_flow.</span>
<span class="sd">        latitude_dimension (str, optional): Name of the latitude dimension in the dataset. Defaults to &#39;lat&#39;.</span>
<span class="sd">        longitude_dimension (str, optional): Name of the longitude dimension in the dataset. Defaults to &#39;lon&#39;.</span>
<span class="sd">        level_dimension (str, optional): Name of the level dimension in the dataset. Defaults to &#39;lev&#39;.</span>
<span class="sd">        level_index (int, optional): The index of the level dimension to display. Defaults to 0.</span>
<span class="sd">        time_index (int, optional): The index of the time dimension to display. Defaults to 0.</span>
<span class="sd">        velocity_scale (float, optional): The scale of the velocity. Defaults to 0.01.</span>
<span class="sd">        max_velocity (int, optional): The maximum velocity to display. Defaults to 20.</span>
<span class="sd">        display_options (dict, optional): The display options for the velocity layer. Defaults to {}. See https://bit.ly/3uf8t6w.</span>
<span class="sd">        name (str, optional): Layer name to use . Defaults to &#39;Velocity&#39;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the xarray package is not installed.</span>
<span class="sd">        ValueError: If the data is not a NetCDF file or an xarray Dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
        <span class="kn">from</span> <span class="nn">ipyleaflet.velocity</span> <span class="kn">import</span> <span class="n">Velocity</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;The xarray package is required to add a velocity layer. &quot;</span>
            <span class="s2">&quot;Please install it with `pip install xarray`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The data must be a file path or xarray dataset.&quot;</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># Rasterio does not handle time or levels. So we must drop them</span>
    <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_index</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">level_dimension</span><span class="p">:</span> <span class="n">level_index</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">level_dimension</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="n">wind</span> <span class="o">=</span> <span class="n">Velocity</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
        <span class="n">zonal_speed</span><span class="o">=</span><span class="n">zonal_speed</span><span class="p">,</span>
        <span class="n">meridional_speed</span><span class="o">=</span><span class="n">meridional_speed</span><span class="p">,</span>
        <span class="n">latitude_dimension</span><span class="o">=</span><span class="n">latitude_dimension</span><span class="p">,</span>
        <span class="n">longitude_dimension</span><span class="o">=</span><span class="n">longitude_dimension</span><span class="p">,</span>
        <span class="n">velocity_scale</span><span class="o">=</span><span class="n">velocity_scale</span><span class="p">,</span>
        <span class="n">max_velocity</span><span class="o">=</span><span class="n">max_velocity</span><span class="p">,</span>
        <span class="n">display_options</span><span class="o">=</span><span class="n">display_options</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">wind</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_widget" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_widget" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a widget (e.g., text, HTML, figure) to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>content</code></td>
        <td><code>str | ipywidgets.Widget | object</code></td>
        <td><p>The widget to add.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the widget. Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Other keyword arguments for ipywidgets.HTML().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a widget (e.g., text, HTML, figure) to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        content (str | ipywidgets.Widget | object): The widget to add.</span>
<span class="sd">        position (str, optional): The position of the widget. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        **kwargs: Other keyword arguments for ipywidgets.HTML().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">allowed_positions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;topleft&quot;</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span> <span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span> <span class="s2">&quot;bottomright&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_positions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;position must be one of </span><span class="si">{</span><span class="n">allowed_positions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
                <span class="n">display</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error adding widget: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_wms_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_wms_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;image/png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_wms_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a WMS layer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the WMS web service.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layers</code></td>
        <td><code>str</code></td>
        <td><p>Comma-separated list of WMS layers to show.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use on the layer control. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution of the data layer. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>format</code></td>
        <td><code>str</code></td>
        <td><p>WMS image format (use ‘image/png’ for layers with transparency). Defaults to 'image/png'.</p></td>
        <td><code>&#39;image/png&#39;</code></td>
      </tr>
      <tr>
        <td><code>transparent</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the WMS service will return images with transparency. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>A flag indicating whether the layer should be on by default. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_wms_layer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">layers</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
    <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a WMS layer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the WMS web service.</span>
<span class="sd">        layers (str): Comma-separated list of WMS layers to show.</span>
<span class="sd">        name (str, optional): The layer name to use on the layer control. Defaults to None.</span>
<span class="sd">        attribution (str, optional): The attribution of the data layer. Defaults to &#39;&#39;.</span>
<span class="sd">        format (str, optional): WMS image format (use ‘image/png’ for layers with transparency). Defaults to &#39;image/png&#39;.</span>
<span class="sd">        transparent (bool, optional): If True, the WMS service will return images with transparency. Defaults to True.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.0.</span>
<span class="sd">        shown (bool, optional): A flag indicating whether the layer should be on by default. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">wms_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WMSLayer</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
            <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">visible</span><span class="o">=</span><span class="n">shown</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">wms_layer</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to add the specified WMS TileLayer.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_xy_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_xy_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_csv</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Marker cluster&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_xy_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds points from a CSV file containing lat/lon information and display data on the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input CSV file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing longitude coordinates. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing latitude coordinates. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>label</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing label information to used for marker popup. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to "Marker cluster".</p></td>
        <td><code>&#39;Marker cluster&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The specified input csv does not exist.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The specified x column does not exist.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The specified y column does not exist.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The specified label column does not exist.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_xy_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">in_csv</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Marker cluster&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds points from a CSV file containing lat/lon information and display data on the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): The file path to the input CSV file.</span>
<span class="sd">        x (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        y (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        label (str, optional): The name of the column containing label information to used for marker popup. Defaults to None.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &quot;Marker cluster&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The specified input csv does not exist.</span>
<span class="sd">        ValueError: The specified x column does not exist.</span>
<span class="sd">        ValueError: The specified y column does not exist.</span>
<span class="sd">        ValueError: The specified label column does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">in_csv</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>

    <span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;label must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;wait&quot;</span><span class="p">}</span>

    <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
                <span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span>
                <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">popup</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">])),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span>
        <span class="p">]</span>

    <span class="n">marker_cluster</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">MarkerCluster</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">marker_cluster</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.add_xyz_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_xyz_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.add_xyz_service" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add a XYZ tile layer to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>provider</code></td>
        <td><code>str</code></td>
        <td><p>A tile layer name starts with xyz or qms. For example, xyz.OpenTopoMap,</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The provider is not valid. It must start with xyz or qms.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_xyz_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a XYZ tile layer to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        provider (str): A tile layer name starts with xyz or qms. For example, xyz.OpenTopoMap,</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The provider is not valid. It must start with xyz or qms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xyzservices</span>
    <span class="kn">import</span> <span class="nn">xyzservices.providers</span> <span class="k">as</span> <span class="nn">xyz</span>

    <span class="k">if</span> <span class="n">provider</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">provider</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="n">xyz_provider</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">xyz_provider</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
        <span class="n">attribution</span> <span class="o">=</span> <span class="n">xyz_provider</span><span class="o">.</span><span class="n">attribution</span>
        <span class="k">if</span> <span class="n">attribution</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">attribution</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">provider</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;qms&quot;</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">provider</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="n">qms_provider</span> <span class="o">=</span> <span class="n">xyzservices</span><span class="o">.</span><span class="n">TileProvider</span><span class="o">.</span><span class="n">from_qms</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">qms_provider</span><span class="o">.</span><span class="n">build_url</span><span class="p">()</span>
        <span class="n">attribution</span> <span class="o">=</span> <span class="n">qms_provider</span><span class="o">.</span><span class="n">attribution</span>
        <span class="k">if</span> <span class="n">attribution</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">attribution</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attribution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The provider </span><span class="si">{</span><span class="n">provider</span><span class="si">}</span><span class="s2"> is not valid. It must start with xyz or qms.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.basemap_demo" class="doc doc-heading">
<code class="highlight language-python"><span class="n">basemap_demo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.basemap_demo" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A demo for using leafmap basemaps.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">basemap_demo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A demo for using leafmap basemaps.&quot;&quot;&quot;</span>
    <span class="n">dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="n">value</span><span class="o">=</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Basemaps&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="n">basemap_name</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]</span>
        <span class="n">old_basemap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substitute_layer</span><span class="p">(</span><span class="n">old_basemap</span><span class="p">,</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">basemap_name</span><span class="p">])</span>

    <span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
    <span class="n">basemap_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">dropdown</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">basemap_control</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.edit_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">edit_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.edit_vector" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Edit a vector layer.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>dict | str</code></td>
        <td><p>The data to edit. It can be a GeoJSON dictionary or a file path.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">edit_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edit a vector layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict | str): The data to edit. It can be a GeoJSON dictionary or a file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">check_package</span><span class="p">(</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf_to_geojson</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span> <span class="n">tuple_to_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The data must be a GeoJSON dictionary or a file path to a vector dataset.&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="p">(</span><span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span> <span class="o">+</span> <span class="p">(</span><span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.find_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.find_layer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Finds layer by name</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the layer to find.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>ipyleaflet layer object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds layer by name</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the layer to find.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: ipyleaflet layer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>

    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">layer</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.find_layer_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_layer_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.find_layer_index" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Finds layer index by name</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the layer to find.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>Index of the layer with the specified name</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_layer_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds layer index by name</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the layer to find.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Index of the layer with the specified name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">index</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.get_draw_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.get_draw_props" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the properties of the draw features.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of attributes to return. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_df</code></td>
        <td><code>bool</code></td>
        <td><p>If True, return a pandas dataframe. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>A pandas dataframe containing the properties of the draw features.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the properties of the draw features.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int, optional): The maximum number of attributes to return. Defaults to None.</span>
<span class="sd">        return_df (bool, optional): If True, return a pandas dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A pandas dataframe containing the properties of the draw features.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">[:]</span>

    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
                <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_df</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">props</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">))</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">)})</span>
        <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">props</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.get_layer_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_layer_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.get_layer_names" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets layer names as a list.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of layer names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_layer_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets layer names as a list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of layer names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layer_names</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">layer_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">layer_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.get_pc_collections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_pc_collections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.get_pc_collections" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the list of Microsoft Planetary Computer collections.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_pc_collections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the list of Microsoft Planetary Computer collections.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pc_collections&quot;</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pc_collections&quot;</span><span class="p">,</span> <span class="n">get_pc_collections</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.get_scale" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.get_scale" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns the approximate pixel scale of the current map view, in meters.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>Map resolution in meters.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the approximate pixel scale of the current map view, in meters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Map resolution in meters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">math</span>

    <span class="n">zoom_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span>
    <span class="c1"># Reference: https://blogs.bing.com/maps/2006/02/25/map-control-zoom-levels-gt-resolution</span>
    <span class="n">resolution</span> <span class="o">=</span> <span class="mf">156543.04</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zoom_level</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resolution</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.image_overlay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.image_overlay" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Overlays an image from the Internet or locally on the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>http URL or local file path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bounds</code></td>
        <td><code>tuple</code></td>
        <td><p>bounding box of the image in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>name of the layer to show on the layer control.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overlays an image from the Internet or locally on the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): http URL or local file path to the image.</span>
<span class="sd">        bounds (tuple): bounding box of the image in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</span>
<span class="sd">        name (str): name of the layer to show on the layer control.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageSequence</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided file does not exist.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># file extension</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gif&quot;</span><span class="p">:</span>
                <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="c1"># Loop over each frame in the animated image</span>
                <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
                    <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;gif&quot;</span><span class="p">)</span>
                    <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
                <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                    <span class="n">f</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
                    <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;data:image/</span><span class="si">{}</span><span class="s2">;base64,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">+</span> <span class="n">data</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ImageOverlay</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.layer_opacity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">layer_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.layer_opacity" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Changes layer opacity.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the layer to change opacity.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>value</code></td>
        <td><code>float</code></td>
        <td><p>The opacity value to set. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">layer_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Changes layer opacity.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the layer to change opacity.</span>
<span class="sd">        value (float, optional): The opacity value to set. Defaults to 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_layer</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.remove_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.remove_labels" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Removes all labels from the map.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Removes all labels from the map.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.save_draw_features" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.save_draw_features" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Save the draw features to a file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>out_file</code></td>
        <td><code>str</code></td>
        <td><p>The output file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indent</code></td>
        <td><code>int</code></td>
        <td><p>The indentation level when saving data as a GeoJSON. Defaults to 4.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save the draw features to a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        out_file (str): The output file path.</span>
<span class="sd">        indent (int, optional): The indentation level when saving data as a GeoJSON. Defaults to 4.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>

    <span class="n">out_file</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">:</span>
        <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">out_file</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.geojson&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">update_draw_features</span><span class="p">()</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">]:</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.shp&quot;</span><span class="p">:</span>
            <span class="n">geojson_to_shp</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geojson_to_gpkg</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.set_center" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.set_center" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Centers the map view at a given coordinates with the given zoom level.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lon</code></td>
        <td><code>float</code></td>
        <td><p>The longitude of the center, in degrees.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>float</code></td>
        <td><p>The latitude of the center, in degrees.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The zoom level, from 1 to 24. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Centers the map view at a given coordinates with the given zoom level.</span>

<span class="sd">    Args:</span>
<span class="sd">        lon (float): The longitude of the center, in degrees.</span>
<span class="sd">        lat (float): The latitude of the center, in degrees.</span>
<span class="sd">        zoom (int, optional): The zoom level, from 1 to 24. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.split_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">split_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_layer</span><span class="o">=</span><span class="s1">&#39;TERRAIN&#39;</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="s1">&#39;OpenTopoMap&#39;</span><span class="p">,</span> <span class="n">left_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">right_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">zoom_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fullscreen_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_close_button</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_position</span><span class="o">=</span><span class="s1">&#39;bottomleft&#39;</span><span class="p">,</span> <span class="n">right_position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">widget_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.split_map" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds split map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>left_layer</code></td>
        <td><code>str</code></td>
        <td><p>The left tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to 'TERRAIN'.</p></td>
        <td><code>&#39;TERRAIN&#39;</code></td>
      </tr>
      <tr>
        <td><code>right_layer</code></td>
        <td><code>str</code></td>
        <td><p>The right tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to 'OpenTopoMap'.</p></td>
        <td><code>&#39;OpenTopoMap&#39;</code></td>
      </tr>
      <tr>
        <td><code>left_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the left tile layer. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>right_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the right tile layer. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split_map</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">left_layer</span><span class="o">=</span><span class="s2">&quot;TERRAIN&quot;</span><span class="p">,</span>
    <span class="n">right_layer</span><span class="o">=</span><span class="s2">&quot;OpenTopoMap&quot;</span><span class="p">,</span>
    <span class="n">left_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">right_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">zoom_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fullscreen_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_close_button</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">left_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_position</span><span class="o">=</span><span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span>
    <span class="n">right_position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="n">widget_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds split map.</span>

<span class="sd">    Args:</span>
<span class="sd">        left_layer (str, optional): The left tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;TERRAIN&#39;.</span>
<span class="sd">        right_layer (str, optional): The right tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;OpenTopoMap&#39;.</span>
<span class="sd">        left_args (dict, optional): The arguments for the left tile layer. Defaults to {}.</span>
<span class="sd">        right_args (dict, optional): The arguments for the right tile layer. Defaults to {}.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Left Layer&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Right Layer&quot;</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">controls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_controls</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">zoom_control</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ZoomControl</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">fullscreen_control</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">FullScreenControl</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">left_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">left_name</span> <span class="o">=</span> <span class="n">left_label</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left_name</span> <span class="o">=</span> <span class="s2">&quot;Left Layer&quot;</span>

        <span class="k">if</span> <span class="n">right_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">right_name</span> <span class="o">=</span> <span class="n">right_label</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">right_name</span> <span class="o">=</span> <span class="s2">&quot;Right Layer&quot;</span>

        <span class="k">if</span> <span class="n">left_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">left_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">left_layer</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">left_layer</span><span class="p">)</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">left_name</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">left_layer</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">left_layer</span><span class="p">,</span> <span class="n">left_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                        <span class="n">left_layer</span><span class="p">,</span>
                        <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">left_client</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">left_name</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;left_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">right_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">right_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">right_layer</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span>
                    <span class="n">right_layer</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">right_layer</span><span class="p">)</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">right_name</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
                <span class="s2">&quot;.geojson&quot;</span>
            <span class="p">):</span>

                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">right_layer</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">right_layer</span><span class="p">,</span> <span class="n">right_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                        <span class="n">right_layer</span><span class="p">,</span>
                        <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">right_client</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">right_layer</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">right_name</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;right_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
            <span class="p">)</span>
        <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SplitMapControl</span><span class="p">(</span>
            <span class="n">left_layer</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="n">right_layer</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">left_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">widget_layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
            <span class="n">left_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">left_label</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widget_layout</span><span class="p">)</span>

            <span class="n">left_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">left_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">left_position</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">left_control</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">right_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">widget_layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 4px 0px 4px&quot;</span><span class="p">)</span>
            <span class="n">right_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">right_label</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widget_layout</span><span class="p">)</span>
            <span class="n">right_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                <span class="n">widget</span><span class="o">=</span><span class="n">right_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">right_position</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">right_control</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided layers are invalid!&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.static_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">static_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">950</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.static_map" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Display an ipyleaflet static map in a Jupyter Notebook.</p>
<p>Args
    m (ipyleaflet.Map): An ipyleaflet map.
    width (int, optional): Width of the map. Defaults to 950.
    height (int, optional): Height of the map. Defaults to 600.
    read_only (bool, optional): Whether to hide the side panel to disable map customization. Defaults to False.
    out_file (str, optional): Output html file path. Defaults to None.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">static_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">950</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display an ipyleaflet static map in a Jupyter Notebook.</span>

<span class="sd">    Args</span>
<span class="sd">        m (ipyleaflet.Map): An ipyleaflet map.</span>
<span class="sd">        width (int, optional): Width of the map. Defaults to 950.</span>
<span class="sd">        height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">        read_only (bool, optional): Whether to hide the side panel to disable map customization. Defaults to False.</span>
<span class="sd">        out_file (str, optional): Output html file path. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">Map</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">out_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out_file</span> <span class="o">=</span> <span class="s2">&quot;./cache/&quot;</span> <span class="o">+</span> <span class="s2">&quot;leafmap_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.html&quot;</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_file</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
        <span class="n">display_html</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">out_file</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided map is not an ipyleaflet map.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.to_html" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;My Map&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;880px&#39;</span><span class="p">,</span> <span class="n">add_layer_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.to_html" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves the map as an HTML file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>outfile</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the HTML file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the HTML file. Defaults to 'My Map'.</p></td>
        <td><code>&#39;My Map&#39;</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>str</code></td>
        <td><p>The width of the map in pixels or percentage. Defaults to '100%'.</p></td>
        <td><code>&#39;100%&#39;</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the map in pixels. Defaults to '880px'.</p></td>
        <td><code>&#39;880px&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_layer_control</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add the LayersControl. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My Map&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;880px&quot;</span><span class="p">,</span>
    <span class="n">add_layer_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Saves the map as an HTML file.</span>

<span class="sd">    Args:</span>
<span class="sd">        outfile (str, optional): The output file path to the HTML file.</span>
<span class="sd">        title (str, optional): The title of the HTML file. Defaults to &#39;My Map&#39;.</span>
<span class="sd">        width (str, optional): The width of the map in pixels or percentage. Defaults to &#39;100%&#39;.</span>
<span class="sd">        height (str, optional): The height of the map in pixels. Defaults to &#39;880px&#39;.</span>
<span class="sd">        add_layer_control (bool, optional): Whether to add the LayersControl. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>

        <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.html&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The output file extension must be html.&quot;</span><span class="p">)</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.html&quot;</span><span class="p">)</span>
            <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">add_layer_control</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_control</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layer_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">LayersControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layer_control</span> <span class="o">=</span> <span class="n">layer_control</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">layer_control</span><span class="p">)</span>

        <span class="n">before_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span>
        <span class="n">before_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;width must be a string.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">width</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;px&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">width</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;width must end with px or %&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;height must be a string.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">height</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;px&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;height must end with px&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">before_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">before_height</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">out_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="n">out_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">out_html</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.to_image" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves the map as a PNG or JPG image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>outfile</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the image. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>monitor</code></td>
        <td><code>int</code></td>
        <td><p>The monitor to take the screenshot. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Saves the map as a PNG or JPG image.</span>

<span class="sd">    Args:</span>
<span class="sd">        outfile (str, optional): The output file path to the image. Defaults to None.</span>
<span class="sd">        monitor (int, optional): The monitor to take the screenshot. Defaults to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;my_map.png&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">outfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.jpg&quot;</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The output file must be a PNG or JPG image.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">work_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">work_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

    <span class="n">screenshot</span> <span class="o">=</span> <span class="n">screen_capture</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">monitor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">screenshot</span> <span class="o">=</span> <span class="n">screenshot</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.to_streamlit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_streamlit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.to_streamlit" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Renders map figure in a Streamlit app.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the map. Defaults to 600.</p></td>
        <td><code>600</code></td>
      </tr>
      <tr>
        <td><code>responsive</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to make the map responsive. Defaults to True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>scrolling</code></td>
        <td><code>bool</code></td>
        <td><p>If True, show a scrollbar when the content is larger than the iframe. Otherwise, do not show a scrollbar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>streamlit.components</code></td>
      <td><p>components.html object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_streamlit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Renders map figure in a Streamlit app.</span>

<span class="sd">    Args:</span>
<span class="sd">        width (int, optional): Width of the map. Defaults to None.</span>
<span class="sd">        height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">        responsive (bool, optional): Whether to make the map responsive. Defaults to True.</span>
<span class="sd">        scrolling (bool, optional): If True, show a scrollbar when the content is larger than the iframe. Otherwise, do not show a scrollbar. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        streamlit.components: components.html object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">streamlit.components.v1</span> <span class="k">as</span> <span class="nn">components</span>

        <span class="c1"># if responsive:</span>
        <span class="c1">#     make_map_responsive = &quot;&quot;&quot;</span>
        <span class="c1">#     &lt;style&gt;</span>
        <span class="c1">#     [title~=&quot;st.iframe&quot;] { width: 100%}</span>
        <span class="c1">#     &lt;/style&gt;</span>
        <span class="c1">#     &quot;&quot;&quot;</span>
        <span class="c1">#     st.markdown(make_map_responsive, unsafe_allow_html=True)</span>
        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="n">html</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="n">scrolling</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.toolbar_reset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">toolbar_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.toolbar_reset" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Reset the toolbar so that no tool is selected.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">toolbar_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reset the toolbar so that no tool is selected.&quot;&quot;&quot;</span>
    <span class="n">toolbar_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>
    <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">toolbar_grid</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="n">tool</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.update_draw_features" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.update_draw_features" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Update the draw features by removing features that have been edited and no longer exist.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_draw_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update the draw features by removing features that have been edited and no longer exist.&quot;&quot;&quot;</span>

    <span class="n">geometries</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.update_draw_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.update_draw_props" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Update the draw features properties.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>A pandas dataframe containing the properties of the draw features.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_draw_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update the draw features properties.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A pandas dataframe containing the properties of the draw features.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Key&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;edited&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_draw_features</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;created&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_action</span> <span class="o">==</span> <span class="s2">&quot;edited&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_features</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">draw_control</span><span class="o">.</span><span class="n">last_draw</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
                        <span class="o">==</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
                    <span class="p">):</span>
                        <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edit_props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.user_roi_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">user_roi_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.user_roi_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>decimals</code></td>
        <td><code>int</code></td>
        <td><p>The number of decimals to round the coordinates to. Defaults to 4.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">user_roi_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</span>

<span class="sd">    Args:</span>
<span class="sd">        decimals (int, optional): The number of decimals to round the coordinates to. Defaults to 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The bounds of the user drawn ROI as a tuple of (minx, miny, maxx, maxy).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">geometry_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_roi</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.video_overlay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">video_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.video_overlay" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Overlays a video from the Internet on the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>http URL of the video, such as "https://www.mapbox.com/bites/00188/patricia_nasa.webm"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bounds</code></td>
        <td><code>tuple</code></td>
        <td><p>bounding box of the video in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>name of the layer to show on the layer control.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">video_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overlays a video from the Internet on the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): http URL of the video, such as &quot;https://www.mapbox.com/bites/00188/patricia_nasa.webm&quot;</span>
<span class="sd">        bounds (tuple): bounding box of the video in the format of (lower_left(lat, lon), upper_right(lat, lon)), such as ((13, -130), (32, -100)).</span>
<span class="sd">        layer_name (str): name of the layer to show on the layer control.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">layer_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">VideoOverlay</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.zoom_to_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.zoom_to_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Zooms to a bounding box in the form of [minx, miny, maxx, maxy].</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bounds</code></td>
        <td><code>list | tuple</code></td>
        <td><p>A list/tuple containing minx, miny, maxx, maxy values for the bounds.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">zoom_to_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Zooms to a bounding box in the form of [minx, miny, maxx, maxy].</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (list | tuple): A list/tuple containing minx, miny, maxx, maxy values for the bounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#  The ipyleaflet fit_bounds method takes lat/lon bounds in the form [[south, west], [north, east]].</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">([[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.leafmap.Map.zoom_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zoom_to_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.Map.zoom_to_gdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Zooms to the bounding box of a GeoPandas GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>GeoDataFrame</code></td>
        <td><p>A GeoPandas GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">zoom_to_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Zooms to the bounding box of a GeoPandas GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (GeoDataFrame): A GeoPandas GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="leafmap.leafmap.geojson_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_layer</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span> <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.geojson_layer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds a GeoJSON file to the map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The file path or http URL to the input GeoJSON or a dictionary containing the geojson.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to be used.. Defaults to "Untitled".</p></td>
        <td><code>&#39;Untitled&#39;</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary specifying the style to be used. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>hover_style</code></td>
        <td><code>dict</code></td>
        <td><p>Hover style dictionary. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>style_callback</code></td>
        <td><code>function</code></td>
        <td><p>Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fill_colors</code></td>
        <td><code>list</code></td>
        <td><p>The random colors to use for filling polygons. Defaults to ["black"].</p></td>
        <td><code>[&#39;black&#39;]</code></td>
      </tr>
      <tr>
        <td><code>info_mode</code></td>
        <td><code>str</code></td>
        <td><p>Displays the attributes by either on_hover or on_click. Any value other than "on_hover" or "on_click" will be treated as None. Defaults to "on_hover".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The provided GeoJSON file could not be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_layer</span><span class="p">(</span>
    <span class="n">in_geojson</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">hover_style</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">style_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">],</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a GeoJSON file to the map.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The file path or http URL to the input GeoJSON or a dictionary containing the geojson.</span>
<span class="sd">        layer_name (str, optional): The layer name to be used.. Defaults to &quot;Untitled&quot;.</span>
<span class="sd">        style (dict, optional): A dictionary specifying the style to be used. Defaults to {}.</span>
<span class="sd">        hover_style (dict, optional): Hover style dictionary. Defaults to {}.</span>
<span class="sd">        style_callback (function, optional): Styling function that is called for each feature, and should return the feature style. This styling function takes the feature as argument. Defaults to None.</span>
<span class="sd">        fill_colors (list, optional): The random colors to use for filling polygons. Defaults to [&quot;black&quot;].</span>
<span class="sd">        info_mode (str, optional): Displays the attributes by either on_hover or on_click. Any value other than &quot;on_hover&quot; or &quot;on_click&quot; will be treated as None. Defaults to &quot;on_hover&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The provided GeoJSON file could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="kn">import</span> <span class="nn">requests</span>

    <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style_callback_only</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">in_geojson</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="s2">&quot;The provided GeoJSON file could not be found.&quot;</span>
                    <span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">in_geojson</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The input geojson must be a type of str or dict.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># &quot;stroke&quot;: True,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="c1"># &quot;fill&quot;: True,</span>
            <span class="c1"># &quot;fillColor&quot;: &quot;#ffffff&quot;,</span>
            <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="c1"># &quot;dashArray&quot;: &quot;9&quot;</span>
            <span class="c1"># &quot;clickable&quot;: True,</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="s2">&quot;weight&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hover_style</span><span class="p">:</span>
        <span class="n">hover_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillOpacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">random_color</span><span class="p">(</span><span class="n">feature</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">fill_colors</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="n">style_callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">style_callback</span> <span class="o">=</span> <span class="n">random_color</span>

    <span class="k">if</span> <span class="n">style_callback_only</span><span class="p">:</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">hover_style</span><span class="o">=</span><span class="n">hover_style</span><span class="p">,</span>
            <span class="n">style_callback</span><span class="o">=</span><span class="n">style_callback</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">geojson</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.leafmap.linked_maps" class="doc doc-heading">
<code class="highlight language-python"><span class="n">linked_maps</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;400px&#39;</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="p">[],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[],</span> <span class="n">label_position</span><span class="o">=</span><span class="s1">&#39;topright&#39;</span><span class="p">,</span> <span class="n">layer_args</span><span class="o">=</span><span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.linked_maps" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create linked maps of XYZ tile layers.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>rows</code></td>
        <td><code>int</code></td>
        <td><p>The number of rows of maps to create. Defaults to 2.</p></td>
        <td><code>2</code></td>
      </tr>
      <tr>
        <td><code>cols</code></td>
        <td><code>int</code></td>
        <td><p>The number of columns of maps to create. Defaults to 2.</p></td>
        <td><code>2</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of each map in pixels. Defaults to "400px".</p></td>
        <td><code>&#39;400px&#39;</code></td>
      </tr>
      <tr>
        <td><code>layers</code></td>
        <td><code>list</code></td>
        <td><p>The list of layers to use for each map. Defaults to [].</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>The list of labels to show on the map. Defaults to [].</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>label_position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the label, can be [topleft, topright, bottomleft, bottomright]. Defaults to "topright".</p></td>
        <td><code>&#39;topright&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the length of ee_objects is not equal to rows*cols.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the length of labels is not equal to rows*cols.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ipywidget</code></td>
      <td><p>A GridspecLayout widget.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">linked_maps</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;400px&quot;</span><span class="p">,</span>
    <span class="n">layers</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">label_position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">,</span>
    <span class="n">layer_args</span><span class="o">=</span><span class="p">[],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create linked maps of XYZ tile layers.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows (int, optional): The number of rows of maps to create. Defaults to 2.</span>
<span class="sd">        cols (int, optional): The number of columns of maps to create. Defaults to 2.</span>
<span class="sd">        height (str, optional): The height of each map in pixels. Defaults to &quot;400px&quot;.</span>
<span class="sd">        layers (list, optional): The list of layers to use for each map. Defaults to [].</span>
<span class="sd">        labels (list, optional): The list of labels to show on the map. Defaults to [].</span>
<span class="sd">        label_position (str, optional): The position of the label, can be [topleft, topright, bottomleft, bottomright]. Defaults to &quot;topright&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the length of ee_objects is not equal to rows*cols.</span>
<span class="sd">        ValueError: If the length of labels is not equal to rows*cols.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ipywidget: A GridspecLayout widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">GridspecLayout</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">grid_gap</span><span class="o">=</span><span class="s2">&quot;0px&quot;</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span>

    <span class="n">maps</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">count</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The length of layers must be equal to </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">*</span> <span class="n">count</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The length of labels must be equal to </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">layer_args</span> <span class="o">=</span> <span class="n">layer_args</span> <span class="o">*</span> <span class="n">count</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The length of layer_args must be equal to </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">layer_args</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">count</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">+</span> <span class="n">j</span>

            <span class="k">if</span> <span class="s2">&quot;draw_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;draw_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="s2">&quot;toolbar_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;toolbar_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="s2">&quot;measure_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;measure_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="s2">&quot;fullscreen_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span>
                <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
                <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s2">&quot;0px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px&quot;</span><span class="p">),</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                    <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">**</span><span class="n">layer_args</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                    <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Left Layer&quot;</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]):</span>
                    <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">left_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                        <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                        <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">layer_args</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                        <span class="n">url</span><span class="o">=</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Left Layer&quot;</span><span class="p">,</span>
                        <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">layer_args</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;layers[index] must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
                <span class="p">)</span>

            <span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 5px 0px 5px&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
                    <span class="n">widget</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">label_position</span>
                <span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

            <span class="n">maps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">jslink</span><span class="p">((</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;center&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">))</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">jslink</span><span class="p">((</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;zoom&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s2">&quot;zoom&quot;</span><span class="p">))</span>

            <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
                <span class="n">display</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">return</span> <span class="n">grid</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.leafmap.split_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">split_map</span><span class="p">(</span><span class="n">left_layer</span><span class="o">=</span><span class="s1">&#39;TERRAIN&#39;</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="s1">&#39;OpenTopoMap&#39;</span><span class="p">,</span> <span class="n">left_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">right_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.split_map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds split map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>left_layer</code></td>
        <td><code>str</code></td>
        <td><p>The left tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to 'TERRAIN'.</p></td>
        <td><code>&#39;TERRAIN&#39;</code></td>
      </tr>
      <tr>
        <td><code>right_layer</code></td>
        <td><code>str</code></td>
        <td><p>The right tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to 'OpenTopoMap'.</p></td>
        <td><code>&#39;OpenTopoMap&#39;</code></td>
      </tr>
      <tr>
        <td><code>left_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the left tile layer. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>right_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the right tile layer. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the Map widget. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split_map</span><span class="p">(</span>
    <span class="n">left_layer</span><span class="o">=</span><span class="s2">&quot;TERRAIN&quot;</span><span class="p">,</span>
    <span class="n">right_layer</span><span class="o">=</span><span class="s2">&quot;OpenTopoMap&quot;</span><span class="p">,</span>
    <span class="n">left_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">right_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds split map.</span>

<span class="sd">    Args:</span>
<span class="sd">        left_layer (str, optional): The left tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;TERRAIN&#39;.</span>
<span class="sd">        right_layer (str, optional): The right tile layer. Can be a local file path, HTTP URL, or a basemap name. Defaults to &#39;OpenTopoMap&#39;.</span>
<span class="sd">        left_args (dict, optional): The arguments for the left tile layer. Defaults to {}.</span>
<span class="sd">        right_args (dict, optional): The arguments for the right tile layer. Defaults to {}.</span>
<span class="sd">        kwargs (dict, optional): The arguments for the Map widget. Defaults to {}.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;draw_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;draw_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;toolbar_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;toolbar_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;measure_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;measure_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;fullscreen_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;scale_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scale_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
        <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Left Layer&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;layer_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
        <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;layer_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Right Layer&quot;</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">left_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">left_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">left_layer</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">left_layer</span><span class="p">)</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Left Layer&quot;</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">left_layer</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">left_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">left_args</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">left_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">left_args</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">left_layer</span><span class="p">,</span> <span class="n">left_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                        <span class="n">left_layer</span><span class="p">,</span>
                        <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">left_client</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">left_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Left Layer&quot;</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">left_args</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">left_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;left_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">right_layer</span> <span class="ow">in</span> <span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">right_layer</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">right_layer</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span>
                    <span class="n">right_layer</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="n">cog_bounds</span><span class="p">(</span><span class="n">right_layer</span><span class="p">)</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Right Layer&quot;</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">right_layer</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">in</span> <span class="n">right_args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">right_args</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">right_layer</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
                    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">geojson_layer</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="o">**</span><span class="n">right_args</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">right_layer</span><span class="p">,</span> <span class="n">right_client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
                        <span class="n">right_layer</span><span class="p">,</span>
                        <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
                        <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">image_bounds</span><span class="p">(</span><span class="n">right_client</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">right_layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">right_layer</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Right Layer&quot;</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">right_args</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">right_layer</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">GeoJSON</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;right_layer must be one of the following: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basemaps</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> or a string url to a tif file.&quot;</span>
            <span class="p">)</span>
        <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SplitMapControl</span><span class="p">(</span>
            <span class="n">left_layer</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="n">right_layer</span>
        <span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided layers are invalid!&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.leafmap.ts_inspector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ts_inspector</span><span class="p">(</span><span class="n">layers_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;120px&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.leafmap.ts_inspector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a time series inspector.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>layers_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of layers to be shown on the map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>left_name</code></td>
        <td><code>str</code></td>
        <td><p>A name for the left layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>right_name</code></td>
        <td><code>str</code></td>
        <td><p>A name for the right layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>str</code></td>
        <td><p>Width of the dropdown list. Defaults to "120px".</p></td>
        <td><code>&#39;120px&#39;</code></td>
      </tr>
      <tr>
        <td><code>center</code></td>
        <td><code>list</code></td>
        <td><p>Center of the map. Defaults to [40, -100].</p></td>
        <td><code>[40, -100]</code></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>Zoom level of the map. Defaults to 4.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>leafmap.Map</code></td>
      <td><p>The Map instance.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/leafmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ts_inspector</span><span class="p">(</span>
    <span class="n">layers_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="s2">&quot;120px&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a time series inspector.</span>

<span class="sd">    Args:</span>
<span class="sd">        layers_dict (dict, optional): A dictionary of layers to be shown on the map. Defaults to None.</span>
<span class="sd">        left_name (str, optional): A name for the left layer. Defaults to None.</span>
<span class="sd">        right_name (str, optional): A name for the right layer. Defaults to None.</span>
<span class="sd">        width (str, optional): Width of the dropdown list. Defaults to &quot;120px&quot;.</span>
<span class="sd">        center (list, optional): Center of the map. Defaults to [40, -100].</span>
<span class="sd">        zoom (int, optional): Zoom level of the map. Defaults to 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        leafmap.Map: The Map instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

    <span class="n">add_zoom</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">add_fullscreen</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="s2">&quot;toolbar_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;toolbar_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;draw_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;draw_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;measure_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;measure_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;zoom_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;zoom_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_zoom</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;zoom_control&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;fullscreen_control&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_fullscreen</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fullscreen_control&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">layers_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">layers_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">basemaps</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">basemaps</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WMSLayer</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layers_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">layers_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">left_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">left_name</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">right_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">right_name</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">left_layer</span> <span class="o">=</span> <span class="n">layers_dict</span><span class="p">[</span><span class="n">left_name</span><span class="p">]</span>
    <span class="n">right_layer</span> <span class="o">=</span> <span class="n">layers_dict</span><span class="p">[</span><span class="n">right_name</span><span class="p">]</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SplitMapControl</span><span class="p">(</span><span class="n">left_layer</span><span class="o">=</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">right_layer</span><span class="o">=</span><span class="n">right_layer</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

    <span class="n">left_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">left_name</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">left_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">left_dropdown</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">left_control</span><span class="p">)</span>

    <span class="n">right_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">right_name</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">right_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">right_dropdown</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">right_control</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_zoom</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">ZoomControl</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">add_fullscreen</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">ipyleaflet</span><span class="o">.</span><span class="n">FullScreenControl</span><span class="p">())</span>

    <span class="n">split_control</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">SplitMapControl</span><span class="p">):</span>
            <span class="n">split_control</span> <span class="o">=</span> <span class="n">ctrl</span>
            <span class="k">break</span>

    <span class="k">def</span> <span class="nf">left_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="n">split_control</span><span class="o">.</span><span class="n">left_layer</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">layers_dict</span><span class="p">[</span><span class="n">left_dropdown</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">url</span>

    <span class="n">left_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">left_change</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">right_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="n">split_control</span><span class="o">.</span><span class="n">right_layer</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">layers_dict</span><span class="p">[</span><span class="n">right_dropdown</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">url</span>

    <span class="n">right_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">right_change</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-03-10T00:56:12+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-03-10</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-03-10T00:56:12+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-03-10</span>
      
    
  </small>
</div>


  




                

              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../kepler/" class="md-footer__link md-footer__link--prev" aria-label="Previous: kepler module" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              kepler module
            </div>
          </div>
        </a>
      
      
        
        <a href="../legends/" class="md-footer__link md-footer__link--next" aria-label="Next: legends module" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              legends module
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 Qiusheng Wu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>